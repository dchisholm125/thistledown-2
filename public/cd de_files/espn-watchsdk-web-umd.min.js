!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).WatchSDK={})}(this,(function(e){"use strict";
/** @preserve ESPN WatchSDK 4.5.34 */function t(e,t,n){return t=h(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,function(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return function(){return!!e}()}()?Reflect.construct(t,n||[],h(e).constructor):t.apply(e,n))}function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function i(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?n(Object(i),!0).forEach((function(t){u(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function r(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,r(i.key),i)}}function c(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function u(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}function m(){return(m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var i=f(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}}).apply(this,arguments)}function y(e,t,n,i){return(y="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(e,t,n,i){var r,a=f(e,t);if(a){if((r=Object.getOwnPropertyDescriptor(a,t)).set)return r.set.call(i,n),!0;if(!r.writable)return!1}if(r=Object.getOwnPropertyDescriptor(i,t)){if(!r.writable)return!1;r.value=n,Object.defineProperty(i,t,r)}else u(i,t,n);return!0})(e,t,n,i)}function g(e,t,n,i,r){if(!y(e,t,n,i||e)&&r)throw new TypeError("failed to set property");return n}function v(e){return function(e){if(Array.isArray(e))return b(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var _="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function w(e,t){return e(t={exports:{}},t.exports),t.exports}var P=w((function(e){var t,n;t=_,n=function(){var e=function(){},t="undefined"!=typeof window&&void 0!==window.navigator&&/Trident\/|MSIE /.test(window.navigator.userAgent),n=["trace","debug","info","warn","error"],i={},r=null;function a(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function s(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function o(n){return"debug"===n&&(n="log"),"undefined"!=typeof console&&("trace"===n&&t?s:void 0!==console[n]?a(console,n):void 0!==console.log?a(console,"log"):e)}function c(){for(var t=this.getLevel(),i=0;i<n.length;i++){var r=n[i];this[r]=i<t?e:this.methodFactory(r,t,this.name)}if(this.log=this.debug,"undefined"==typeof console&&t<this.levels.SILENT)return"No console available for logging"}function u(e){return function(){"undefined"!=typeof console&&(c.call(this),this[e].apply(this,arguments))}}function l(e,t,n){return o(e)||u.apply(this,arguments)}function d(e,t){var a,s,o,u=this,d="loglevel";function h(){var e;if("undefined"!=typeof window&&d){try{e=window.localStorage[d]}catch(e){}if(void 0===e)try{var t=window.document.cookie,n=encodeURIComponent(d),i=t.indexOf(n+"=");-1!==i&&(e=/^([^;]+)/.exec(t.slice(i+n.length+1))[1])}catch(e){}return void 0===u.levels[e]&&(e=void 0),e}}function p(e){var t=e;if("string"==typeof t&&void 0!==u.levels[t.toUpperCase()]&&(t=u.levels[t.toUpperCase()]),"number"==typeof t&&t>=0&&t<=u.levels.SILENT)return t;throw new TypeError("log.setLevel() called with invalid level: "+e)}"string"==typeof e?d+=":"+e:"symbol"==typeof e&&(d=void 0),u.name=e,u.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},u.methodFactory=t||l,u.getLevel=function(){return null!=o?o:null!=s?s:a},u.setLevel=function(e,t){return o=p(e),!1!==t&&function(e){var t=(n[e]||"silent").toUpperCase();if("undefined"!=typeof window&&d){try{return void(window.localStorage[d]=t)}catch(e){}try{window.document.cookie=encodeURIComponent(d)+"="+t+";"}catch(e){}}}(o),c.call(u)},u.setDefaultLevel=function(e){s=p(e),h()||u.setLevel(e,!1)},u.resetLevel=function(){o=null,function(){if("undefined"!=typeof window&&d){try{window.localStorage.removeItem(d)}catch(e){}try{window.document.cookie=encodeURIComponent(d)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}(),c.call(u)},u.enableAll=function(e){u.setLevel(u.levels.TRACE,e)},u.disableAll=function(e){u.setLevel(u.levels.SILENT,e)},u.rebuild=function(){if(r!==u&&(a=p(r.getLevel())),c.call(u),r===u)for(var e in i)i[e].rebuild()},a=p(r?r.getLevel():"WARN");var f=h();null!=f&&(o=p(f)),c.call(u)}(r=new d).getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=i[e];return t||(t=i[e]=new d(e,r.methodFactory)),t};var h="undefined"!=typeof window?window.log:void 0;return r.noConflict=function(){return"undefined"!=typeof window&&window.log===r&&(window.log=h),r},r.getLoggers=function(){return i},r.default=r,r},e.exports?e.exports=n():t.log=n()})),I=Object.freeze({__proto__:null,default:P,__moduleExports:P}),S=w((function(e,t){
/*!
   * @overview es6-promise - a tiny implementation of Promises/A+.
   * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
   * @license   Licensed under MIT license
   *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
   * @version   v4.2.8+1e68dce6
   */
e.exports=function(){function e(e){return"function"==typeof e}var t=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},n=0,i=void 0,r=void 0,a=function(e,t){h[n]=e,h[n+1]=t,2===(n+=2)&&(r?r(p):v())},s="undefined"!=typeof window?window:void 0,o=s||{},c=o.MutationObserver||o.WebKitMutationObserver,u="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),l="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){var e=setTimeout;return function(){return e(p,1)}}var h=new Array(1e3);function p(){for(var e=0;e<n;e+=2)(0,h[e])(h[e+1]),h[e]=void 0,h[e+1]=void 0;n=0}var f,m,y,g,v=void 0;function b(e,t){var n=this,i=new this.constructor(I);void 0===i[P]&&N(i);var r=n._state;if(r){var s=arguments[r-1];a((function(){return O(r,i,s,n._result)}))}else C(n,i,e,t);return i}function w(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(I);return T(t,e),t}u?v=function(){return process.nextTick(p)}:c?(m=0,y=new c(p),g=document.createTextNode(""),y.observe(g,{characterData:!0}),v=function(){g.data=m=++m%2}):l?((f=new MessageChannel).port1.onmessage=p,v=function(){return f.port2.postMessage(0)}):v=void 0===s?function(){try{var e=Function("return this")().require("vertx");return void 0!==(i=e.runOnLoop||e.runOnContext)?function(){i(p)}:d()}catch(e){return d()}}():d();var P=Math.random().toString(36).substring(2);function I(){}function S(t,n,i){n.constructor===t.constructor&&i===b&&n.constructor.resolve===w?function(e,t){1===t._state?k(e,t._result):2===t._state?E(e,t._result):C(t,void 0,(function(t){return T(e,t)}),(function(t){return E(e,t)}))}(t,n):void 0===i?k(t,n):e(i)?function(e,t,n){a((function(e){var i=!1,r=function(e,t,n,i){try{e.call(t,n,i)}catch(e){return e}}(n,t,(function(n){i||(i=!0,t!==n?T(e,n):k(e,n))}),(function(t){i||(i=!0,E(e,t))}),e._label);!i&&r&&(i=!0,E(e,r))}),e)}(t,n,i):k(t,n)}function T(e,t){if(e===t)E(e,new TypeError("You cannot resolve a promise with itself"));else if(r=typeof(i=t),null===i||"object"!==r&&"function"!==r)k(e,t);else{var n=void 0;try{n=t.then}catch(t){return void E(e,t)}S(e,t,n)}var i,r}function A(e){e._onerror&&e._onerror(e._result),M(e)}function k(e,t){void 0===e._state&&(e._result=t,e._state=1,0!==e._subscribers.length&&a(M,e))}function E(e,t){void 0===e._state&&(e._state=2,e._result=t,a(A,e))}function C(e,t,n,i){var r=e._subscribers,s=r.length;e._onerror=null,r[s]=t,r[s+1]=n,r[s+2]=i,0===s&&e._state&&a(M,e)}function M(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var i=void 0,r=void 0,a=e._result,s=0;s<t.length;s+=3)i=t[s],r=t[s+n],i?O(n,i,r,a):r(a);e._subscribers.length=0}}function O(t,n,i,r){var a=e(i),s=void 0,o=void 0,c=!0;if(a){try{s=i(r)}catch(e){c=!1,o=e}if(n===s)return void E(n,new TypeError("A promises callback cannot return that same promise."))}else s=r;void 0!==n._state||(a&&c?T(n,s):!1===c?E(n,o):1===t?k(n,s):2===t&&E(n,s))}var D=0;function N(e){e[P]=D++,e._state=void 0,e._result=void 0,e._subscribers=[]}var L=function(){function e(e,n){this._instanceConstructor=e,this.promise=new e(I),this.promise[P]||N(this.promise),t(n)?(this.length=n.length,this._remaining=n.length,this._result=new Array(this.length),0===this.length?k(this.promise,this._result):(this.length=this.length||0,this._enumerate(n),0===this._remaining&&k(this.promise,this._result))):E(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;void 0===this._state&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,i=n.resolve;if(i===w){var r=void 0,a=void 0,s=!1;try{r=e.then}catch(e){s=!0,a=e}if(r===b&&void 0!==e._state)this._settledAt(e._state,t,e._result);else if("function"!=typeof r)this._remaining--,this._result[t]=e;else if(n===U){var o=new n(I);s?E(o,a):S(o,e,r),this._willSettleAt(o,t)}else this._willSettleAt(new n((function(t){return t(e)})),t)}else this._willSettleAt(i(e),t)},e.prototype._settledAt=function(e,t,n){var i=this.promise;void 0===i._state&&(this._remaining--,2===e?E(i,n):this._result[t]=n),0===this._remaining&&k(i,this._result)},e.prototype._willSettleAt=function(e,t){var n=this;C(e,void 0,(function(e){return n._settledAt(1,t,e)}),(function(e){return n._settledAt(2,t,e)}))},e}();var U=function(){function t(e){this[P]=D++,this._result=this._state=void 0,this._subscribers=[],I!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t((function(t){T(e,t)}),(function(t){E(e,t)}))}catch(t){E(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var n=this.constructor;return e(t)?this.then((function(e){return n.resolve(t()).then((function(){return e}))}),(function(e){return n.resolve(t()).then((function(){throw e}))})):this.then(t,t)},t}();return U.prototype.then=b,U.all=function(e){return new L(this,e).promise},U.race=function(e){var n=this;return t(e)?new n((function(t,i){for(var r=e.length,a=0;a<r;a++)n.resolve(e[a]).then(t,i)})):new n((function(e,t){return t(new TypeError("You must pass an array to race."))}))},U.resolve=w,U.reject=function(e){var t=new this(I);return E(t,e),t},U._setScheduler=function(e){r=e},U._setAsap=function(e){a=e},U._asap=a,U.polyfill=function(){var e=void 0;if(void 0!==_)e=_;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=U},U.Promise=U,U}()}));function T(e,t){return t=t||{},new S((function(n,i){var r=new XMLHttpRequest;for(var a in r.open(t.method||"get",e,!0),t.headers)r.setRequestHeader(a,t.headers[a]);function s(){var e,t=[],n=[],i={};return r.getAllResponseHeaders().replace(/^(.*?):\s*?([\s\S]*?)$/gm,(function(r,a,s){t.push(a=a.toLowerCase()),n.push([a,s]),e=i[a],i[a]=e?"".concat(e,",").concat(s):s})),{ok:2==(r.status/100|0),status:r.status,statusText:r.statusText,url:r.responseURL,clone:s,text:function(){return S.resolve(r.responseText)},json:function(){return S.resolve(r.responseText).then((function(e){try{return JSON.parse(e)}catch(e){return{}}}))},blob:function(){return S.resolve(new Blob([r.response]))},headers:{keys:function(){return t},entries:function(){return n},get:function(e){return i[e.toLowerCase()]},has:function(e){return e.toLowerCase()in i}}}}r.withCredentials="include"===t.credentials,r.onload=function(){n(s())},r.onreadystatechange=function(){try{4===r.readyState&&(200===(e=r).status||201===e.status||202===e.status||204===e.status||0===e.status&&e.responseText&&""!==e.responseText?n(s()):i(s()))}catch(e){r.abort()}var e},r.onerror=i,r.send(t.body)}))}
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */var A=function(e,t){return(A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function k(e,t){function n(){this.constructor=e}A(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var E=function(){return(E=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function C(e,t,n,i){return new(n||(n=S))((function(r,a){function s(e){try{c(i.next(e))}catch(e){a(e)}}function o(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}c((i=i.apply(e,t||[])).next())}))}function M(e,t){var n,i,r,a,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(6===a[0]&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}}function O(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,a=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)s.push(i.value)}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return s}function D(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(O(arguments[t]));return e}var N=w((function(e,t){var n;e.exports=(n=n||function(e,t){var n=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),i={},r=i.lib={},a=r.Base={extend:function(e){var t=n(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=r.WordArray=a.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,n=e.words,i=this.sigBytes,r=e.sigBytes;if(this.clamp(),i%4)for(var a=0;a<r;a++){var s=n[a>>>2]>>>24-a%4*8&255;t[i+a>>>2]|=s<<24-(i+a)%4*8}else for(a=0;a<r;a+=4)t[i+a>>>2]=n[a>>>2];return this.sigBytes+=r,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=a.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n,i=[],r=function(t){t=t;var n=987654321,i=4294967295;return function(){var r=((n=36969*(65535&n)+(n>>16)&i)<<16)+(t=18e3*(65535&t)+(t>>16)&i)&i;return r/=4294967296,(r+=.5)*(e.random()>.5?1:-1)}},a=0;a<t;a+=4){var o=r(4294967296*(n||e.random()));n=987654071*o(),i.push(4294967296*o()|0)}return new s.init(i,t)}}),o=i.enc={},c=o.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],r=0;r<n;r++){var a=t[r>>>2]>>>24-r%4*8&255;i.push((a>>>4).toString(16)),i.push((15&a).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i+=2)n[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new s.init(n,t/2)}},u=o.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],r=0;r<n;r++){var a=t[r>>>2]>>>24-r%4*8&255;i.push(String.fromCharCode(a))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i++)n[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new s.init(n,t)}},l=o.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},d=r.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,i=n.words,r=n.sigBytes,a=this.blockSize,o=r/(4*a),c=(o=t?e.ceil(o):e.max((0|o)-this._minBufferSize,0))*a,u=e.min(4*c,r);if(c){for(var l=0;l<c;l+=a)this._doProcessBlock(i,l);var d=i.splice(0,c);n.sigBytes-=u}return new s.init(d,u)},clone:function(){var e=a.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),h=(r.Hasher=d.extend({cfg:a.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new h.HMAC.init(e,n).finalize(t)}}}),i.algo={});return i}(Math),n)})),L=w((function(e,t){var n,i,r;e.exports=(i=(n=r=N).lib.WordArray,n.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,i=this._map;e.clamp();for(var r=[],a=0;a<n;a+=3)for(var s=(t[a>>>2]>>>24-a%4*8&255)<<16|(t[a+1>>>2]>>>24-(a+1)%4*8&255)<<8|t[a+2>>>2]>>>24-(a+2)%4*8&255,o=0;o<4&&a+.75*o<n;o++)r.push(i.charAt(s>>>6*(3-o)&63));var c=i.charAt(64);if(c)for(;r.length%4;)r.push(c);return r.join("")},parse:function(e){var t=e.length,n=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var a=0;a<n.length;a++)r[n.charCodeAt(a)]=a}var s=n.charAt(64);if(s){var o=e.indexOf(s);-1!==o&&(t=o)}return function(e,t,n){for(var r=[],a=0,s=0;s<t;s++)if(s%4){var o=n[e.charCodeAt(s-1)]<<s%4*2,c=n[e.charCodeAt(s)]>>>6-s%4*2;r[a>>>2]|=(o|c)<<24-a%4*8,a++}return i.create(r,a)}(e,t,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},r.enc.Base64)})),U=w((function(e,t){e.exports=N.enc.Utf8}));function j(e){var t=e+":";return{Authorization:"Basic "+L.stringify(U.parse(t)),Accept:"application/json"}}var F,R="applicationId",x="applicationPlatform",H="deviceModel",B="mobileDevice",z="programmerName",V=function(){function e(e,t,n,i,r){t&&n&&i&&(this.programmer=e,this.applicationId=t,this.identityProvider=encodeURIComponent(n),this.subject=encodeURIComponent(i),this.metadata=r||{},this.serviceUrl="https://streams.adobeprimetime.com/v2",this.requestHeaders=j(t),this.heartbeatIntervalId=null,this.messages={})}return e.fetchMetadataKeys=function(t,n){return C(this,void 0,void 0,(function(){var i,r,a,s,o,c;return M(this,(function(u){switch(u.label){case 0:i=n+"/metadata",r=j(t),a={method:"GET",headers:r},u.label=1;case 1:return u.trys.push([1,5,,6]),[4,T(i,a)];case 2:return(s=u.sent())?[4,s.json()]:[3,4];case 3:return o=u.sent(),e.setLocalStorageByAppID(o,t),[2,!0];case 4:return[2,!1];case 5:return c=u.sent(),console.log("fetchMetadataKeys error: "+c),[2,!1];case 6:return[2]}}))}))},e.setLocalStorageByAppID=function(e,t){var n="AdobeCM.metadata."+t;localStorage.setItem(n,JSON.stringify(e))},Object.defineProperty(e.prototype,"metadataKeys",{get:function(){return this.getMetadataKeysFromLocalStorage_(this.applicationId)},enumerable:!1,configurable:!0}),e.prototype.getMetadataKeysFromLocalStorage_=function(e){var t="AdobeCM.metadata."+e,n=[];try{n=JSON.parse(localStorage.getItem(t))||[]}catch(e){console.error("AdobeCM getMetadataKeys error: "+e)}return n},e.prototype.start=function(){return C(this,void 0,void 0,(function(){var e;return M(this,(function(t){switch(t.label){case 0:return[4,this.createSession()];case 1:return(e=t.sent())?(this.scheduleHeartbeat(),[2,e]):[2,null]}}))}))},e.prototype.startWithSession=function(e){this.sessionId=e,this.scheduleHeartbeat()},e.prototype.stop=function(){this.heartbeatIntervalId&&(clearInterval(this.heartbeatIntervalId),this.heartbeatIntervalId=null),this.terminateSession()},e.prototype.createSession=function(e){return void 0===e&&(e=[]),C(this,void 0,void 0,(function(){var t,n,i,r,a,s,o,c,u,l;return M(this,(function(d){switch(d.label){case 0:P.debug("AdobeConcurrencyMonitorV2.createSession"),t=this.serviceUrl+"/sessions/"+this.identityProvider+"/"+this.subject,n=E({"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},this.requestHeaders),e.length>0&&(n["X-Terminate"]=e.join(",")),i=this.getMetadata(),r=Object.keys(i).map((function(e){return e+"="+encodeURIComponent(i[e])})).join("&"),a={method:"POST",headers:n,body:r},d.label=1;case 1:return d.trys.push([1,3,,5]),[4,this.fetchRequest(t,a,!0)];case 2:if(!(s=d.sent()))throw"fetchRequest failed";if(o=s.sessionId)return this.sessionId=o,P.debug("AdobeConcurrencyMonitorV2.createSession sessionId:",o),[2,o];throw c=s.status,u=s.json,{status:c,json:u};case 3:return l=d.sent(),P.error("AdobeConcurrencyMonitorV2.createSession error: ",l),[4,this.handleError(l,!1)];case 4:return[2,d.sent()];case 5:return[2]}}))}))},e.prototype.heartbeat=function(){return C(this,void 0,void 0,(function(){var e,t,n,i,r,a,s;return M(this,(function(o){switch(o.label){case 0:if(!(e=this.sessionId))return[2];P.debug("AdobeConcurrencyMonitorV2.heartbeat",e),t=this.serviceUrl+"/sessions/"+this.identityProvider+"/"+this.subject+"/"+e,n={method:"POST",headers:this.requestHeaders},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.fetchRequest(t,n,!1)];case 2:if(!(i=o.sent()))throw"fetchRequest failed";if(i.error)throw r=i.status,a=i.json,{status:r,json:a};return this.scheduleHeartbeat(),[3,4];case 3:return s=o.sent(),P.error("AdobeConcurrencyMonitorV2.heartbeat error: ",s),[2,this.handleError(s,!0)];case 4:return[2]}}))}))},e.prototype.scheduleHeartbeat=function(){var e=this;P.debug("AdobeConcurrencyMonitorV2.scheduleHeartbeat"),clearTimeout(this.heartbeatIntervalId),this.heartbeatIntervalId=window.setTimeout((function(){e.heartbeat()}),45e3)},e.prototype.fetchRequest=function(e,t,n){return C(this,void 0,void 0,(function(){var i,r,a,s,o;return M(this,(function(c){switch(c.label){case 0:return c.trys.push([0,4,,7]),[4,T(e,t)];case 1:return i=c.sent(),(r=i.status)>=200&&r<300?[3,3]:[4,i.clone().json().catch((function(){return!!i.text()||null}))];case 2:return o=c.sent(),[2,{status:r,json:o,error:!0}];case 3:return a=void 0,n&&(a=i.headers.get("location").trim()),[2,{sessionId:a,status:r,error:!1}];case 4:return s=c.sent(),console.error("AdobeCM fetchRequest: "+s),s&&409===s.status&&"function"==typeof s.json?[4,s.json()]:[3,6];case 5:return[2,{status:409,json:o=c.sent(),error:!0}];case 6:return[2,s];case 7:return[2]}}))}))},e.prototype.terminateSession=function(){return C(this,void 0,void 0,(function(){var e,t,n,i,r;return M(this,(function(a){switch(a.label){case 0:if(!(e=this.sessionId))return[2];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,T(t=this.serviceUrl+"/sessions/"+this.identityProvider+"/"+this.subject+"/"+e,{method:"DELETE",headers:this.requestHeaders})];case 2:if(n=a.sent(),!((i=n.status)>=200&&i<300))throw new Error("Error - url: "+t+", status: "+i);return[3,4];case 3:return r=a.sent(),console.error("AdobeCM TerminateSession "+r),[3,4];case 4:return[2]}}))}))},e.prototype.handleError=function(e,t){P.debug("AdobeConcurrencyMonitorV2.handleError",e);var n=e.status,i=e.json;switch(n){case 400:return this.handleError400_(i);case 409:return this.handleError409_(i,t);case 410:return this.handleError410_(i,t)}},e.prototype.handleError400_=function(t){return C(this,void 0,void 0,(function(){var n,i;return M(this,(function(r){switch(r.label){case 0:return n=t&&t.obligations||[],!!n.find((function(e){return"logout"===e.action||"refresh"===e.action}))?[4,e.fetchMetadataKeys(this.applicationId,this.serviceUrl)]:[3,2];case 1:if(r.sent(),i=this.metadata,Object.keys(i).length>=this.metadataKeys.length)return[2,this.start()];r.label=2;case 2:return[2,null]}}))}))},e.prototype.handleError409_=function(e,t){try{var n=(e&&e.associatedAdvice||[]).find((function(e){return"rule-violation"===e.type}));if(n){var i=n.message,r=this.messages[i]||i,a=new Error(r),s=!!(e.obligations||[]).find((function(e){return"logout"===e.action}));if(P.debug("AdobeConcurrencyMonitorV2.handleError",409,a,s),!t)throw a;this.onError(a,s)}}catch(a){throw P.debug("AdobeConcurrencyMonitorV2.handleError409_: "+a),a}return null},e.prototype.handleError410_=function(e,t){if(!e)return this.start();try{var n=(e&&e.associatedAdvice||[]).find((function(e){return"remote-termination"===e.type}));if(n){var i=n.message,r=this.messages[i]||i,a=new Error(r),s=!!e.obligations.find((function(e){return"logout"===e.action}));if(P.debug("AdobeConcurrencyMonitorV2.handleError",410,a,s),!t)throw a;this.onError(a,s)}}catch(a){throw P.debug("AdobeConcurrencyMonitorV2.handleError410_: "+a),a}return null},e.prototype.getMetadata=function(){var e=this;return this.metadataKeys.reduce((function(t,n){return t[n]=e.metadata[n],t}),{})},e.prototype.onError=function(e,t){P.debug("AdobeConcurrencyMonitor.onError"),P.debug("error: "+e),P.debug("shouldLogout: "+t)},e}();function K(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7].toString()+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,K)}function G(){}!function(e){e.abc="abc",e.abcNews="abcnews",e.abcNewsLive="abcnewslive",e.abcOtv="abcotv",e.disney="dch",e.disneyJr="djr",e.disneyXD="dxd",e.disneyNow="dnow",e.espn="espn",e.espnFantasy="espnFantasy",e.oscar="oscar",e.freeform="ff",e.foxLatam="foxlatam",e.fxNow="fxnow",e.fx="fx",e.fxm="fxm",e.fxx="fxx",e.natGeoTV="natgeotv",e.natGeo="natgeo",e.natGeoWild="natgeowild",e.natgeoBrasil="natgeobrasil",e.unknown="000"}(F||(F={})),G.prototype={on:function(e,t,n){var i=this.e||(this.e={});return(i[e]||(i[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){var i=this;function r(){i.off(e,r),t.apply(n,arguments)}return r._=t,this.on(e,r,n)},emit:function(e){for(var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),i=0,r=n.length;i<r;i++)n[i].fn.apply(n[i].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),i=n[e],r=[];if(i&&t)for(var a=0,s=i.length;a<s;a++)i[a].fn!==t&&i[a].fn._!==t&&r.push(i[a]);return r.length?n[e]=r:delete n[e],this}};var q=G,$=G;q.TinyEmitter=$;var W=function(e){function n(){return s(this,n),t(this,n,arguments)}return d(n,e),c(n,[{key:"getConfiguration",value:function(e,t){return{}}}]),n}(q),J=!1;try{J="caches"in self}catch(e){}var Y="UPDATED",Q=function(e){function n(){var e;if(s(this,n),(e=t(this,n))._bootstrap=null,e._cache=null,J)caches.open("watchsdk-cache").then((function(t){e._cache=t,t&&t.match("bootstrap").then((function(e){return e&&e.json()})).then((function(t){t&&null===e._bootstrap&&(e._bootstrap=t)}))}));else{var i=localStorage.getItem("BootstrapManager.bootstrap");try{var r=JSON.parse(U.stringify(L.parse(i)));e._bootstrap=r}catch(t){try{var a=JSON.parse(i);e._bootstrap=a}catch(e){}}}return e}return d(n,e),c(n,[{key:"bootstrap",get:function(){return this._bootstrap}},{key:"update",value:function(e){var t=this;return T(e).then((function(e){return e.json()})).then((function(e){if(P.debug("BootstrapManager.update() ".concat(JSON.stringify(e,null,2))),t._bootstrap=e,t._cache&&t._cache.put("bootstrap",new Response(JSON.stringify(e),{headers:{"Content-Type":"application/json"}})),!J){var n=L.stringify(U.parse(JSON.stringify(e)));localStorage.setItem("BootstrapManager.bootstrap",n)}t.emit(Y,t._bootstrap)}))}},{key:"getConfiguration",value:function(e,t){var n=this.bootstrap,r=n&&n[e]||{};if(t){var a=Object.keys(r).filter((function(e){return-1!==Object.keys(t).indexOf(e)})).reduce((function(e,t){return i(i({},e),{},u({},t,r[t]))}),{});r=i(i({},t),a)}return r}}]),n}(W);Q.shared=new Q;var X,Z=new(c((function e(t,n,i,r){s(this,e),this.enabled=t,this.serviceUrl=n,this.applicationId=null,this.applications=i,this.messages=r})))(!0,"https://streams.adobeprimetime.com/v2",{chromecast:{applicationId:"4c6fd925-7d06-4dbd-9edb-720962619882"},appletv:{applicationId:"eebe77ee-3064-4b4a-b89b-fef248a474be"},samsungtv:{applicationId:"0e3d9128-cdf7-4464-9952-55434ead1e8e"},web:{applicationId:"3bfbbbdf-be8e-40be-9540-97a73469ada2"},ps4:{applicationId:"41e7539c-d38f-4c20-856a-8db2de060287"},comcastflex:{applicationId:"8c1ffe19-f278-4ace-8fc4-833d0ce5c638"}},{}),ee="https://a.espncdn.com/connected-devices/app-configurations/espn-js-sdk-2.0.config.json",te={appletv:"dniqxcl2cnjuzgl04vuek1mm",chromecast:"1q86jvqka85r41w7daunp5ipgb",comcastflex:"flex-web-gk2lbqnmoddq1cjz4c7idqeka",comcastx1:"x1-web_ek3rjw4nlqxm1fo1a76xlwivr",comcastxclass:"watch-sdk-xclass_fparjzlo4iam15wy3pgpigulv",ps4:"kbjoe0y9awb41guc2nzey04ji",samsungtv:"csrf56z30hke1aozrm00ad50g",web:"uiqlbgzdwuru14v627vdusswb"},ne=function(e){var t=Q.shared.getConfiguration("adobeCM",Z);if(!1!==t.enabled){var n=t.applications&&t.applications[e],i=t.applicationId||n&&n.applicationId,r=t.serviceUrl;V.fetchMetadataKeys(i,r)}},ie=function(){function e(){s(this,e)}return c(e,null,[{key:"init",value:function(t,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.partner=t,e.platform=n,e.version=i,e.deviceId=e.deviceId||K(),P.debug(this.toString());var a=r&&r.bootstrapUrl||ee;return Q.shared.update(a).finally((function(){ne(e.platform)}))}},{key:"partner",get:function(){return localStorage.getItem("ESPNWatchSDK.Client.partner")},set:function(e){localStorage.setItem("ESPNWatchSDK.Client.partner",e)}},{key:"platform",get:function(){return localStorage.getItem("ESPNWatchSDK.Client.platform")},set:function(e){localStorage.setItem("ESPNWatchSDK.Client.platform",e)}},{key:"version",get:function(){return localStorage.getItem("ESPNWatchSDK.Client.version")},set:function(e){localStorage.setItem("ESPNWatchSDK.Client.version",e)}},{key:"deviceId",get:function(){return localStorage.getItem("ESPNWatchSDK.Client.deviceId")},set:function(e){localStorage.setItem("ESPNWatchSDK.Client.deviceId",e)}},{key:"toString",value:function(){return"<WatchSDK.Client partner:".concat(e.partner,", platform:").concat(e.platform,", deviceId:").concat(e.deviceId,">")}},{key:"apiKey",get:function(){return Q.shared.getConfiguration("shield",{apiKeys:te}).apiKeys[e.platform]||"mbmhfdgflphg14wss50rny3ct"}}]),e}();!function(e){e[e.all=0]="all",e[e.linearPlayback=1]="linearPlayback"}(X||(X={}));var re,ae=X;!function(e){e.linear="linear",e.event="event"}(re||(re={}));var se,oe=re;!function(e){e.stitchedPreroll="stitchedPreroll"}(se||(se={}));var ce,ue=se;!function(e){e.live="live",e.onDemand="onDemand"}(ce||(ce={}));var le,de=ce;!function(e){e.nielsen="nielsen",e.comscore="comscore",e.conviva="conviva",e.heartbeats="heartbeats"}(le||(le={}));var he,pe=le;!function(e){e.shortform="shortform",e.longform="longform"}(he||(he={}));var fe,me=he;!function(e){e.audio="audio",e.video="video"}(fe||(fe={}));var ye,ge=fe;!function(e){e.pluto="pluto",e.graphQL="graphQL",e.cfa="cfa",e.itemFeed="itemFeed"}(ye||(ye={}));var ve,be=ye;!function(e){e.open="OPEN",e.direct="DIRECT",e.mvpd="MVPD",e.isp="ISP",e.none="NONE"}(ve||(ve={}));var _e,we=ve;!function(e){e.none="none",e.startSession="startSession",e.bam="bam",e.shield="shield",e.entitlement="entitlement"}(_e||(_e={}));var Pe,Ie=_e;class Se{constructor(e,t,n,i,r,a,s,o,c){this.url=e,this.type=t,this.hasEspnId3Heartbeats=n,this.hasNielsenWatermarks=i,this.hasPassThroughAds=r,this.commercialReplacement=a,this.startSessionUrl=s,this.variant=o,this.originalSourceUrl=c}static fromObject(e){if(!e)return null;const{url:t,type:n,hasEspnId3Heartbeats:i,hasNielsenWatermarks:r,hasPassThroughAds:a,commercialReplacement:s,startSessionUrl:o,variant:c,originalSourceUrl:u}=e,l=Ie[n]||Ie.none;return new Se(t,l,i,r,a,s,o,c,u)}}class Te{constructor(e,t,n,i,r=null){this.id=e,this.type=t,this.name=n,this.resource=i,this.affiliate=r}static fromObject(e){if(!e)return null;const t=oe[e.type];return new Te(e.id,t,e.name,e.resource,e.affiliate)}}class Ae{constructor(e,t){this.url=e,this.ratio=t}static fromObject(e){if(null==e?void 0:e.url){const{url:t,ratio:n}=e;return new Ae(t,n)}return null}}class ke{constructor(e){this.name=e}get logoUrl(){return`https://secure.espncdn.com/watchespn/images/espnplus/packages/${this.name}.png`}static fromObject(e){return e?new ke(e.name):null}}!function(e){e.live="live",e.vod="vod",e.replay="replay"}(Pe||(Pe={}));var Ee=Pe;class Ce{constructor(e,t,n,i,r){this.id=e,this.title=t,this.duration=n,this.language=i||"en",this.source=r,this.ad={},this.description=null,this.authenticationTypes=[],this.mrss=null,this.seekInSeconds=null,this.tracking={},this.references={},this.network=null,this.streamType=null,this.contentType=null,this.supportedMediaCommands=ae.all,this.images=[],this.type=ge.video,this.packages=[],this.tier=null,this.entityType=null,this.isSyndicatable=null,this.brand=null,this.siteBrandId=null,this.apiSource=null,this.adUnitId=null,this.cues=null,this.adTarget=null,this.show=null,this.remoteTextTrack=null,this.advertisingInfo=null,this.schedule=null,this.firstPresented=null,this.placement=null}get isLinear(){return!!this.network&&this.network.type===oe.linear}get isLive(){return this.streamType===de.live}static fromObject(e){const t=Se.fromObject(e.source),n=new Ce(e.id,e.title,e.duration,e.language,t);return n.ad=e.ad,n.airDate=e.airDate,n.apiSource=e.apiSource,n.authenticationTypes=e.authenticationTypes,n.description=e.description,n.images=(e.images||[]).map(e=>Ae.fromObject(e)),n.mrss=e.mrss,n.network=Te.fromObject(e.network),n.seekInSeconds=e.seekInSeconds,n.streamType=de[e.streamType],n.contentType=Ee[e.contentType],n.supportedMediaCommands=e.supportedMediaCommands,n.tracking=e.tracking,n.references=e.references,n.packages=(e.packages||[]).map(e=>ke.fromObject(e)),n.tier=e.tier,n.type=ge[e.type],n.entityType=me[e.entityType],n.isSyndicatable=e.isSyndicatable,n.brand=e.brand,n.siteBrandId=e.siteBrandId,n.adUnitId=e.adUnitId,n.cues=e.cues,n.show=e.show,n.adTarget=e.adTarget,n.seekBarThumbnails=e.seekBarThumbnails,n.availableDate=e.availableDate,n.episodeNumber=e.episodeNumber,n.locale=e.locale,n.seasonNumber=e.seasonNumber,n.tmsid=e.tmsid,n.videoShowGenre=e.videoShowGenre,n.remoteTextTrack=e.remoteTextTrack,n.advertisingInfo=e.advertisingInfo,n.schedule=e.schedule,n.firstPresented=e.firstPresented,n.placement=e.placement,n}toString(){return`<MediaItem id:${this.id}, title:${this.title}, streamType:${this.streamType}>`}}class Me{constructor(e){const t=function(e){const t=e.split("?")[1],n={};if(t){const e=t.split("&");for(let t=0;t<e.length;t+=1){const i=e[t].split("=");n[i[0]]=i[1]}}return n}(e);if(this.original=e,this.id=t.videoID||t.playID||t.clip||t.externalId,this.replayId=t.replayId,e.match("sportscenter")){this.gameId=t.playGameID,this.channel=t.playChannel,this.simulcastAiringId=t.simulcastAiringId;const e=parseInt(t.resumeTime,10);isNaN(e)||(this.resumeTime=e),this.eventId=t.eventId}else e.match("abcnews")&&(this.channel=t.playChannel,this.id=t.videoID||t.id);this.source=t["x-source"],t.videoID?this.entityType=me.shortform:this.entityType=me.longform,this.type=ge.video}toString(e){return e==be.graphQL?`<MediaItemIdentifier id:${this.id}, gameId:${this.gameId}, channel:${this.channel}, source:${this.source}>`:`<MediaItemIdentifier id:${this.id}, source:${this.source}>`}static identifierStringForNetwork(e,t){switch(t){case be.cfa:return"natgeo://playVideo?videoID="+e;case be.itemFeed:return"abcnews://playVideo?playChannel="+e;case be.graphQL:default:return"sportscenter://x-callback-url/showWatchStream?playChannel="+e}}}const Oe=new Set(["ESPN","ESPN2"]);function De(e){return Oe.has(e)}function Ne(e,t,n){if(!e)return{};const{duration:i,id:r,league:a,name:s,network:o,program:c,sport:u,startDateTime:l,tracking:d}=e,h={};let p="2";if(function(e,t,n){const i=e===me.longform,r=t===de.live,a=t===de.onDemand;return i&&a||function(e){return"ESPN+"===e}(n)||r&&De(n)}(t,n,null==o?void 0:o.name)&&(p="1"),h.adloadtype=p,n===de.live&&De(null==o?void 0:o.name)&&(h.admodel="1"),h.type="content",h.assetid=d&&d.trackingId||r,h.program=s,h.title=s,h.clientid="us-600140",n===de.onDemand&&(h.vcid="c17"),t===me.longform){if(h.length=""+i,h.segB=a&&a.name||"No League",h.segC=`${c&&c.code||""}${u&&u.code||""}`,l){const e=new Date(l);h.airdate=`${e.getUTCFullYear().toString()+("0"+e.getUTCMonth()).slice(-2)+("0"+e.getUTCDate()).slice(-2)} ${("0"+e.getUTCHours()).slice(-2)}:${("0"+e.getUTCMinutes()).slice(-2)}:${("0"+e.getUTCSeconds()).slice(-2)}`}h.isfullepisode="y",h.crossId1=d&&d.nielsenCrossId1||"",h.crossId2=o&&o.name||"",h.hasAds="1",h.progen="SE"}return t===me.shortform&&(h.accmethod="1",h.length=""+i,h.segA=s,h.segB="No League",h.segC="VOD",h.isfullepisode="n",h.crossId1=""),h}var Le;function Ue(e,t,n,i){if(!t)return{};let r,a,s,o=null;const c=null==e?void 0:e.streamType;(null==e?void 0:e.brand)===Le.natGeo?o=function(e){if(!e)return{};const t={},{id:n,title:i,duration:r}=e;return t.c_video_id_code=n,t.c_a_media_airdate="unknown",t.c_a_media_daypart="daytime",t.c_a_media_digitaldate="unknown",t.c_a_media_episode="none",t.c_a_media_feed="natgeo live",t.c_a_media_format="vod",t.c_a_media_genre="none",t.c_a_media_network="natgeo",t.c_a_media_originator="natgeo",t.c_a_media_pass_auth="none",t.c_a_media_pass_mvpd="none",t.c_a_media_rating="none",t.c_a_media_season="none",t.c_a_media_show=i,t.c_a_media_streamtype=fe.video,t.c_a_media_length=r,t}(t):(r=Ne(t,n,c),a=function(e,t){if(!e)return{};const{id:n,duration:i,name:r,league:a,startDateTime:s,network:o,sport:c,status:u,tracking:l,program:d}=e,h={};let p="",f="";if(t===me.longform?(h.ns_st_cl=0,h.ns_st_ct="vc",!u||"live"!==u.toLowerCase()&&"over"!==u.toLowerCase()?(h.ns_st_cl=i,h.ns_st_ct="vc12",h.ns_st_pr="VOD",h.ns_st_ep=r):(h.ns_st_cl=0,h.ns_st_ct="vc13",h.ns_st_pr=r,h.ns_st_ep="*null"),h.c3="WATCHESPNLIVE",(null==a?void 0:a.name)&&(p=""+a.name),(null==c?void 0:c.name)&&(f=""+c.name)):(h.ns_st_cl=i,h.ns_st_ct="vc11",h.ns_st_pr="VOD",h.ns_st_ep=r,(null==l?void 0:l.leagueName)&&"No League"!==(null==l?void 0:l.leagueName)&&(p=""+l.leagueName),(null==l?void 0:l.sportName)&&(f=""+l.sportName),h.c3="vod"),h.c6=p?(null==d?void 0:d.isStudio)?p+" studio":p:f?(null==d?void 0:d.isStudio)?f+" studio":f:(null==c?void 0:c.code)||"No Sport",h.ns_st_ti="*null",h.ns_st_ia="*null",h.ns_st_ce="*null",h.ns_st_ci=n,s){const e=new Date(s);h.ns_st_ddt=e.toDateString(),h.ns_st_tdt=e.toDateString()}return h.ns_st_st=o?o.id:"*null",h.ns_st_en="*null",h.ns_st_cn="1",h.ns_st_pn="1",h.ns_st_tp="1",h.ns_st_pu="ESPN",h.ns_st_cu="none",h.ns_st_ad="0",h.ns_st_ge="Sports",h}(t,n),s=function(e,t,n){if(!e)return{};const{name:i,id:r,airingId:a,eventId:s,duration:o,network:c,status:u,sport:l,league:d,pccId:h,tracking:p}=e,f=null==p?void 0:p.tags,m={};m.contentId=r,h&&(m.pccId=h),a&&(m.airingId=a),s&&(m.eventId=""+s,m.eventName=i),c&&(m.network=c.id),t===me.shortform?m.assetType="clip":!u||"live"!==u.toLowerCase()&&"over"!==u.toLowerCase()?m.assetType="vod":m.assetType="live";const y=`${i} - ${r}`;return m.sport=l&&l.name||"NA",m.league=d&&d.name||"NA",m.appBrand=Le.espn,m.channel=(null==c?void 0:c.id)||"NA",{assetName:y,duration:o,tags:f,streamUrl:n&&n.url,custom:m}}(t,n,i),o=function(e,t){if(!e)return{};const{duration:n,airingId:i,network:r,status:a,sport:s,league:o,name:c,program:u,startDateTime:l,tracking:d,originalPublishDate:h,expirationDate:p,lastModifiedDate:f,ad:m,coverageType:y,brands:g}=e,v={};if(v.ContentDuration=n,t===me.longform){if(v.CMSID=d&&d.name||c,v.isFullEpisode="y",i&&(v.AiringID=i),r&&(v.NetworkName=r.id,v.Channel=r.id),a&&(v.VideoType="REPLAY"===a?"replay":"live"),v.Sport=s&&s.name||"Not Applicable",v.SportCode=s&&s.code||"Not Applicable",v.League=o&&o.name||"Not Applicable",u&&u.code&&u.categoryCode?v.ProgramCode=u.categoryCode+u.code:v.ProgramCode="Not Applicable",v.IsStudio=u&&u.isStudio||"Not Applicable",l){const e=new Date(l);v.AirDate=e.toDateString(),v.AirTime=e.toTimeString()}if(Array.isArray(g)&&g.length){const{id:e,name:t,type:n}=g[0];v["a.media.asset"]=e,v["a.media.show"]=t,v["a.media.genre"]=n}}else if(t===me.shortform){if(v.isFullEpisode="n",v.VideoType="vod",v.Sport=d&&d.sportName||"Not Applicable",v.League=d&&d.leagueName||"Not Applicable",v.ShowCode=m&&m.bundle||"Not Applicable",d&&d.name&&(v.CMSID=d.name),h){const e=new Date(h);v.PublishDate=e.toISOString().substring(0,10),v.PublishTime=e.toISOString().substring(11)}if(p){const e=new Date(p);v.ExpirationDate=e.toISOString()}if(f){const e=new Date(f);v.DateLastModified=e.toISOString()}y&&(v.VideoTypeDetail=y)}return v}(t,n));const u={};return u[pe.nielsen]=r,u[pe.comscore]=a,u[pe.conviva]=s,u[pe.heartbeats]=o,u}!function(e){e.abc="abc",e.abcNews="abcnews",e.abcNewsLive="abcnewslive",e.abcOtv="abcotv",e.cricinfo="cricinfo",e.disney="dch",e.disneyJr="djr",e.disneyXD="dxd",e.disneyNow="dnow",e.espn="espn",e.espnFantasy="espnFantasy",e.fiveThirtyEight="fivethirtyeight",e.foxLatam="foxlatam",e.freeform="ff",e.fxNow="fxnow",e.fx="fx",e.fxm="fxm",e.fxx="fxx",e.oscar="oscar",e.marvel="marvel",e.natGeoTV="ngtv",e.natGeo="ngc",e.natGeoWild="ngw",e.natgeoBrasil="natgeobrasil",e.theUndefeated="theundefeated",e.fast="fast",e.unknown="000"}(Le||(Le={}));const je=["espn_ppv","espn_dtc","espn1","espn2","espn3","espnu","sec","espnews","espndeportes","longhorn","goalline","buzzerbeater","secplus","acc","accextra","espn_free","bam_dtc"];class Fe{constructor(e,t,n,i){e===be.graphQL?(this.serviceUrl=t||"https://watch.graph.api.espn.com/api",this.apiKey=n||"d15c5790-7cb0-4fe1-8782-25f4698d0739",this.networkSortOrder=i||je):e===be.cfa?(this.apiSource=e,this.serviceUrl=t):e===be.itemFeed&&(this.serviceUrl=t||"https://abcnews.go.com/video/itemfeed")}}class Re{constructor(){this.configuration_=Re.defaultConfiguration}get configuration(){return this.configuration_}set configuration(e){this.configuration_=e}getMediaItems(e,t){return C(this,void 0,void 0,(function*(){return yield Re.fetchMediaItems(e,t,this.configuration)}))}static fetchMediaItems(e,t,n){return C(this,void 0,void 0,(function*(){const i=e.map(e=>new Me(e)),{serviceUrl:r,apiKey:a,networkSortOrder:s}=n,o=(yield S.all(i.map(e=>Re.getPromiseMediaItems(e,r,a,t)))).filter(e=>!(e instanceof Error)&&e instanceof Ce);return o.length?function(e,t,n){return e.sort((e,t)=>{const n="PRIMARY"===e.tier?0:"SECONDARY"===e.tier?1:2,i="PRIMARY"===t.tier?0:"SECONDARY"===t.tier?1:2;return n<i?-1:n>i?1:0}).sort((e,n)=>{const i=e.network&&e.network.id.toLowerCase()||"unknown",r=n.network&&n.network.id.toLowerCase()||"unknown";let a=t.indexOf(i),s=t.indexOf(r);return-1===a&&(a=999),-1===s&&(s=999),a<s?-1:a>s?1:0}).sort((e,t)=>{const i=e.language===n?0:1,r=t.language===n?0:1;return i<r?-1:i<r?1:0})}(o,s,navigator.language):null}))}static getPromiseMediaItems(e,t,n,i){return C(this,void 0,void 0,(function*(){const r=function({identifier:e,serviceUrl:t,apiKey:n,options:i}){let r="",a="",s="";const{countryCode:o,languageCode:c,isFlagshipEnabled:u}=i,l=o||"US",d=c?`,languageCode:"${c}"`:"";return e.entityType===me.shortform?(r="VOD",s="{id name description authTypes language duration originalPublishDate expirationDate requiresLinearPlayback lastModifiedDate source { url authorizationType } image { url } tracking { name sportName leagueName } coverageType prerollSource:source(variant:PREROLL) { url authorizationType } ad { sport bundle testGroup } links { web } cerebroId syndicatable pccId }",a=`id:"${e.id}"`):(r="airing",s="{ id name description mrss:adobeRSS authTypes requiresLinearPlayback status:type startDateTime endDateTime duration firstPresented source(authorization: SHIELD) { url authorizationType hasEspnId3Heartbeats hasNielsenWatermarks hasPassThroughAds commercialReplacement startSessionUrl } network { id type name adobeResource } image { url } sport { name code uid } league { name uid } program { code categoryCode isStudio } seekInSeconds simulcastAiringId airingId tracking { nielsenCrossId1 trackingId } eventId packages { name } language tier feedName brands { id name type } }",e.id?a=`id:"${e.id}"`:e.channel?(r="airings",a=`networks:["${e.channel}"],type:LIVE`):e.gameId?(r="airings",a=`eventId:"${e.eventId||e.gameId}"`):e.replayId&&(r="airings",a=`simulcastAiringId:"${e.replayId}",type:REPLAY`)),`${t}?apiKey=${n}&query=${encodeURIComponent(`{ ${r}(${a},countryCode:"${l}"${d},deviceType:SETTOP,tz:"Z") ${s} }`)}${u?"&features=flagship":""}`}({identifier:e,serviceUrl:t,apiKey:n,options:i}),a=i&&i.swid,s=a?{method:"GET",headers:{"x-p13n-swid":a}}:{};try{const a=yield T(r,s),o=yield a.json();let{airing:c}=o.data;const{airings:u}=o.data;if(u){const t=e.simulcastAiringId?t=>t.simulcastAiringId===e.simulcastAiringId:()=>!0;c=u.filter(t)[0]}const l=o.data.VOD,d=c||l;if(!d)throw new Error("No results found.");const h=function(e,t,n){const{ad:i,id:r,name:a,description:s,duration:o,image:c,eventId:u,requiresLinearPlayback:l,authTypes:d,source:h,prerollSource:p,packages:f,language:m,mrss:y,seekInSeconds:g,tracking:v,simulcastAiringId:b,network:_,status:w,cerebroId:P,syndicatable:I,firstPresented:S}=e,T=w&&("LIVE"===w.toUpperCase()||"OVER"===w.toUpperCase())?de.live:de.onDemand,A=(e=>{switch(e){case"NONE":return Ie.none;case"START_SESSION":return Ie.startSession;case"BAM":return Ie.bam;case"SHIELD":return Ie.shield}})(h.authorizationType);let k=new Se(h.url,A,h.hasEspnId3Heartbeats,h.hasNielsenWatermarks,h.hasPassThroughAds,h.commercialReplacement,h.startSessionUrl,void 0,h.url);n&&n.sourceVariant===ue.stitchedPreroll&&p&&(k=Se.fromObject({url:p.url,type:Ie.none,originalSourceUrl:h.url}),k.variant=ue.stitchedPreroll);const E=l?ae.linearPlayback:ae.all,C=v&&v.trackingId||r,M=new Ce(r,a,o,m,k);if(M.authenticationTypes=d.map(e=>{switch(e){case"DIRECT":return we.direct;case"OPEN":return we.open;case"MVPD":return we.mvpd;case"ISP":return we.isp;default:return we.none}}),M.description=s,M.isSyndicatable=I,Array.isArray(M.images)&&(null==c?void 0:c.url)&&M.images.push(new Ae(c.url)),M.mrss=y,_){const e="linear"===_.type?oe.linear:oe.event;M.network=new Te(_.id,e,_.name,_.adobeResource)}return M.seekInSeconds=g,M.streamType=T,M.contentType=w?w.toLocaleLowerCase():T===de.live?Ee.live:Ee.vod,i&&(M.ad=i),M.supportedMediaCommands=E,M.brand=M.brand?M.brand:"espn",M.references={eventId:u,simulcastAiringId:b,trackingId:C,cerebroId:P},M.type=ge.video,M.entityType=t,M.apiSource=be.graphQL,M.packages=(f||[]).map(e=>new ke(e.name)),M.tracking=Ue(M,e,t,k),M.firstPresented=S,M}(d,e.entityType,i);if(e.resumeTime&&(h.seekInSeconds=e.resumeTime),!h.source.url){const e="OVER"===d.status.toUpperCase(),r=d.network&&d.network.type===oe.linear,a=d.network&&d.network.id;if(e&&r&&a)return Re.retryGetMediaItems(a,t,n,i);throw new Error("No playable url")}return h}catch(e){return P.warn("Failed to retrieve MediaItem from GraphQL: "+e),null}}))}static retryGetMediaItems(e,t,n,i){return C(this,void 0,void 0,(function*(){try{const r=Me.identifierStringForNetwork(e,be.graphQL),a=new Me(r),s=yield Re.getPromiseMediaItems(a,t,n,i);if(s&&s instanceof Ce==!0)return s;throw new Error("Retry fetchMediaItems failed with "+e)}catch(e){return P.warn("MediaItem is over and retry failed: "+e),null}}))}}Re.defaultConfiguration=new Fe(be.graphQL);class xe{constructor(){this.serviceUrlForNatgeo_="https://natgeo.entertainment.client.dtci.technology/v1/playback/video/id",this.serviceUrlForNews_="https://abcnews.entertainment.client.dtci.technology/v1/playback/video/id",this.serviceUrlForMarvel_="https://marvel.entertainment.client.dtci.technology/v1/playback/video/id"}get configuration(){return this.configuration_}set configuration(e){this.configuration_=e}getMediaItems(e,t){return C(this,void 0,void 0,(function*(){const n=this.getServiceUrl_(null==t?void 0:t.brand);return yield xe.fetchMediaItems(e,t,n)}))}getServiceUrl_(e){var t;if(null===(t=this.configuration)||void 0===t?void 0:t.serviceUrl)return this.configuration.serviceUrl;switch(e){case"abcn":case"kabc":case"kfsn":case"kgo":case"ktrk":case"wabc":case"wls":case"wpvi":case"wtvd":return this.serviceUrlForNews_;case"marvel":return this.serviceUrlForMarvel_;default:return this.serviceUrlForNatgeo_}}static fetchMediaItems(e,t,n){return C(this,void 0,void 0,(function*(){const i=e.map(e=>new Me(e));return(yield S.all(i.map(e=>xe.getPromiseMediaItem(e,t,n)))).filter(e=>!(e instanceof Error)&&e instanceof Ce)}))}static getPromiseMediaItem(e,t,n){return C(this,void 0,void 0,(function*(){const i=`${n}/${e.id}${xe.getUrlParams(t)}`;try{const{token:e}=t;let n={};e&&(n={header:"Authorization: Bearer "+e});const r=yield T(i,n),a=yield r.clone().json();return function(e){var t,n;const{id:i,title:r,duration:a,language:s,source:o,type:c,entityType:u,streamType:l,authenticationTypes:d,description:h,supportedMediaCommands:p,network:f,tracking:m,brand:y,images:g,textTracks:v,advertisingInfo:b,schedule:_}=e,w=o.type,P=new Se(o.url,w),I=2===p?ae.linearPlayback:ae.all,S=(null==m?void 0:m.mParticle)||{},T=`${r} - ${i}`;let A;if(null===(t=null==g?void 0:g[0])||void 0===t?void 0:t.name){const e=g.filter(e=>"thumbnail"===e.name)[0].crops.filter(e=>"16x9"===e.name)[0];A=[{url:e.url,ratio:e.name}]}else A=g;const k={id:i,apiSource:be.cfa,seasonNumber:null==S?void 0:S.content_season,episodeNumber:null==S?void 0:S.episode_number,genre:null==S?void 0:S.content_genre,show:null==S?void 0:S.content_show,network:f,title:r,duration:a,language:s,source:P,description:h,authenticationTypes:d,brand:y,type:c,entityType:u,streamType:l,images:A,supportedMediaCommands:I,airDate:null==S?void 0:S.content_first_air_date,availableDate:null==S?void 0:S.content_digital_date,remoteTextTrack:(null===(n=null==v?void 0:v[0])||void 0===n?void 0:n.source)||null,tracking:{nielsen:{type:"content",assetid:null==S?void 0:S.content_asset_id,program:null==S?void 0:S.content_title,title:null==S?void 0:S.content_title},conviva:{assetName:T,duration:a,tags:null==S?void 0:S.tags,streamURL:null==S?void 0:S.stream_url,custom:{network:f,prt:"dmed",airingId:null==S?void 0:S.content_airing_id,contentId:null==S?void 0:S.content_id,appBrand:y,accessType:l}},heartbeats:{ContentDuration:a,isFullEpisode:u===me.longform?"y":"n",VideoType:l,CMSID:T,PublishDate:null==S?void 0:S.content_digital_date},comscore:{comscoreC6:"No Sport",comscoreContentType:null==S?void 0:S.content_type,publisher:y}},advertisingInfo:b,schedule:_};return k.authenticationTypes=d.map(e=>{switch(e){case"DIRECT":return we.direct;case"OPEN":return we.open;case"MVPD":return we.mvpd;case"ISP":return we.isp;default:return we.none}}),Ce.fromObject(k)}(a)}catch(e){return console.error("Failed to retrieve MediaItem from CFA: "+e),null}}))}static getUrlParams(e){const{brand:t="",platform:n="web",_passthrough:i,env:r="prod",containerId:a}=e||{},s=t?"&brand="+t:"";if("natgeo"===t||"marvel"===t){let t=`?platform=${n}${a?"&container-id="+a:""}`;if("dev"===r){t+=`${i?"&_passthrough="+i:""}${e["meter-remaining"]?"&meter-remaining="+e["meter-remaining"]:""}`}return t}return`?platform=${n}${s}`}}const He=Object.freeze({}),Be=Object.freeze({}),ze=be.itemFeed,Ve="abcn",Ke={lf:"longform",sf:"shortform",live:"longform"},Ge={"abcn:fivethirtyeight":"fivethirtyeight",abcn:"abcnews"},qe={name:"abc_news_live",type:"linear"},$e=["HLS_ALL","PDL_MED","PDL_LOW"];function We(e){const t=(e||He).channel||He,n=t.item||He,i=n["media-group"]||He,r=i["media-content"]||Be,a=i["media-title"],s=(function(e){var t,n;const i=$e.length,r=e.length;for(let a=0;a<i;a++){const i=$e[a];for(let a=0;a<r;a++){const r=e[a];if((null===(n=null===(t=null==r?void 0:r["media-category"])||void 0===t?void 0:t["@attributes"])||void 0===n?void 0:n.label)===i)return r}}}(r)||He)["@attributes"]||He,o=(i["media-thumbnail"]||He)["@attributes"]||He,{guid:c,title:u,temporalType:l,timestamp:d,link:h}=n,{duration:p,url:f,medium:m}=s,y=(n.omniture||He).channel||"",[g=Ve]=String(y).split(":"),v=Ge[y]||Ge[g]||"abcnews",b="vod"===l,_="live"===l,w=Ke[n.videoContentType]||(b?"shortform":"longform"),P=a||u,I=t.language||"en";let S,T;try{[S,T]=new Date(d).toISOString().split("T")}catch(e){console.warn(e)}const A="akamai live stream"!==n.mediatype||b?{}:Object.assign(Object.assign({},qe),{id:c}),k={id:c,apiSource:ze,seasonNumber:"none",eventId:"none",episodeNumber:"none",genre:"news",tvrating:"none",network:A,show:{title:P},title:P,duration:p,language:I,source:{url:f,type:"none"},description:n.description||i["media-description"],authenticationTypes:["NONE"],mrss:null,seekInSeconds:null,brand:v,type:"video"===m?"video":"audio",entityType:w,streamType:_?"live":"onDemand",images:o?[{url:o.url}]:null,airDate:n.timestamp,availableDate:n.pubDate,references:{itemfeed:c},tracking:{omniture:n.omniture,nielsen:{type:"content",assetid:c,program:P,title:P},conviva:{assetName:u,duration:p,streamURL:f,custom:{contentId:c,assetType:b?"clip":"live",sport:"none",league:"none",appBrand:n.category||"abcnews"}},heartbeats:{ContentDuration:p,isFullEpisode:"shortform"===w||_?"n":"y",VideoType:l,CMSID:P,PublishDate:S,PublishTime:T}},webHref:h};return Ce.fromObject(k)}var Je=new RegExp("(%[a-f0-9]{2})|([^%]+?)","gi"),Ye=new RegExp("(%[a-f0-9]{2})+","gi");function Qe(e,t){try{return[decodeURIComponent(e.join(""))]}catch(e){}if(1===e.length)return e;t=t||1;var n=e.slice(0,t),i=e.slice(t);return Array.prototype.concat.call([],Qe(n),Qe(i))}function Xe(e){try{return decodeURIComponent(e)}catch(i){for(var t=e.match(Je)||[],n=1;n<t.length;n++)t=(e=Qe(t,n).join("")).match(Je)||[];return e}}var Ze=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"","%FF%FE":""},n=Ye.exec(e);n;){try{t[n[0]]=decodeURIComponent(n[0])}catch(e){var i=Xe(n[0]);i!==n[0]&&(t[n[0]]=i)}n=Ye.exec(e)}t["%C2"]="";for(var r=Object.keys(t),a=0;a<r.length;a++){var s=r[a];e=e.replace(new RegExp(s,"g"),t[s])}return e}(e)}},et=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const n=e.indexOf(t);return-1===n?[e]:[e.slice(0,n),e.slice(n+t.length)]},tt=function(e,t){for(var n={},i=Object.keys(e),r=Array.isArray(t),a=0;a<i.length;a++){var s=i[a],o=e[s];(r?-1!==t.indexOf(s):t(s,o,e))&&(n[s]=o)}return n},nt=w((function(e,t){function n(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function i(e,t){return t.encode?t.strict?encodeURIComponent(e).replace(/[!'()*]/g,e=>"%"+e.charCodeAt(0).toString(16).toUpperCase()):encodeURIComponent(e):e}function r(e,t){return t.decode?Ze(e):e}function a(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function s(e){const t=(e=a(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function o(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function c(e,t){n((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const i=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,i)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===i[e]&&(i[e]={}),i[e][t[1]]=n):i[e]=n};case"bracket":return(e,n,i)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==i[e]?i[e]=[].concat(i[e],n):i[e]=[n]:i[e]=n};case"comma":case"separator":return(t,n,i)=>{const a="string"==typeof n&&n.includes(e.arrayFormatSeparator),s="string"==typeof n&&!a&&r(n,e).includes(e.arrayFormatSeparator);n=s?r(n,e):n;const o=a||s?n.split(e.arrayFormatSeparator).map(t=>r(t,e)):null===n?n:r(n,e);i[t]=o};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),a=Object.create(null);if("string"!=typeof e)return a;if(!(e=e.trim().replace(/^[?#&]/,"")))return a;for(const n of e.split("&")){if(""===n)continue;let[e,s]=et(t.decode?n.replace(/\+/g," "):n,"=");s=void 0===s?null:["comma","separator"].includes(t.arrayFormat)?s:r(s,t),i(r(e,t),s,a)}for(const e of Object.keys(a)){const n=a[e];if("object"==typeof n&&null!==n)for(const e of Object.keys(n))n[e]=o(n[e],t);else a[e]=o(n,t)}return!1===t.sort?a:(!0===t.sort?Object.keys(a).sort():Object.keys(a).sort(t.sort)).reduce((e,t)=>{const n=a[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((e,t)=>Number(e)-Number(t)).map(e=>t[e]):t}(n):e[t]=n,e},Object.create(null))}t.extract=s,t.parse=c,t.stringify=(e,t)=>{if(!e)return"";n((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const r=n=>t.skipNull&&null==e[n]||t.skipEmptyString&&""===e[n],a=function(e){switch(e.arrayFormat){case"index":return t=>(n,r)=>{const a=n.length;return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[i(t,e),"[",a,"]"].join("")]:[...n,[i(t,e),"[",i(a,e),"]=",i(r,e)].join("")]};case"bracket":return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[i(t,e),"[]"].join("")]:[...n,[i(t,e),"[]=",i(r,e)].join("")];case"comma":case"separator":return t=>(n,r)=>null==r||0===r.length?n:0===n.length?[[i(t,e),"=",i(r,e)].join("")]:[[n,i(r,e)].join(e.arrayFormatSeparator)];default:return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,i(t,e)]:[...n,[i(t,e),"=",i(r,e)].join("")]}}(t),s={};for(const t of Object.keys(e))r(t)||(s[t]=e[t]);const o=Object.keys(s);return!1!==t.sort&&o.sort(t.sort),o.map(n=>{const r=e[n];return void 0===r?"":null===r?i(n,t):Array.isArray(r)?r.reduce(a(n),[]).join("&"):i(n,t)+"="+i(r,t)}).filter(e=>e.length>0).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[n,i]=et(e,"#");return Object.assign({url:n.split("?")[0]||"",query:c(s(e),t)},t&&t.parseFragmentIdentifier&&i?{fragmentIdentifier:r(i,t)}:{})},t.stringifyUrl=(e,n)=>{n=Object.assign({encode:!0,strict:!0},n);const r=a(e.url).split("?")[0]||"",s=t.extract(e.url),o=t.parse(s,{sort:!1}),c=Object.assign(o,e.query);let u=t.stringify(c,n);u&&(u="?"+u);let l=function(e){let t="";const n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);return e.fragmentIdentifier&&(l="#"+i(e.fragmentIdentifier,n)),`${r}${u}${l}`},t.pick=(e,n,i)=>{i=Object.assign({parseFragmentIdentifier:!0},i);const{url:r,query:a,fragmentIdentifier:s}=t.parseUrl(e,i);return t.stringifyUrl({url:r,query:tt(a,n),fragmentIdentifier:s},i)},t.exclude=(e,n,i)=>{const r=Array.isArray(n)?e=>!n.includes(e):(e,t)=>!n(e,t);return t.pick(e,r,i)}}));nt.extract,nt.parse,nt.stringify,nt.parseUrl,nt.stringifyUrl,nt.pick,nt.exclude;class it{constructor(){this.configuration_=it.defaultConfiguration}get configuration(){return this.configuration_}set configuration(e){this.configuration_=e}getMediaItems(e,t){return C(this,void 0,void 0,(function*(){return yield it.fetchMediaItems(e,t,this.configuration)}))}static fetchMediaItems(e,t,n){return C(this,void 0,void 0,(function*(){const t=e.map(e=>new Me(e)),{serviceUrl:i}=n;return(yield S.all(t.map(e=>it.getPromiseMediaItem(e,i)))).filter(e=>!(e instanceof Error)&&e instanceof Ce)}))}static getPromiseMediaItem(e,t){return C(this,void 0,void 0,(function*(){const n=nt.stringify({id:e.id||e.channel});try{const e=yield T(`${t}?${n}&requester=guardians`),i=yield e.json();return We(i)}catch(e){return P.warn("Failed to retrieve MediaItem from ItemFeed endpoint: "+e),null}}))}}it.defaultConfiguration=new Fe(be.itemFeed);class rt{get configuration(){return this.configuration_}set configuration(e){this.configuration_=e}getMediaItems(e,t){return C(this,void 0,void 0,(function*(){const n=t||{sourceVariant:null};return yield S.all(e.map(e=>C(this,void 0,void 0,(function*(){return this.getMediaItemsFromIdentifier_(e,n)}))))}))}getMediaItemsFromIdentifier_(e,t){return C(this,void 0,void 0,(function*(){const n=this.getMediaItemAPIClass_(e,null==t?void 0:t.apiSource);n.configuration=this.configuration instanceof Fe?this.configuration:n.configuration;try{const i=yield n.getMediaItems([e],t);return Array.isArray(i)&&i[0]||null}catch(e){console.error("UniversalMediaItemAPI getMediaItems error: ",e)}return null}))}getMediaItemAPIClass_(e,t){switch(!0){case t===be.cfa:return new xe;case 0===e.indexOf("abcnews"):return new it;default:return new Re}}}var at,st=new(c((function e(t){s(this,e),this.intervals=t})))({intervals:{DEFAULT:2,ESPN_PLUS:0,ESPN_PLUS_MLB:0,ESPN_PLUS_NHL:0}}),ot=function(){function e(){s(this,e),this.configuration=st}return c(e,[{key:"configuration",get:function(){return this._configuration},set:function(e){this._configuration=e}},{key:"shouldPreroll",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=this.configuration.intervals.DEFAULT||0,r=(n||[]).filter((function(e){return e in t.configuration.intervals})).map((function(e){return t.configuration.intervals[e]}));0===r.length&&r.push(i);var a=Math.min.apply(Math,v(r));return a>0&&e.prerollCount>=a-1}}],[{key:"prerollCount",get:function(){var e=localStorage.getItem("PrerollManager.prerollCount");try{return JSON.parse(e)||0}catch(e){return 0}},set:function(e){localStorage.setItem("PrerollManager.prerollCount",JSON.stringify(e))}}]),e}(),ct=function(e){function n(){return s(this,n),t(this,n,arguments)}return d(n,e),c(n,[{key:"configuration",get:function(){var e=Q.shared.getConfiguration("preRoll",st);return P.debug("PrerollManager.getConfiguration ".concat(JSON.stringify(e))),e},set:function(e){g(h(n.prototype),"configuration",e,this,!0)}}],[{key:"prerollCount",get:function(){return ot.prerollCount},set:function(e){ot.prerollCount=e}}]),n}(ot),ut=function(e){function n(){return s(this,n),t(this,n,arguments)}return d(n,e),c(n,[{key:"name",get:function(){return this.title}},{key:"eventId",get:function(){return this.references.eventId}},{key:"trackingId",get:function(){return this.references.trackingId}},{key:"simulcastAiringId",get:function(){return this.references.simulcastAiringId}},{key:"airingId",get:function(){return this.id}},{key:"requiresLinearPlayback",get:function(){return this.supportedMediaCommands===ae.linearPlayback}},{key:"convivaContentMetadata",get:function(){return this.tracking&&this.tracking[pe.conviva]}},{key:"trackingInfo",get:function(){return this.tracking&&this.tracking[pe.heartbeats]}},{key:"nielsenMetadata",get:function(){return this.tracking&&this.tracking[pe.nielsen]}}],[{key:"fromObject",value:function(e){var t=new n(e.id,e.title,e.duration,e.language,e.source);if(l(t,Ce.fromObject(e)),t.source){var i=function(e){switch(e){case Ie.bam:return"BAM";case Ie.none:return"NONE";case Ie.shield:return"SHIELD";case Ie.startSession:return"START_SESSION";default:return null}}(t.source.type);t.source.authorizationType=i}return t}}]),n}(Ce),lt=function(e){function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be.graphQL;return s(this,n),(e=t(this,n)).prerollManager=new ct,e.apiSource=i,e.configurationKey=i===be.graphQL?"graphqlapi":null,e.apiSource_=i,e.watchSDKServiceUrl_=e.getServiceUrlInParam_(),e.configuration=new Fe(e.apiSource_,e.watchSDKServiceUrl_),e}return d(n,e),c(n,[{key:"configuration",get:function(){if(this.watchSDKServiceUrl_)return new Fe(this.apiSource_,this.watchSDKServiceUrl_);var e=Q.shared.getConfiguration(this.configurationKey,n.defaultConfiguration);return P.debug("MediaItemAPI.getConfiguration ".concat(JSON.stringify(e))),e},set:function(e){g(h(n.prototype),"configuration",e,this,!0)}},{key:"getServiceUrlInParam_",value:function(){var e=new URL(window.location.href);return e&&e.searchParams.get("_watchSDKServiceUrl")}},{key:"getMediaItems",value:function(e,t){var i=t||{},r=i.entitlements||[];return!i.shouldBypassPrerollManager&&this.prerollManager.shouldPreroll(r)&&(i.sourceVariant=ue.stitchedPreroll),m(h(n.prototype),"getMediaItems",this).call(this,e,i).then((function(e){var t=e||[],n=t.filter((function(e){return e.source.variant===ue.stitchedPreroll})).length;return n>0?ct.prerollCount=0:ct.prerollCount+=t.length-n,t.map((function(e){return ut.fromObject(e)}))}))}}]),n}(rt),dt={device:{advertisingId:"0000-0000-0000-0000-0000",devType:"web"}};!function(e){e.localStorage="LOCAL_STORAGE",e.sessionStorage="SESSION_STORAGE"}(at||(at={}));var ht,pt,ft,mt=at;class yt{constructor(e,t,n,i){this.id=e,this.name=t,this.logoUrl=n,this.websiteUrl=i}toString(){return`<AuthenticatedProvider id:${this.id}, name:${this.name}, logoUrl:${this.logoUrl}, websiteUrl:${this.websiteUrl}>`}static fromObject(e){return new yt(e.id,e.name,e.logoUrl,e.websiteUrl)}}!function(e){e.token="token",e.tokenType="tokenType",e.resource="resource",e.requestor="requestor",e.fullToken="fullToken",e.zipcode="zipcode",e.mvpd="mvpd",e.errorMessage="errorMessage"}(ht||(ht={}));class gt{constructor(e,t,n,i={}){this.authenticationType=e,this.authenticatedProvider=t,this.authenticatedIdentity=n,this.customData=i}}gt.CustomDataKey=ht;class vt{constructor(e,t){this.success=e,this.payload=t}}(pt=e.AdProvider||(e.AdProvider={})).standard="default",pt.googleAdManager="gam",(ft=e.AdEnvironment||(e.AdEnvironment={})).standard="default",ft.prod="prod",ft.development="dev";const bt=Object.freeze({}),_t=Object.freeze(""),wt="undefined"!=typeof window&&window,Pt=function(e){wt&&wt.console&&wt.console.error(e)};let It,St,Tt;const At=function(){return C(this,void 0,void 0,(function*(){let e=It||wt.goog&&wt.goog.pal;const t=wt&&wt.bc;if(!e){try{yield function(e,t=4e3){const n="undefined"!=typeof window&&window,i=n&&n.document,r=i&&i.getElementsByTagName&&i.getElementsByTagName("head")[0],a=i&&i.body,s=r||a;return s&&e?new S((function(n,i){const r=document.createElement("script");let a=[],o=null;const c=()=>{a.forEach(e=>e()),a=null,clearTimeout(o),o=null},u=function(e){c(),n(e)},l=function(e){c(),i(e)};r.type="text/javascript",r.src=e,r.addEventListener("load",u),a.push(()=>r.removeEventListener("load",u)),r.addEventListener("error",l),a.push(()=>r.removeEventListener("error",l)),o=setTimeout(()=>l(new Error(`Timeout (${t}) while fetching ${e}`)),4e3),s.appendChild(r)})):S.reject()}("https://imasdk.googleapis.com/pal/sdkloader/pal.js")}catch(e){Pt(e)}e=wt.goog&&wt.goog.pal,e&&(It=e),!t&&wt.bc&&(wt.bc=null)}return e||bt}))};const kt=e=>null===e?null:e?"1":"0",Et=(e,t)=>null!=e?e:t;class Ct{constructor(t=null,n=null,i=null,r=null,a="espn",s=null,o=null,c=null,u=null,l=null,d=null,h=null,p=null,f=null,m=null,y=null,g=!1,v=null,b=null,_=!1,w=!1,P=null,I=null,S=null,T=!1,A=null,k=null,E=null,C=null,M=null,O=!1,D=null,N=null,L=null,U=null,j=null,F=null,R=null,x=null,H=null,B=null,z=null,V=null,K=null,G=null,q=null,$=null,W=null,J=null,Y=null,Q=null,X=null,Z=null,ee=null,te=null,ne=!1,ie=null,re=null,ae=null,se=null,oe={},ce=null,ue=null,le=null,de=null,he=e.AdEnvironment.standard,pe=e.AdProvider.standard,fe=null,me=null,ye=null,ge=null,ve=null,be=null,_e=null,we=null,Pe=null,Ie=null){this.aff=t,this.alt=n,this.accessLevel=i,this.adRule=r,this.an=a,this.beacType=s,this.collection=o,this.cbp=c,this.descriptionUrl=u,this.edition=l,this.fcap=d,this.hashedIp=h,this.hl=p,this.isAuth=f,this.idType=m,this.impl=y,this.isLat=g,this.iu=v,this.msid=b,this.npa=_,this.ltd=w,this.nlsnPlat=P,this.output=I,this.palNonce=S,this.storageConsent=T,this.playlist=A,this.ppid=k,this.rdid=E,this.tags=C,this.transId=M,this.tfcd=O,this.url=D,this.varResolution=N,this.vpa=L,this.vpi=U,this.vadFormat=j,this.vpmute=F,this.authenticationProvider=R,this.bundleId=x,this.deviceOS=H,this.deviceType=B,this.isAutoplay=z,this.isMute=V,this.language=K,this.nielsenAppId=G,this.nielsenDeviceGroup=q,this.noAds=$,this.objectId=W,this.pageType=J,this.platform=Y,this.stitchingProvider=Q,this.swid=X,this.testAdTargeting=Z,this.tag=ee,this.unid=te,this.vastIconsSupported=ne,this.videoDeliveryMethod=ie,this.videoPlayerSize=re,this.videoPlayerType=ae,this.videoPlayerVersion=se,this.userInfo=oe,this.isDoNotTrackEnabled=ce,this.pp=ue,this.cmsid=le,this.vid=de,this.adEnvironment=he,this.adProvider=pe,this.usPrivacy=fe,this.additionalConsent=me,this.rdp=ye,this.tvid=ge,this.dmm=ve,this.adTimedmeta=be,this.chan=_e,this.userAgent=we,this.entl=Pe,this.testGroup=Ie}merge(t){return t?(this.adRule=t.adRule||this.adRule,this.an=t.an||this.an,this.descriptionUrl=t.descriptionUrl||this.descriptionUrl,this.fcap=t.fcap||this.fcap,this.hashedIp=t.hashedIp||this.hashedIp,this.hl=t.hl||this.hl,this.idType=t.idType||this.idType,this.isLat=Et(t.isLat,this.isLat),this.iu=t.iu||this.iu,this.msid=t.msid||this.msid,this.npa=Et(t.npa,this.npa),this.ltd=Et(t.ltd,this.ltd),this.output=t.output||this.output,this.ppid=t.ppid||this.ppid,this.rdid=t.rdid||this.rdid,this.rdp=t.rdp||this.rdp,this.tfcd=t.tfcd||this.tfcd,this.url=t.url||this.url,this.vpa=t.vpa||this.vpa,this.vpi=t.vpi||this.vpi,this.vadFormat=t.vadFormat||this.vadFormat,this.vpmute=Et(t.vpmute,this.vpmute),this.authenticationProvider=t.authenticationProvider||this.authenticationProvider,this.bundleId=t.bundleId||this.bundleId,this.deviceOS=t.deviceOS||this.deviceOS,this.deviceType=t.deviceType||this.deviceType,this.isAutoplay=Et(t.isAutoplay,this.isAutoplay),this.isMute=Et(t.isMute,this.isMute),this.language=t.language||this.language,this.palNonce=t.palNonce||this.palNonce,this.storageConsent=t.storageConsent||this.storageConsent,this.nielsenAppId=t.nielsenAppId||this.nielsenAppId,this.nielsenDeviceGroup=t.nielsenDeviceGroup||this.nielsenDeviceGroup,this.noAds=Et(t.noAds,this.noAds),this.objectId=t.objectId||this.objectId,this.platform=t.platform||this.platform,this.stitchingProvider=t.stitchingProvider||this.stitchingProvider,this.swid=t.swid||this.swid,this.tags=t.tags||this.tags,this.testAdTargeting=t.testAdTargeting||this.testAdTargeting,this.unid=t.unid||this.unid,this.alt=t.alt||this.alt,this.beacType=t.beacType||this.beacType,this.transId=t.transId||this.transId,this.accessLevel=t.accessLevel||this.accessLevel,this.varResolution=t.varResolution||this.varResolution,this.nlsnPlat=t.nlsnPlat||this.nlsnPlat,this.tag=t.tag||this.tag,this.aff=t.aff||this.aff,this.playlist=t.playlist||this.playlist,this.cbp=t.cbp||this.cbp,this.collection=t.collection||this.collection,this.impl=t.impl||this.impl,this.isAuth=t.isAuth||this.isAuth,this.pageType=t.pageType||this.pageType,this.vastIconsSupported=Et(t.vastIconsSupported,this.vastIconsSupported),this.videoDeliveryMethod=t.videoDeliveryMethod||this.videoDeliveryMethod,this.videoPlayerSize=t.videoPlayerSize||this.videoPlayerSize,this.videoPlayerType=t.videoPlayerType||this.videoPlayerType,this.videoPlayerVersion=t.videoPlayerVersion||this.videoPlayerVersion,this.isDoNotTrackEnabled=Et(t.isDoNotTrackEnabled,this.isDoNotTrackEnabled),this.pp=t.pp||this.pp,this.cmsid=t.cmsid||this.cmsid,this.usPrivacy=t.usPrivacy||this.usPrivacy,this.additionalConsent=t.additionalConsent||this.additionalConsent,this.vid=t.vid||this.vid,this.tvid=t.tvid||this.tvid,this.dmm=t.dmm||this.dmm,this.adTimedmeta=t.adTimedmeta||this.adTimedmeta,this.chan=t.chan||this.chan,this.userAgent=t.userAgent||this.userAgent,this.edition=t.edition||this.edition,this.entl=t.entl||this.entl,this.userInfo?Object.assign(this.userInfo,t.userInfo):this.userInfo=t.userInfo,this.adEnvironment=t.adEnvironment!==e.AdEnvironment.standard?t.adEnvironment:this.adEnvironment,this.adProvider=t.adProvider!==e.AdProvider.standard?t.adProvider:this.adProvider,this):this}dictionaryForStartSession(){const t={};return t["ad.tfcd"]=kt(this.tfcd),t["ad.is_lat"]=kt(this.isLat),t["ad.idtype"]=this.idType,t["ad.rdid"]=this.rdid,t["ad.ppid"]=this.ppid||this.swid,t["ad.description_url"]=this.descriptionUrl,t["ad.hl"]=this.hl,t["ad.paln"]=this.palNonce,t["ad.npa"]=kt(this.npa),t["ad.ltd"]=kt(this.ltd),t["ad.msid"]=this.msid,t["ad.an"]=this.an,t["ad.url"]=this.url,t["ad.us_privacy"]=this.usPrivacy,t["ad.cust_params.d_us_privacy"]=this.usPrivacy,t["ad.cust_params.chan"]=this.chan,t["ad.rdp"]=null!==this.rdp?this.rdp:"1YYY"===this.usPrivacy?"1":null,t["ad.timedmeta"]=this.adTimedmeta,t["dmm.schema.ads"]=this.dmm,t.authp=this.authenticationProvider,t.bundleId=this.bundleId,t.devOS=this.deviceOS,t.devType=this.deviceType,t.fcap=this.fcap,t.isAutoplay=kt(this.isAutoplay),t.isMute=kt(this.isMute),t.nlsnAppID=this.nielsenAppId,t.tvid=this.tvid,t.plt=this.platform,t.swid=this.swid,t.unid=this.unid,t.vps=this.videoPlayerSize,t.entl=this.entl,this.userAgent=this.userAgent,this.adEnvironment!==e.AdEnvironment.standard&&(t.adEnv=this.adEnvironment),this.adProvider!==e.AdProvider.standard&&(t.adProvider=this.adProvider),Object.assign(t,this.userInfo),Object.keys(t).forEach(e=>null===t[e]&&delete t[e]),t}dictionaryForBrightcove(){const e={};e.bundleId=this.bundleId,e.devOS=this.deviceOS,e.devType=this.deviceType,e.isAutoplay=kt(this.isAutoplay),e.isMute=kt(this.isMute),e.plt=this.platform,e.swid=this.swid,e.vps=this.videoPlayerSize,e.d_id=this.rdid,e.vdm=this.videoDeliveryMethod||"vod",e.stp=this.stitchingProvider||"brightcove",e.entl=this.entl,e.authp=this.authenticationProvider;const t=Object.keys(e).filter(t=>null!==e[t]).map(t=>`${t}=${e[t]}`).join("&"),n={};return n.UMADPARAMiu=this.iu,n.UMADPARAMis_lat=kt(this.isLat),n.UMADPARAMidtype=this.idType,n.UMADPARAMrdid=this.rdid,n.UMADPARAMppid=this.ppid||this.swid,n.UMADPARAMdescription_url=this.descriptionUrl,n.UMADPARAMhl=this.hl,n.UMADPARAMnpa=kt(this.npa),n.UMADPARAMltd=kt(this.ltd),n.UMADPARAMmsid=this.msid,n.UMADPARAMan=this.an,n.UMADPARAMurl=this.url,n.UMADPARAMvpa=kt(this.vpa),n.UMADPARAMvpmute=kt(this.vpmute),n.UMPTPARAMcust_params=t,Object.assign(n,this.userInfo),Object.keys(n).forEach(e=>null===n[e]&&delete n[e]),n}dictionaryForAdEngine(){const t={};switch(t.sect=this.iu,t.npa=kt(this.npa),t.ltd=kt(this.ltd),t.lat=kt(this.isLat),t.idtype=this.idType,t.devId=this.rdid,t.ppid=this.ppid||this.swid,t.app=this.an,t.tfcd=kt(this.tfcd),t.devOS=this.deviceOS,t.devType=this.deviceType,t.isAutoplay=kt(this.isAutoplay),t.isMute=kt(this.isMute),t.plt=this.platform,t.swid=this.swid,t.unid=this.unid,t.vps=this.videoPlayerSize,t.bundle=this.msid,t.hl=this.hl,t.UID=this.swid,t.vdm=this.videoDeliveryMethod,t.url=this.url,t.entl=this.entl,t.authp=this.authenticationProvider,this.adEnvironment){case e.AdEnvironment.development:t.env="qa";break;case e.AdEnvironment.prod:t.env="prod";break;case e.AdEnvironment.standard:}switch(this.adProvider){case e.AdProvider.googleAdManager:t.ads="google";break;case e.AdProvider.standard:}return Object.assign(t,this.userInfo),Object.keys(t).forEach(e=>null===t[e]&&delete t[e]),t}dictionaryForImaSdk(){const t={};t.authp=this.authenticationProvider,t.d_us_privacy=this.usPrivacy,t.devOS=this.deviceOS,t.devType=this.deviceType,t.ed=this.edition,t.hip=this.hashedIp,t.isAutoplay=kt(this.isAutoplay),t.isDnt=kt(this.isDoNotTrackEnabled),t.isMute=kt(this.isMute),t.lang=this.language,t.nlsnAppID=this.nielsenAppId,t.nlsnDevGrp=this.nielsenDeviceGroup,t.noad=this.noAds,t.objid=this.objectId,t.plt=this.platform,t.pgtyp=this.pageType,t.swid=this.swid,t.tag=this.tags,t.tstAdTar=this.testAdTargeting,t.unid=this.unid,t.vdm=this.videoDeliveryMethod||"vod",t.vps=this.videoPlayerSize,t.chan=this.chan,t.entl=this.entl,t.testGroup=this.testGroup;const n=Object.keys(t).filter(e=>null!==t[e]).map(e=>`${e}=${t[e]}`).join("&"),i={};return i.ad_rule=this.adRule,i.cmsid=this.cmsid,i.description_url=this.descriptionUrl,i.hl=this.hl,i.iu=this.iu,i.npa=kt(this.npa),i.output=this.output,i.ltd=kt(this.ltd),i.pp=this.pp,i.ppid=this.ppid,i.rdp=this.rdp,i.tfcd=kt(this.tfcd),i.us_privacy=this.usPrivacy,i.addtl_consent=this.additionalConsent,i.vid=this.vid,i.vpa=kt(this.vpa),i.cust_params=n,i.gdfp_req="1",i.env="vp",i.sz="640x480",this.adEnvironment!==e.AdEnvironment.standard&&(i.adEnv=this.adEnvironment),Object.keys(i).forEach(e=>null===i[e]&&delete i[e]),i}dictionaryForEntertainment(){const e={};e.ed=this.edition,e.devOS=this.deviceOS,e.devType=this.deviceType,e.hip=this.hashedIp,e.isAutoplay=kt(this.isAutoplay),e.isDnt=kt(this.isDoNotTrackEnabled),e.isMute=kt(this.isMute),e.lang=this.language,e.nlsnAppID=this.nielsenAppId,e.nlsnDevGrp=this.nielsenDeviceGroup,e.nlsnPlat=this.nlsnPlat,e.noad=this.noAds,e.objid=this.objectId,e.pgtyp=this.pageType,e.plt=this.platform,e.swid=this.swid||this.ppid,e.tag=this.tags,e.tstAdTar=this.testAdTargeting,e.unid=this.unid,e.vdm=this.videoDeliveryMethod||"vod",e.vps=this.videoPlayerSize,e.alt=this.alt,e.beacType=this.beacType,e.transId=this.transId,e.accesslevel=this.accessLevel,e.isAuth=this.isAuth,e.fcap=this.fcap,e.var=this.varResolution,e.tag=this.tag,e.aff=this.aff,e.authp=this.authenticationProvider,e.playlist=this.playlist,e.cbp=this.cbp,e.collection=this.collection,e.impl=this.impl,e.chan=this.chan,e.entl=this.entl;const t=Object.keys(e).filter(t=>null!==e[t]).map(t=>`${t}=${e[t]}`).join("&"),n={};return n.addtl_consent=this.additionalConsent,n.ad_rule=this.adRule,n.cmsid=this.cmsid,n.description_url=this.descriptionUrl,n.hl=this.hl,n.iu=this.iu,n.npa=kt(this.npa),n.output=this.output,n.ltd=kt(this.ltd),n.pp=this.pp,n.ppid=this.ppid,n.tfcd=kt(this.tfcd),n.vid=this.vid,n.vpa=kt(this.vpa),n.cust_params=t,n.output=this.output,n.vad_format=this.vadFormat,n.vpi=this.vpi,n.url=this.url,n.us_privacy=this.usPrivacy,n.gdfp_req="1",n.env="vp",n.sz="640x480",Object.keys(n).forEach(e=>null===n[e]&&delete n[e]),n}static ppidForSwid(e){return e}}Ct.getGooglePalNonce=function(e,t=3e3,n=!1,i=!0,r=At){return C(this,void 0,void 0,(function*(){let a=i&&Tt||_t;if(!a){let s,o,c;try{const e=yield r();e&&(s=e.NonceLoader,o=e.NonceRequest,c=e.ConsentSettings)}catch(e){Pt(e)}if((!i||!Tt)&&s&&o){let i;try{const{storageConsent:t=!1}=e,r=new c;r.allowStorage=t,St=!St||n?new s(r):St;const a=Object.assign(new o,function(e){const[t,n]=String(e.videoPlayerSize||"640x480").split("x");return{adWillAutoPlay:e.isAutoplay,adWillPlayMuted:e.isMute,continuousPlayback:"vod"===e.videoDeliveryMethod,descriptionUrl:e.descriptionUrl||_t,iconsSupported:e.vastIconsSupported,playerType:e.videoPlayerType||_t,playerVersion:e.videoPlayerVersion||_t,ppid:e.ppid||e.swid||_t,videoHeight:parseInt(n,10),videoWidth:parseInt(t,10)}}(e));i=yield St.loadNonceManager(a)}catch(e){Pt(e)}i&&(a=yield i.getNonce(),(!a||Number(t)>0&&String(a).length>t)&&(a=_t),a&&(Tt=a))}}return a}))};class Mt{constructor(e,t){this.id=e,this.tier=t}toString(){return`<AuthenticatedPackage id:${this.id}, tier:${this.tier}>`}static fromObject(e){return new Mt(e.id,e.tier)}}var Ot,Dt;!function(e){e.immutable="immutable",e.mutable="mutable"}(Ot||(Ot={})),function(e){e.abc="abc",e.abcNews="abcnews",e.abcNewsLive="abcnewslive",e.abcOtv="abcotv",e.cricinfo="cricinfo",e.disney="dch",e.disneyJr="djr",e.disneyXD="dxd",e.disneyNow="dnow",e.espn="espn",e.espnFantasy="espnFantasy",e.fiveThirtyEight="fivethirtyeight",e.foxLatam="foxlatam",e.freeform="ff",e.fxNow="fxnow",e.fx="fx",e.fxm="fxm",e.fxx="fxx",e.oscar="oscar",e.marvel="marvel",e.natGeoTV="ngtv",e.natGeo="ngc",e.natGeoWild="ngw",e.natgeoBrasil="natgeobrasil",e.theUndefeated="theundefeated",e.fast="fast",e.unknown="000"}(Dt||(Dt={}));var Nt,Lt=w((function(e,t){var n;e.exports=(n=n||function(e,t){var n=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),i={},r=i.lib={},a=r.Base={extend:function(e){var t=n(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=r.WordArray=a.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,n=e.words,i=this.sigBytes,r=e.sigBytes;if(this.clamp(),i%4)for(var a=0;a<r;a++){var s=n[a>>>2]>>>24-a%4*8&255;t[i+a>>>2]|=s<<24-(i+a)%4*8}else for(a=0;a<r;a+=4)t[i+a>>>2]=n[a>>>2];return this.sigBytes+=r,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=a.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n,i=[],r=function(t){t=t;var n=987654321,i=4294967295;return function(){var r=((n=36969*(65535&n)+(n>>16)&i)<<16)+(t=18e3*(65535&t)+(t>>16)&i)&i;return r/=4294967296,(r+=.5)*(e.random()>.5?1:-1)}},a=0;a<t;a+=4){var o=r(4294967296*(n||e.random()));n=987654071*o(),i.push(4294967296*o()|0)}return new s.init(i,t)}}),o=i.enc={},c=o.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],r=0;r<n;r++){var a=t[r>>>2]>>>24-r%4*8&255;i.push((a>>>4).toString(16)),i.push((15&a).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i+=2)n[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new s.init(n,t/2)}},u=o.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],r=0;r<n;r++){var a=t[r>>>2]>>>24-r%4*8&255;i.push(String.fromCharCode(a))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i++)n[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new s.init(n,t)}},l=o.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},d=r.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,i=n.words,r=n.sigBytes,a=this.blockSize,o=r/(4*a),c=(o=t?e.ceil(o):e.max((0|o)-this._minBufferSize,0))*a,u=e.min(4*c,r);if(c){for(var l=0;l<c;l+=a)this._doProcessBlock(i,l);var d=i.splice(0,c);n.sigBytes-=u}return new s.init(d,u)},clone:function(){var e=a.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),h=(r.Hasher=d.extend({cfg:a.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new h.HMAC.init(e,n).finalize(t)}}}),i.algo={});return i}(Math),n)})),Ut=(w((function(e,t){var n,i,r,a,s,o,c,u;e.exports=(i=(n=u=Lt).lib,r=i.WordArray,a=i.Hasher,s=n.algo,o=[],c=s.SHA1=a.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,i=n[0],r=n[1],a=n[2],s=n[3],c=n[4],u=0;u<80;u++){if(u<16)o[u]=0|e[t+u];else{var l=o[u-3]^o[u-8]^o[u-14]^o[u-16];o[u]=l<<1|l>>>31}var d=(i<<5|i>>>27)+c+o[u];d+=u<20?1518500249+(r&a|~r&s):u<40?1859775393+(r^a^s):u<60?(r&a|r&s|a&s)-1894007588:(r^a^s)-899497514,c=s,s=a,a=r<<30|r>>>2,r=i,i=d}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+a|0,n[3]=n[3]+s|0,n[4]=n[4]+c|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;return t[i>>>5]|=128<<24-i%32,t[14+(i+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(i+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}}),n.SHA1=a._createHelper(c),n.HmacSHA1=a._createHmacHelper(c),u.SHA1)})),w((function(e,t){var n,i,r;e.exports=(i=(n=Lt).lib.Base,r=n.enc.Utf8,void(n.algo.HMAC=i.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=r.parse(t));var n=e.blockSize,i=4*n;t.sigBytes>i&&(t=e.finalize(t)),t.clamp();for(var a=this._oKey=t.clone(),s=this._iKey=t.clone(),o=a.words,c=s.words,u=0;u<n;u++)o[u]^=1549556828,c[u]^=909522486;a.sigBytes=s.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})))})),w((function(e,t){e.exports=Lt.HmacSHA1})),w((function(e,t){var n,i,r;e.exports=(i=(n=r=Lt).lib.WordArray,n.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,i=this._map;e.clamp();for(var r=[],a=0;a<n;a+=3)for(var s=(t[a>>>2]>>>24-a%4*8&255)<<16|(t[a+1>>>2]>>>24-(a+1)%4*8&255)<<8|t[a+2>>>2]>>>24-(a+2)%4*8&255,o=0;o<4&&a+.75*o<n;o++)r.push(i.charAt(s>>>6*(3-o)&63));var c=i.charAt(64);if(c)for(;r.length%4;)r.push(c);return r.join("")},parse:function(e){var t=e.length,n=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var a=0;a<n.length;a++)r[n.charCodeAt(a)]=a}var s=n.charAt(64);if(s){var o=e.indexOf(s);-1!==o&&(t=o)}return function(e,t,n){for(var r=[],a=0,s=0;s<t;s++)if(s%4){var o=n[e.charCodeAt(s-1)]<<s%4*2,c=n[e.charCodeAt(s)]>>>6-s%4*2;r[a>>>2]|=(o|c)<<24-a%4*8,a++}return i.create(r,a)}(e,t,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},r.enc.Base64)})));!function(e){e.mvpd="mvpd",e.isp="isp",e.tve="tve"}(Nt||(Nt={}));var jt=Nt;const Ft={};Ft[jt.mvpd]="adobeId",Ft[jt.isp]="ispId",Ft[jt.tve]="id";var Rt=w((function(e,t){e.exports=Lt.enc.Utf8}));const xt=function(e,t){t.setItem("watchsdk.web_adobe_pass_authenticator.state",JSON.stringify(e))},Ht={production:"eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyZGJmZWM4My03OWE1LTQyNzEtYTVmZC04NTZjYTMxMjRjNjMiLCJuYmYiOjE1NDAyMTI3NjEsImlzcyI6ImF1dGguYWRvYmUuY29tIiwiaWF0IjoxNTQwMjEyNzYxfQ.yaK3r4AI2uLVvsyN1GLzqzgzRlxMPtasSaiYYBV0wIstqih5tvjTmeoLmi8Xy9Kp_U7Md-bOffwiyK3srHkpUkhhwXLH2x6RPjmS1tPmhaG7-3LBcHTf2ySPvXhVf7cN4ngldawK4tdtLtsw6rF_JoZE2yaC6XbS2F51nXSFEDDnOQWIHEQRG3aYAj-38P2CLGf7g-Yfhbp5cKXeksHHQ90u3eOO4WH0EAjc9oO47h33U8KMEXxJbvjV5J8Va2G2fQSgLDZ013NBI3kQnE313qgqQh2feQILkyCENpB7g-TVBreAjOaH1fU471htSoGGYepcAXv-UDtpgitDiLy7CQ",staging:"eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJhMmRjNjgyMC1kZGNkLTQ4NGEtOTdlNS0xZjJiZmQzOGI4YzgiLCJuYmYiOjE1NDAyMjIwNTksImlzcyI6ImF1dGguYWRvYmUuY29tIiwiaWF0IjoxNTQwMjIyMDU5fQ.YgX4ecGCgLCaZS7uwRQYZ8UR5EwT7GIl-glFbwU122bO1JYZSmbIX8YJSfmYth_scyeg-15BYWNftV9lOcmCe8VwIsQMJMIZKaF8qSIj5OfuTOBpNZNBpDAp5dC3zG7Zp1xLe3z-T0Y18-0BGj2yhGcJxBz4gtLXQ30Bw0LEIJ89nXCQaXFTq9N6zhDzMfkFJNnSNEvEmvcQqB4bFPIqn2is8427oQDU4D0XYvvTtx9eb5hmzKc9MbBG-8KRBA62BqdHomA5UA4kBYJKpe-8B2hO07Adi2bZoo5wP_VLNAnAxANWNXaGQYHMDjHDrHbbvuKHBudHgKxAuKpIdC7UrA"};const Bt=new class{constructor(e,t,n,i){this.preauthorizeNetworksEnabled=e,this.preauthorizeNetworks=t,this.preauthorizeNetworksMapping=n,this.adobeAuthErrorRegex=i}}(!1,[],{},"^$|^null$|^noAuthz$|^[\\d]*.*UPDA$|^BAD_RESPONSE$"),zt="mvpd",Vt="upstreamUserID",Kt="packageId",Gt="tier",qt="hba_status",$t={};class Wt{constructor(e,t,n,i,r){this.partner=e,this.platform=t,this.requestorId=n,this.options=i,this.configuration=Bt;const{environment:a=Wt.Environment.PRODUCTION,errorEventHandlerName:s="AEErrorHandler"}=i||{};this.accessEnabler=null,this.environment=a,this.errorEventHandlerName=s,this.resolveEntitlementLoaded_=null,this.resolveCheckAuthenticationCompletions_=[],this.resolveAuthenticate_=null,this.resolveDeauthenticate_=null,this.resolveAuthorization_=null,this.resolvePreauthorizes_=[],this.resolveAuthenticateMetadataDependencies_={},this.softwareStatements=r||Ht,this.delegate=null,this.providerDataSource=null,this.storage=localStorage,this.state_={};try{const e=this.storage.getItem("watchsdk.web_adobe_pass_authenticator.state"),t=JSON.parse(e);t.authenticatedProvider&&(t.authenticatedProvider=yt.fromObject(t.authenticatedProvider)),t.authenticatedPackage&&(t.authenticatedPackage=Mt.fromObject(t.authenticatedPackage)),this.state_=t}catch(e){}this.initialization_=this.initialize(),window.tokenRequestFailed=this.tokenRequestFailed.bind(this)}get configuration(){return this.configuration_}set configuration(e){this.configuration_=e}get isAuthenticated(){return"true"===this.state_.isAuthenticated.toString()}set isAuthenticated(e){this.state_.isAuthenticated=e,xt(this.state_,this.storage)}get authenticatedIdentity(){return this.state_.authenticatedIdentity}set authenticatedIdentity(e){if(!e)return delete this.state_.authenticatedIdentity,void xt(this.state_.toString,this.storage);this.state_.authenticatedIdentity=e,xt(this.state_,this.storage)}get authenticatedPackage(){return this.state_.authenticatedPackage}set authenticatedPackage(e){if(!e)return delete this.state_.authenticatedPackage,void xt(this.state_,this.storage);this.state_.authenticatedPackage=e,xt(this.state_,this.storage)}get authenticatedProvider(){return this.state_.authenticatedProvider}set authenticatedProvider(e){if(!e)return delete this.state_.authenticatedProvider,void xt(this.state_,this.storage);this.state_.authenticatedProvider=e,xt(this.state_,this.storage)}get wasPreviouslyAuthenticated(){var e,t;return"true"===(null===(t=null===(e=this.state_)||void 0===e?void 0:e.wasPreviouslyAuthenticated)||void 0===t?void 0:t.toString())||!1}get preauthorizedResources(){return this.isAuthenticated?this.state_.preauthorizedResources:[]}checkAuthentication(){return P.debug("AdobePassAuthenticator.checkAuthentication"),this.accessEnabler?new S(e=>{this.resolveCheckAuthenticationCompletions_.push(t=>{e(t)}),this.accessEnabler.checkAuthentication()}):S.reject(null)}authenticate(e){if(P.debug("AdobePassClient.authenticate"),!this.accessEnabler)return S.reject(null);const t=e&&e.redirectUrl||window.location.href;return new S(e=>{this.resolveAuthenticate_=t=>{e(t)},this.accessEnabler.getAuthentication(t)})}deauthenticate(){return P.debug("AdobePassAuthenticator.deauthenticate"),this.accessEnabler?new S(e=>{this.resolveDeauthenticate_=t=>{e(t)},this.accessEnabler.logout()}):S.reject(null)}checkAuthorization(e){var t;if(P.debug("AdobePassClient.checkAuthorization "+e),-1===(null===(t=e.authenticationTypes)||void 0===t?void 0:t.indexOf(we.mvpd))||!this.isAuthenticated){const e=new vt(!1,null);return S.resolve(e)}let{mrss:n}=e;const i=this.authenticatedPackage&&this.authenticatedPackage.id;i&&(n=function(e,t,n){if(!e||!t||!n)return e;const i="</item></channel></rss>";let r=-1;return r=e.indexOf(i),-1!==r&&-1===e.indexOf("shield:affiliateId")&&(e=e.slice(0,r)+`<shield:affiliateId>${t}</shield:affiliateId>`+e.slice(r)),r=e.indexOf(i),-1!==r&&-1===e.indexOf("shield:airingId")&&-1!==e.indexOf("shield:affiliateId")&&(e=`${e.slice(0,r)}<shield:airingId>${n}</shield:airingId>${e.slice(r)}`),e}(n,i,e.id));const r=n;return new S((e,t)=>{this.resolveAuthorization_=n=>{const{token:i}=n,{resourceId:r,errorId:a,message:s}=n;if(!i&&a)return void t(new Error(s||a));const o={[gt.CustomDataKey.fullToken]:i,[gt.CustomDataKey.token]:Ut.stringify(Rt.parse(i)),[gt.CustomDataKey.tokenType]:"ADOBEPASS",[gt.CustomDataKey.resource]:r},c=new gt(we.mvpd,this.authenticatedProvider,this.authenticatedIdentity,o),u=new vt(!0,c);e(u)},this.accessEnabler.getAuthorization(r)})}setProvider(e){this.accessEnabler.setSelectedProvider(e)}get isHomeBasedAuth(){return this.hbaStatus||!1}initialize(){const{environment:e}=this;return function(e,t){const n=window&&window.document;if(!n)return S.reject();if(window.Adobe&&window.Adobe.AccessEnabler){const e=new window.Adobe.AccessEnabler(t);return S.resolve(e)}return new S((i,r)=>{const a=n.createElement("script");a.id="ae_js",a.type="text/javascript",a.async=!0,a.src=e,a.addEventListener("load",()=>{const e=new window.Adobe.AccessEnabler(t);i(e)}),a.addEventListener("error",()=>{r()}),n.getElementsByTagName("head")[0].appendChild(a)})}($t[e],this.softwareStatements[e]).then(e=>(this.accessEnabler=e,S.resolve())).then(()=>new S(e=>{this.resolveEntitlementLoaded_=e,this.bindAccessEnablerCallbacks()}))}bindAccessEnablerCallbacks(){window.entitlementLoaded=this.entitlementLoaded.bind(this),window.setAuthenticationStatus=this.setAuthenticationStatus.bind(this),window.setMetadataStatus=this.setMetadataStatus.bind(this),window.displayProviderDialog=this.displayProviderDialog.bind(this),window.setConfig=this.setConfig.bind(this),window.sendTrackingData=this.sendTrackingData.bind(this),window.preauthorizedResources=this.handlePreauthorizedResources.bind(this),window.selectedProvider=this.selectedProvider.bind(this),window.setToken=this.setToken.bind(this),window[this.errorEventHandlerName]=this.handleAccessEnablerError.bind(this)}entitlementLoaded(){P.debug("AdobePassAuthenticator.entitlementLoaded"),this.accessEnabler&&(this.accessEnabler.bind("errorEvent",this.errorEventHandlerName),this.accessEnabler.setRequestor(this.requestorId),this.resolveEntitlementLoaded_&&(this.resolveEntitlementLoaded_(!0),this.resolveEntitlementLoaded_=null))}setAuthenticationStatus(e,t){if(P.debug("AdobePassAuthenticator.setAuthenticationStatus",e,t),this.isAuthenticated=!!e,this.isAuthenticated){this.accessEnabler.getMetadata(Vt);const e=[Kt,Gt,qt,zt].map(e=>new S(t=>{this.resolveAuthenticateMetadataDependencies_[e]=e=>{t(e)},this.accessEnabler.getMetadata(e)}).catch(e=>(P.warn(e),null)));e.push(this.getPreauthorizedResources_().then(e=>{this.state_.preauthorizedResources=e})),S.all(e).then(()=>{this.resolveCheckAuthenticationCompletions_.forEach(e=>{e(this.isAuthenticated)}),this.resolveCheckAuthenticationCompletions_=[],this.resolveAuthenticate_&&(this.resolveAuthenticate_(this.isAuthenticated),this.resolveAuthenticate_=null)})}else this.authenticatedIdentity=null,this.authenticatedPackage=null,this.authenticatedProvider=null,this.hbaStatus=null,this.state_.preauthorizedResources=[],this.resolveCheckAuthenticationCompletions_.forEach(e=>{e(this.isAuthenticated)}),this.resolveCheckAuthenticationCompletions_=[],this.resolveDeauthenticate_&&(this.resolveDeauthenticate_(this.isAuthenticated),this.resolveDeauthenticate_=null)}setMetadataStatus(e,t,n){switch(P.debug("AdobePassAuthenticator.setMetadataStatus",e,n),e){case zt:const t=n;this.providerDataSource?this.providerDataSource.getProvider(t).then(i=>{const r=i.images||[],a=r.filter(e=>"COLOR_NEGATIVE"===e.type).map(e=>e.href)[0],s=r.filter(e=>"BW_NEGATIVE"===e.type).map(e=>e.href)[0]||a||r.map(e=>e.href)[0];this.authenticatedProvider=new yt(t,i.name,s,i.websiteUrl),this.authenticatedProvider.isHomeBasedAuth=this.hbaStatus,this.resolveAuthenticateMetadata_(e,n)}).catch(()=>{this.authenticatedProvider=new yt(t,t,null,null),this.resolveAuthenticateMetadata_(e,n)}):(this.authenticatedProvider=new yt(t,t,null,null),this.resolveAuthenticateMetadata_(e,n));break;case Vt:this.authenticatedIdentity=n,this.resolveAuthenticateMetadata_(e,n);break;case qt:this.hbaStatus="true"===n,this.resolveAuthenticateMetadata_(e,n);break;case Kt:case Gt:if(n){const t=this.authenticatedPackage||new Mt(null,null);e===Kt?t.id=n:e===Gt&&(t.tier=n),this.authenticatedPackage=t}this.resolveAuthenticateMetadata_(e,n)}}displayProviderDialog(e){P.debug("AdobePassAuthenticator.displayProviderDialog",e),this.providerDataSource&&this.providerDataSource.getProviders().then(e=>{this.delegate&&this.delegate.selectProvider&&this.delegate.selectProvider(e)})}setConfig(){}sendTrackingData(e,t){if("authenticationDetection"===e){const n={success:t[0],mvpd:t[1],guid:t[2],isTokenCached:t[3],deviceType:t[4],clientType:t[5],os:t[6]};P.debug("AdobePassAuthenticator.sendTrackingData",e,n)}}handlePreauthorizedResources(e){P.debug("AdobePassAuthenticator.preauthorizedResources",e);const t=this.resolvePreauthorizes_.shift();t&&t(e)}selectedProvider(e){const{MVPD:t,AEstate_:n}=e;P.debug(`AdobePassAuthenticator.selectedProvider mvpd: ${t}, aeState: ${n}`)}setToken(e,t){P.debug(`Requested resource: ${e} tokenResult: ${t}`),this.resolveAuthorization_&&(this.resolveAuthorization_({resourceId:e,token:t}),this.resolveAuthorization_=null)}handleAccessEnablerError(e){const{errorId:t,message:n}=e;switch(P.debug(`AdobePassAuthenticator.handleAccessEnablerError errorId: ${t}, message: ${n}`),t){case"Z169":case"Z100":P.error("Failure to authorize: "+n);const e=this.configuration.adobeAuthErrorRegex,i=new RegExp(e).test(n)?"This channel is not part of your TV package.":n;this.resolveAuthorization_&&(this.resolveAuthorization_({errorId:t,message:i}),this.resolveAuthorization_=null);break;case"N130":this.checkAuthentication()}}tokenRequestFailed(){P.debug("AdobePassAuthenticator.tokenRequestFailed")}resolveAuthenticateMetadata_(e,t){const n=this.resolveAuthenticateMetadataDependencies_[e];n&&(n(t),delete this.resolveAuthenticateMetadataDependencies_[e])}getPreauthorizedResources_(){P.debug("AdobePassAuthenticator.getPreauthorizedResources_");const{preauthorizeNetworksEnabled:e,preauthorizeNetworks:t,preauthorizeNetworksMapping:n}=this.configuration;if(!1===e){const e=t;return Object.keys(n).forEach(t=>{const i=n[t];-1!==e.indexOf(t)&&-1===e.indexOf(i)&&e.push(i)}),S.resolve(e)}if(0===t.length||!0!==this.isAuthenticated)return S.resolve([]);if(!this.accessEnabler)return S.reject(null);const i=function e(t,n){return t.length?[t.slice(0,n),...e(t.slice(n),n)]:[]}(t,5),r=[],a=i.map(e=>new S(t=>{r.push(e=>{t(e)}),this.accessEnabler.checkPreauthorizedResources(e)}).catch(()=>[]));return this.resolvePreauthorizes_=r,S.all(a).then(e=>e.reduce((e,t)=>e.concat(t),[]))}}Wt.defaultConfiguration=Bt,Wt.Environment={PRODUCTION:"production",STAGING:"staging"},Wt.EventType={PREAUTHORIZED:"preauthorized",NOT_PREAUTHORIZED:"not_preauthorized"},$t[Wt.Environment.PRODUCTION]="https://entitlement.auth.adobe.com/entitlement/v4/AccessEnabler.js",$t[Wt.Environment.STAGING]="https://entitlement.auth-staging.adobe.com/entitlement/v4/AccessEnabler.js";var Jt,Yt=function(e){function n(e,i,r,a,o){var c;return s(this,n),(c=t(this,n)).partner=e,c.platform=i,c.requestorId=r,c.options=a,c.softwareStatements=o,c}return d(n,e),c(n,[{key:"configuration",get:function(){var e=Q.shared.getConfiguration("adobePass",Wt.defaultConfiguration);return P.debug("WebAdobePassAuthenticator.getConfiguration ".concat(JSON.stringify(e))),e},set:function(e){g(h(n.prototype),"configuration",e,this,!0)}}]),n}(Wt);class Qt{constructor(e,t,n){this.contentType=e,this.keySystem=t,this.licenseUrl=n}}class Xt{constructor(e){this.playbackUrl=e,this.textTracks=[]}get convivaContentMetadata(){const e={accessType:null,mvpd:null};this.authenticationType&&(e.accessType=this.authenticationType&&this.authenticationType.toLowerCase()||"free",this.authenticatedProvider&&this.authenticationType===we.mvpd&&(e.mvpd=this.authenticatedProvider.id));const t=this.mediaItem&&this.mediaItem.tracking[pe.conviva]||{},n={streamUrl:this.playbackUrl,custom:Object.assign(t.custom||{},e)};return Object.assign(t,n)}toString(){return`<PlaybackSession playbackUrl:${this.playbackUrl}, authenticationType:${this.authenticationType}, authenticatedProvider:${this.authenticatedProvider}>`}}!function(e){e.none="none",e.fairPlay="fairplay",e.playReady="playready",e.widevine="widevine"}(Jt||(Jt={}));var Zt,en=Jt;!function(e){e.none="HLS",e.hlsFairplay="HLS_FAIRPLAY",e.dashPlayReady="DASH_PLAYREADY",e.dashWidevine="DASH_WIDEVINE"}(Zt||(Zt={}));var tn=Zt;class nn{initPlaybackSession(e,t,n){let i=e.source.url;if(e.source.variant===ue.stitchedPreroll){const e=t.dictionaryForBrightcove();Object.keys(e).forEach(t=>{i=function(e,t,n){const i=-1===n.indexOf("?")?"?":"&";return`${n+i+e}=${encodeURIComponent(t)}`}(t,e[t].toString(),i)})}P.debug(i,e);const r=new Xt(i);return r.mediaItem=e,r.seekToTime=e.seekInSeconds,r.authenticationType=n.authenticationType,r.authenticatedProvider=n.authenticatedProvider,r.authenticatedIdentity=n.authenticatedIdentity,S.resolve(r)}}function rn(e){const t=e+":";return{Authorization:"Basic "+L.stringify(U.parse(t)),Accept:"application/json"}}const an="live",sn="vod",on="accountId",cn="channel",un="contentType",ln="contractType",dn="hba",hn="ship",pn="region";class fn{constructor(e,t,n,i,r){t&&n&&i&&(this.programmer=e,this.applicationId=t,this.identityProvider=encodeURIComponent(n),this.subject=encodeURIComponent(i),this.metadata=r||{},this.serviceUrl="https://streams.adobeprimetime.com/v2",this.requestHeaders=rn(t),this.heartbeatIntervalId=null,this.messages={})}static fetchMetadataKeys(e,t){return C(this,void 0,void 0,(function*(){const n=t+"/metadata",i={method:"GET",headers:rn(e)};try{const t=yield T(n,i);if(t){const n=yield t.json();return fn.setLocalStorageByAppID(n,e),!0}return!1}catch(e){return console.log("fetchMetadataKeys error: "+e),!1}}))}static setLocalStorageByAppID(e,t){const n="AdobeCM.metadata."+t;localStorage.setItem(n,JSON.stringify(e))}get metadataKeys(){return this.getMetadataKeysFromLocalStorage_(this.applicationId)}getMetadataKeysFromLocalStorage_(e){const t="AdobeCM.metadata."+e;let n=[];try{n=JSON.parse(localStorage.getItem(t))||[]}catch(e){console.error("AdobeCM getMetadataKeys error: "+e)}return n}start(){return C(this,void 0,void 0,(function*(){const e=yield this.createSession();return e?(this.scheduleHeartbeat(),e):null}))}startWithSession(e){this.sessionId=e,this.scheduleHeartbeat()}stop(){this.heartbeatIntervalId&&(clearInterval(this.heartbeatIntervalId),this.heartbeatIntervalId=null),this.terminateSession()}createSession(e=[]){return C(this,void 0,void 0,(function*(){P.debug("AdobeConcurrencyMonitorV2.createSession");const t=`${this.serviceUrl}/sessions/${this.identityProvider}/${this.subject}`,n=Object.assign({"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},this.requestHeaders);e.length>0&&(n["X-Terminate"]=e.join(","));const i=this.getMetadata(),r={method:"POST",headers:n,body:Object.keys(i).map(e=>`${e}=${encodeURIComponent(i[e])}`).join("&")};try{const e=yield this.fetchRequest(t,r,!0);if(!e)throw"fetchRequest failed";const{sessionId:n}=e;if(n)return this.sessionId=n,P.debug("AdobeConcurrencyMonitorV2.createSession sessionId:",n),n;const{status:i,json:a}=e;throw{status:i,json:a}}catch(e){return P.error("AdobeConcurrencyMonitorV2.createSession error: ",e),yield this.handleError(e,!1)}}))}heartbeat(){return C(this,void 0,void 0,(function*(){const{sessionId:e}=this;if(!e)return;P.debug("AdobeConcurrencyMonitorV2.heartbeat",e);const t=`${this.serviceUrl}/sessions/${this.identityProvider}/${this.subject}/${e}`,n={method:"POST",headers:this.requestHeaders};try{const e=yield this.fetchRequest(t,n,!1);if(!e)throw"fetchRequest failed";if(e.error){const{status:t,json:n}=e;throw{status:t,json:n}}this.scheduleHeartbeat()}catch(e){return P.error("AdobeConcurrencyMonitorV2.heartbeat error: ",e),this.handleError(e,!0)}}))}scheduleHeartbeat(){P.debug("AdobeConcurrencyMonitorV2.scheduleHeartbeat"),clearTimeout(this.heartbeatIntervalId),this.heartbeatIntervalId=window.setTimeout(()=>{this.heartbeat()},45e3)}fetchRequest(e,t,n){return C(this,void 0,void 0,(function*(){try{const i=yield T(e,t),{status:r}=i;if(!(r>=200&&r<300)){return{status:r,json:yield i.clone().json().catch(()=>!!i.text()||null),error:!0}}let a;return n&&(a=i.headers.get("location").trim()),{sessionId:a,status:r,error:!1}}catch(e){if(console.error("AdobeCM fetchRequest: "+e),e&&409===e.status&&"function"==typeof e.json){return{status:409,json:yield e.json(),error:!0}}return e}}))}terminateSession(){return C(this,void 0,void 0,(function*(){const{sessionId:e}=this;if(e)try{const t=`${this.serviceUrl}/sessions/${this.identityProvider}/${this.subject}/${e}`,n=yield T(t,{method:"DELETE",headers:this.requestHeaders}),{status:i}=n;if(!(i>=200&&i<300))throw new Error(`Error - url: ${t}, status: ${i}`)}catch(e){console.error("AdobeCM TerminateSession "+e)}}))}handleError(e,t){P.debug("AdobeConcurrencyMonitorV2.handleError",e);const{status:n,json:i}=e;switch(n){case 400:return this.handleError400_(i);case 409:return this.handleError409_(i,t);case 410:return this.handleError410_(i,t)}}handleError400_(e){return C(this,void 0,void 0,(function*(){if(!!(e&&e.obligations||[]).find(e=>"logout"===e.action||"refresh"===e.action)){yield fn.fetchMetadataKeys(this.applicationId,this.serviceUrl);const{metadata:e}=this;if(Object.keys(e).length>=this.metadataKeys.length)return this.start()}return null}))}handleError409_(e,t){try{const n=(e&&e.associatedAdvice||[]).find(e=>"rule-violation"===e.type);if(n){const{message:i}=n,r=this.messages[i]||i,a=new Error(r),s=!!(e.obligations||[]).find(e=>"logout"===e.action);if(P.debug("AdobeConcurrencyMonitorV2.handleError",409,a,s),!t)throw a;this.onError(a,s)}}catch(e){throw P.debug("AdobeConcurrencyMonitorV2.handleError409_: "+e),e}return null}handleError410_(e,t){if(!e)return this.start();try{const n=(e&&e.associatedAdvice||[]).find(e=>"remote-termination"===e.type);if(n){const{message:i}=n,r=this.messages[i]||i,a=new Error(r),s=!!e.obligations.find(e=>"logout"===e.action);if(P.debug("AdobeConcurrencyMonitorV2.handleError",410,a,s),!t)throw a;this.onError(a,s)}}catch(e){throw P.debug("AdobeConcurrencyMonitorV2.handleError410_: "+e),e}return null}getMetadata(){const{metadataKeys:e}=this;return e.reduce((e,t)=>(e[t]=this.metadata[t],e),{})}onError(e,t){P.debug("AdobeConcurrencyMonitor.onError"),P.debug("error: "+e),P.debug("shouldLogout: "+t)}}var mn,yn=w((function(e,t){var n;e.exports=(n=N,function(e){var t=n,i=t.lib,r=i.WordArray,a=i.Hasher,s=t.algo,o=[],c=[];!function(){function t(t){for(var n=e.sqrt(t),i=2;i<=n;i++)if(!(t%i))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var i=2,r=0;r<64;)t(i)&&(r<8&&(o[r]=n(e.pow(i,.5))),c[r]=n(e.pow(i,1/3)),r++),i++}();var u=[],l=s.SHA256=a.extend({_doReset:function(){this._hash=new r.init(o.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,i=n[0],r=n[1],a=n[2],s=n[3],o=n[4],l=n[5],d=n[6],h=n[7],p=0;p<64;p++){if(p<16)u[p]=0|e[t+p];else{var f=u[p-15],m=(f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3,y=u[p-2],g=(y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10;u[p]=m+u[p-7]+g+u[p-16]}var v=i&r^i&a^r&a,b=(i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22),_=h+((o<<26|o>>>6)^(o<<21|o>>>11)^(o<<7|o>>>25))+(o&l^~o&d)+c[p]+u[p];h=d,d=l,l=o,o=s+_|0,s=a,a=r,r=i,i=_+(b+v)|0}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+a|0,n[3]=n[3]+s|0,n[4]=n[4]+o|0,n[5]=n[5]+l|0,n[6]=n[6]+d|0,n[7]=n[7]+h|0},_doFinalize:function(){var t=this._data,n=t.words,i=8*this._nDataBytes,r=8*t.sigBytes;return n[r>>>5]|=128<<24-r%32,n[14+(r+64>>>9<<4)]=e.floor(i/4294967296),n[15+(r+64>>>9<<4)]=i,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=a._createHelper(l),t.HmacSHA256=a._createHmacHelper(l)}(Math),n.SHA256)}));class gn{constructor(e,t,n={}){this.programmer=e,this.applicationId=t,this.metadata=n}withSession(e){const{authenticationType:t,authenticatedIdentity:n,authenticatedProvider:i,mediaItem:r}=e;if(![we.mvpd,we.direct].includes(t))return this;const a=n,s=i&&i.id;return this.metadata[on]=a,this.metadata[cn]=r.network&&r.network.id,this.metadata[un]=r.streamType===de.live?an:sn,this.metadata[ln]="",this.metadata[dn]=!!e.authenticatedProvider&&e.authenticatedProvider.isHomeBasedAuth,this.subject=a,this.identityProvider=s,this}withLocationProvider(e){const t=e.getPublicIPAddress();return this.metadata[hn]=t?yn("m!ck3ym0u$3"+t):null,this.metadata[pn]=e.getRegion()?e.getRegion():null,this}withServiceUrl(e){return this.serviceUrl=e,this}withMessages(e){return this.messages=e,this}build(){if(!this.subject||!this.identityProvider)return null;const e=new fn(this.programmer,this.applicationId,this.identityProvider,this.subject,this.metadata);return this.serviceUrl&&(e.serviceUrl=this.serviceUrl),this.messages&&(e.messages=this.messages||{}),e}}class vn{constructor(e,t){this.partner=e,this.platform=t}startSession(e,t,n,i,r,a){const{partner:s,platform:o}=this,c=["partner="+s,"platform="+o,"token="+encodeURIComponent(n),"tokenType="+i,"v=2.0.0","ttl=21600"];if(r){const e=L.stringify(U.parse(r));c.push("resource="+encodeURIComponent(e))}a&&Object.keys(a).forEach(e=>{c.push(`${e}=${encodeURIComponent(a[e])}`)});const u=/swid=*/g;c.some(e=>u.test(e))||c.push("swid="+encodeURIComponent(t));return T(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},credentials:"include",body:c.join("&")}).then(e=>e.json()).then(e=>{if(!e.session)throw new Error(e.message||`An unexpected error occurred. [${e.abbreviation}]`);return e}).catch(e=>{if(e.message)throw new Error(e.message);return e.json().then(e=>{throw new Error(e.message||`An unexpected error occurred. [${e.abbreviation}]`)})})}}!function(e){e.FINISH="finish",e.FMI="FMI",e.FETCH_ITEM="FMI",e.FMI_S="FMI_S",e.FMI_F="FMI_F",e.FMI_E="FMI_E",e.FMI_R="FMI_R",e.FC="FC",e.FC_S="FC_S",e.FC_F="FC_F",e.CAZ="CAZ",e.CAN_T="CAN<T>",e.CAZ_T="CAZ<T>",e.B_FM="B_FM",e.B_FMF="B_FMF",e.B_RIT="B_RIT",e.B_L="B_L",e.B_RA="B_RA",e.T_FESPN="T_FESPN",e.T_FESPNF="T_FESPNF",e.T_FSH="T_FSH",e.T_FSHF="T_FSHF",e.T_FSS="T_FSS",e.T_FSSF="T_FSSF",e.T_FE="T_FE",e.T_FEF="T_FEF",e.T_NIT="T_NIT",e.T_CHP="T_CHP",e.T_PL="T_PL",e.T_CMAN="T_CMAN",e.T_PJWT="T_PJWT",e.T_NJWT="T_NJWT",e.T_BJWT="T_BJWT",e.MPS="MPS",e.CM_I="CM_I",e.CM_IF="CM_IF",e.B_P="B_P",e.MP_I="MP_I",e.MP_L="MP_L",e.MP_S="MP_S",e.MP_C_PA="MP_C_PA",e.MP_C_PL="MP_C_PL",e.MP_SE="MP_SE",e.MP_S_S="MP_S_S",e.MP_S_E="MP_S_E",e.MP_V_M="MP_V_M",e.MP_V_U="MP_V_U",e.MP_CC_ON="MP_CC_ON",e.MP_CC_OFF="MP_CC_OFF",e.MP_C_C="MP_C_C",e.MP_D="MP_D",e.C_P_G_C_F="C_P_G_C_F",e.C_P_G_T_F="C_P_G_T_F",e.C_P_T_F="C_P_T_F",e.C_P_R_V_F="C_P_R_V_F",e.MP_AB_S="MP_AB_S",e.MP_AB_E="MP_AB_E",e.MP_A_S="MP_A_S",e.MP_A_E="MP_A_E",e.MP_A_CL="MP_A_CL",e.MP_A_CO="MP_A_CO",e.MP_A_F="MP_A_F",e.AOF="AOF",e.AOF_F="AOF_F",e.AOF_E="AOF_E",e.AOF_S="AOF_S",e.PCHF="PCHF",e.PCHF_I="PCHF_I",e.PCHF_I_F="PCHF_I_F",e.PCHF_I_S="PCHF_I_S",e.PCHF_M="PCHF_M",e.PCHF_M_F="PCHF_M_F",e.PCHF_M_S="PCHF_M_S",e.PCHF_PCH="PCHF_PCH",e.PCHF_PNCH="PCHF_PNCH"}(mn||(mn={}));var bn=new class{constructor(){this.errorReason_=null,this.breadcrumbs_=[]}add(e){e&&this.breadcrumbs_.push(e)}setErrorReason(e){this.errorReason_=e}getErrorReason(){return this.errorReason_}getCrumbs(){return this.breadcrumbs_}reset(){this.breadcrumbs_=[],this.errorReason_=null}};class _n{constructor(e){this.authButler=e}initPlaybackSession(e,t,n){let{url:i}=e.source;e.source.startSessionUrl&&e.source.type===Ie.shield&&(i=e.source.startSessionUrl);try{const e=window&&window.location.protocol;e&&"https:"===e&&(i=i.replace(/^http(s?):/,e))}catch(e){}const{customData:{token:r,tokenType:a,resource:s=e.mrss}}=n,o=t&&t.swid,{authButler:c}=this;if(!c)throw bn.setErrorReason("noAuthButler"),new Error("startSession support not configured");return c.startSession(i,o,r,a,s,t.dictionaryForStartSession()).then(t=>{bn.add(mn.T_FSS);const i=function(e,t){const{playbackUrl:n}=e,i=new Xt(n);return i.token=t,i}(t,r);return i.mediaItem=e,i.seekToTime=e.seekInSeconds,i.authenticationType=n.authenticationType,i.authenticatedProvider=n.authenticatedProvider,i.authenticatedIdentity=n.authenticatedIdentity,i}).catch(e=>{throw bn.add(mn.T_FSSF),bn.setErrorReason("startSessionFetchFailed"),e})}}class wn{initPlaybackSession(e,t,n){const i=new Xt(e.source.url);return i.mediaItem=e,i.seekToTime=e.seekInSeconds,i.authenticationType=null==n?void 0:n.authenticationType,i.authenticatedProvider=null==n?void 0:n.authenticatedProvider,i.authenticatedIdentity=null==n?void 0:n.authenticatedIdentity,S.resolve(i)}}const Pn="ADOBEPASS",In="JWT",Sn="AUTHTOKEN",Tn="SESSIONTOKEN";class An{constructor(e,t){this.drmSupport=tn.none,this.palEnabled=!1,this.palMaxLength=3e3,this.serviceUrl="https://watch.auth.api.espn.com",this.apiKey=e,this.didOverrideServiceUrl=!!t,this.serviceUrl=this.didOverrideServiceUrl?t:"https://watch.auth.api.espn.com"}set tokenType(e){this.tokenType_=e}get tokenType(){return this.tokenType_}getAsset(e,t,n,i,r){return C(this,void 0,void 0,(function*(){const a=`${this.serviceUrl}/video/auth/media/${e}/asset`;return yield this.getAssetForUrl(a,t,n,i,r,e)}))}getAssetForUrl(e,t,n,i,r,a){return C(this,void 0,void 0,(function*(){this.tokenType=n;const s=this.getHeaders(t),o=this.getShieldApiUrl(a,e,t);if(!o)throw new Error("Shield API URL is undefined.");const c=this.getParameters(r,i,t),u={method:"POST",headers:s,credentials:"include",body:Object.keys(c).map(e=>`${e}=${encodeURIComponent(c[e])}`).join("&")};try{const e=yield T(o,u);if(!(null==e?void 0:e.ok))throw e;const t=yield e.json();if(!t.stream){const e=t.message||"An unexpected error occurred.";throw new Error(e)}return t}catch(e){return this.handleErrorResponse(e)}}))}getHeaders(e){const t={"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"};return e&&this.tokenType==In&&(t.Authorization="Bearer "+e),t}getShieldApiUrl(e,t,n){let i=t;!this.didOverrideServiceUrl&&i||!e||(i=`${this.serviceUrl}/video/auth/media/${e}/asset`);const r=-1===i.indexOf("?")?"?":"&";return i=`${i}${r}apikey=${this.apiKey}`,n&&this.tokenType==Sn&&(i=`${i}&authtoken=${n}`),i}getParameters(e,t,n){const i=Object.assign(Object.assign({},e),{drmSupport:this.drmSupport});if(this.tokenNotRequiredInPayload(n))return i;if(this.tokenType===Pn){if(i.adobeToken=n,t){const e=L.stringify(U.parse(t));i.adobeResource=e}}else this.tokenType==Tn?i.sessionToken=n:i.token=n;return i}tokenNotRequiredInPayload(e){return!e||this.tokenType===Sn||this.tokenType===In}handleErrorResponse(e){return C(this,void 0,void 0,(function*(){if(e instanceof Error||"function"!=typeof(null==e?void 0:e.json))throw e;const t=yield e.json();let n=(null==t?void 0:t.message)||`An unexpected error occurred. [${null==t?void 0:t.exception}]`;throw"com.espn.watch.api.AccessDeniedException"===(null==t?void 0:t.exception)&&(n="This content is not available for your package or region."),new Error(n)}))}}An.defaultServiceUrl="https://watch.auth.api.espn.com";class kn{constructor(e){this.shieldAPI=e}initPlaybackSession(e,t,n){var i;return C(this,void 0,void 0,(function*(){const{shieldAPI:r}=this;if(!r)throw bn.setErrorReason("noShieldFetchAPI"),new Error("shield support not configured");const{palEnabled:a,palMaxLength:s}=r,o=n.customData.token,c=n.customData.zipcode,{customData:{hasShieldResponse:u,tokenType:l,resource:d=e.mrss}={}}=n;if(a&&null===t.palNonce)try{t.palNonce=yield Ct.getGooglePalNonce(t,s)}catch(e){console.warn(e)}const h=this.getAdParams_(t,null===(i=null==e?void 0:e.advertisingInfo)||void 0===i?void 0:i.adConfigType,c),p=e.source.url;try{let t;t=u?n.customData:yield r.getAssetForUrl(p,o,l,d,h,e.id),bn.add(mn.T_FSH);const{stream:i,captions:a,streamInfo:s,gatekeeperToken:c}=t,f=new Xt(i);return f.mediaItem=e,f.seekToTime=e.seekInSeconds,f.authenticationType=n.authenticationType,f.authenticatedProvider=n.authenticatedProvider,f.authenticatedIdentity=n.authenticatedIdentity,f.token=c,f.playbackConfig=function(e){if(!e)return null;const{streamType:t,licenseAcquisitionUrl:n,certificateUrl:i}=e;switch(t){case"DASH_PLAYREADY":return new Qt("application/dash+xml",Jt.playReady,n);case"DASH_WIDEVINE":return new Qt("application/dash+xml",Jt.widevine,n);case"HLS_FAIRPLAY":return new Qt("application/x-mpegURL",Jt.fairPlay,i);case"HLS":return new Qt("application/x-mpegURL",Jt.none);default:return null}}(s),f.textTracks=function(e){if(!e)return[];const t={source:e};return e.endsWith(".vtt")&&(t.contentType="text/vtt"),[t]}(a),f}catch(e){throw bn.add(mn.T_FSHF),bn.setErrorReason("shieldFetchFailed"),e}}))}getAdParams_(e,t,n){var i;let r=null;return t===Ot.immutable?r=e:(r=null===(i=null==e?void 0:e.dictionaryForStartSession)||void 0===i?void 0:i.call(e),n&&(r.zipcode=n)),r}}class En{constructor(){this.partner=null,this.platform=null,this.apiKey=null,this.deviceId=null,this.authenticators={},this.authorizers={},this.playbackSessionFactories={},this.playbackSessionFactories[Ie.none]=new wn}getAuthenticator(e){return this.authenticators[e]}setAuthenticator(e,t){this.convertToArray(t).forEach(t=>{this.authenticators[t.toString()]=e})}getAuthorizer(e){return this.authorizers[e]}setAuthorizer(e,t){this.convertToArray(t).forEach(t=>{this.authorizers[t.toString()]=e})}getPlaybackSessionFactory(e){return this.playbackSessionFactories[e]}setPlaybackSessionFactory(e,t){this.playbackSessionFactories[t]=e}checkAuthentication(){const e=Object.keys(this.authenticators).map(e=>{const t=this.authenticators[e];return t.checkAuthentication().then(n=>(P.debug(e+" authenticator","isAuthenticated: "+n,"authenticatedProvider: "+t.authenticatedProvider),n)).catch(()=>!1)});return S.all(e).then(e=>e.every(e=>!0===e))}isAuthenticatedForMediaItem(e){if(e.authenticationTypes.length<1||-1!==e.authenticationTypes.indexOf(we.none))return!0;return e.authenticationTypes.map(e=>this.authenticators[e]).filter(e=>e).some(e=>e.isAuthenticated)}isAuthenticatedWithAuthType(e){const t=this.authenticators[e];return!!t&&t.isAuthenticated}authenticateWithAuthType(e,t){const n=this.authenticators[e];if(n)return n.authenticate(t)}checkAuthorization(e,t){var n,i;if(bn.add(mn.CAZ),(null==e?void 0:e.authenticationTypes)&&Array.isArray(e.authenticationTypes)&&e.authenticationTypes.length<1||-1!==e.authenticationTypes.indexOf(we.none)){bn.add(mn.CAN_T.replace("T",we.none)),bn.add(mn.CAZ_T.replace("T",we.none));const t=new yt(e.id,e.title,(null===(i=null===(n=null==e?void 0:e.images)||void 0===n?void 0:n[0])||void 0===i?void 0:i.url)||"",e.source.url),r=new gt(we.none,t,e.id,{}),a=new vt(!0,r);return S.resolve(a)}const r=[we.open,we.direct,we.mvpd,we.isp].filter(t=>-1!==e.authenticationTypes.indexOf(t)),a=r.map(e=>this.authorizers[e]).filter(e=>e&&e.checkAuthorization);return P.debug("mediaItem.authTypes:",r),0===a.length?S.reject(new Error("no authorizer configured to support authTypes: "+e.authenticationTypes)):function e(t,n,i,r=[]){return i.shift().checkAuthorization(t,n).then(a=>{const{success:s}=a;return s?a:i.length<1?r.length>0?S.reject(null):a:e(t,n,i,r)}).catch(a=>{if(i.length>0)return a&&r.push(a),e(t,n,i,r);const s=r[0]||a;if(s)throw s})}(e,t,a)}initPlaybackSession(e,t){return!e.source.type&&e.authenticationTypes.length>0?(bn.setErrorReason("missingMediaSourceType"),S.reject(new Error("This event is not currently available."))):this.checkAuthorization(e,t).then(n=>{var i,r,a,s,o,c;P.debug("AuthenticationManager.initPlaybackSession.checkAuthorization result:",n.success);const{success:u,payload:l}=n;if(!u)throw bn.setErrorReason("notAuthorized"),new Error("Not authorized.");if(!(null===(i=null==e?void 0:e.source)||void 0===i?void 0:i.type))throw bn.setErrorReason("missingMediaSourceType"),new Error("Media Item source type is missing.");const d=this.playbackSessionFactories[null===(r=null==e?void 0:e.source)||void 0===r?void 0:r.type];if(!d)throw bn.setErrorReason("missingMediaSourceType"),new Error(`SessionFactory for source type '${null===(a=null==e?void 0:e.source)||void 0===a?void 0:a.type}' is missing.`);const h=this.getAdInfo_(null===(s=null==e?void 0:e.advertisingInfo)||void 0===s?void 0:s.adConfigType,t,null===(c=null===(o=null==n?void 0:n.payload)||void 0===o?void 0:o.authenticatedProvider)||void 0===c?void 0:c.id);return bn.add(mn.MPS),d.initPlaybackSession(e,h,l).then(e=>{P.debug("AuthenticationManager.initPlaybackSession",e);const t=this.concurrencyMonitorBuilder&&this.concurrencyMonitorBuilder.withSession(e).build();return t?t.createSession().then(t=>(bn.add(mn.CM_I),e.concurrencyMonitorSessionId=t,e)).catch(e=>{throw bn.add(mn.CM_IF),bn.setErrorReason("concurrencyInitializationFailed"),e}):e})})}getAdInfo_(e,t,n){let i=null;return e===Ot.immutable?i=t:(i=new Ct,i.authenticationProvider=n,i.merge(t)),i}get authStates(){const e=this.authenticators[we.mvpd],t=[];return this.authenticators[we.isp].isAuthenticated&&t.push("isp"),!0===e.isAuthenticated?t.push("mvpd_login"):!0===e.wasPreviouslyAuthenticated&&t.push("mvpd_previous"),t}get preauthorizedResources(){return Object.keys(this.authenticators).map(e=>this.authenticators[e].preauthorizedResources).reduce((e,t)=>e.concat(t),[]).filter((e,t,n)=>n.indexOf(e)===t)}get primaryAuthenticatedProvider(){return[we.mvpd,we.isp].map(e=>this.getAuthenticator(e)).filter(e=>e.isAuthenticated).map(e=>e.authenticatedProvider)[0]}convertToArray(e){if(!e)return[];let t=[];return Array.isArray(e)?t=e:"string"==typeof e&&t.push(e),t}}var Cn;En.AuthenticateOptionsKey={redirectUrl:"redirectUrl"},function(e){e[e.all=0]="all",e[e.linearPlayback=1]="linearPlayback"}(Cn||(Cn={}));var Mn,On=Cn;!function(e){e.linear="linear",e.event="event"}(Mn||(Mn={}));var Dn,Nn=Mn;!function(e){e.stitchedPreroll="stitchedPreroll"}(Dn||(Dn={}));var Ln,Un=Dn;!function(e){e.live="live",e.onDemand="onDemand"}(Ln||(Ln={}));var jn,Fn=Ln;!function(e){e.nielsen="nielsen",e.comscore="comscore",e.conviva="conviva",e.heartbeats="heartbeats"}(jn||(jn={}));var Rn,xn=jn;!function(e){e.shortform="shortform",e.longform="longform"}(Rn||(Rn={}));var Hn,Bn=Rn;!function(e){e.audio="audio",e.video="video"}(Hn||(Hn={}));var zn,Vn=Hn;!function(e){e.pluto="pluto",e.graphQL="graphQL",e.cfa="cfa",e.itemFeed="itemFeed"}(zn||(zn={}));var Kn,Gn=zn;!function(e){e.open="OPEN",e.direct="DIRECT",e.mvpd="MVPD",e.isp="ISP",e.none="NONE"}(Kn||(Kn={}));var qn,$n=Kn;!function(e){e.none="none",e.startSession="startSession",e.bam="bam",e.shield="shield",e.entitlement="entitlement"}(qn||(qn={}));var Wn=qn,Jn=function(){function e(e,t,n,i,r,a,s,o){this.url=e,this.type=t,this.hasEspnId3Heartbeats=n,this.hasNielsenWatermarks=i,this.hasPassThroughAds=r,this.commercialReplacement=a,this.startSessionUrl=s,this.variant=o}return e.fromObject=function(t){if(!t)return null;var n=t.url,i=t.type,r=t.hasEspnId3Heartbeats,a=t.hasNielsenWatermarks,s=t.hasPassThroughAds,o=t.commercialReplacement,c=t.startSessionUrl,u=t.variant;return new e(n,Wn[i],r,a,s,o,c,u)},e}(),Yn=function(){function e(e,t,n,i){this.id=e,this.type=t,this.name=n,this.resource=i}return e.fromObject=function(t){if(!t)return null;var n=Nn[t.type];return new e(t.id,n,t.name,t.resource)},e}(),Qn=function(){function e(e){this.url=e}return e.fromObject=function(t){return t&&t.url?new e(t.url):null},e}(),Xn=function(){function e(e){this.name=e}return Object.defineProperty(e.prototype,"logoUrl",{get:function(){return"https://secure.espncdn.com/watchespn/images/espnplus/packages/"+this.name+".png"},enumerable:!1,configurable:!0}),e.fromObject=function(t){return t?new e(t.name):null},e}(),Zn=function(){function e(e,t,n,i,r){this.id=e,this.title=t,this.duration=n,this.language=i||"en",this.source=r,this.description=null,this.authenticationTypes=[],this.mrss=null,this.seekInSeconds=null,this.tracking={},this.references={},this.network=null,this.streamType=null,this.supportedMediaCommands=On.all,this.images=[],this.type=Vn.video,this.packages=[],this.tier=null,this.entityType=null,this.isSyndicatable=null,this.brand=null,this.apiSource=null,this.adUnitId=null,this.cues=null,this.adTarget=null,this.show=null}return Object.defineProperty(e.prototype,"isLinear",{get:function(){return!!this.network&&this.network.type===Nn.linear},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLive",{get:function(){return this.streamType===Fn.live},enumerable:!1,configurable:!0}),e.fromObject=function(t){var n=Jn.fromObject(t.source),i=new e(t.id,t.title,t.duration,t.language,n);return i.airDate=t.airDate,i.apiSource=t.apiSource,i.authenticationTypes=t.authenticationTypes,i.description=t.description,i.images=(t.images||[]).map((function(e){return Qn.fromObject(e)})),i.mrss=t.mrss,i.network=Yn.fromObject(t.network),i.seekInSeconds=t.seekInSeconds,i.streamType=Fn[t.streamType],i.supportedMediaCommands=t.supportedMediaCommands,i.tracking=t.tracking,i.references=t.references,i.packages=(t.packages||[]).map((function(e){return Xn.fromObject(e)})),i.tier=t.tier,i.type=Vn[t.type],i.entityType=Bn[t.entityType],i.isSyndicatable=t.isSyndicatable,i.brand=t.brand,i.adUnitId=t.adUnitId,i.cues=t.cues,i.show=t.show,i.adTarget=t.adTarget,i.availableDate=t.availableDate,i.episodeNumber=t.episodeNumber,i.locale=t.locale,i.seasonNumber=t.seasonNumber,i.tmsid=t.tmsid,i.videoShowGenre=t.videoShowGenre,i},e.prototype.toString=function(){return"<MediaItem id:"+this.id+", title:"+this.title+", streamType:"+this.streamType+">"},e}();var ei,ti=function(){function e(e){var t=function(e){var t=e.split("?")[1],n={};if(t)for(var i=t.split("&"),r=0;r<i.length;r+=1){var a=i[r].split("=");n[a[0]]=a[1]}return n}(e);if(this.original=e,this.id=t.videoID||t.playID||t.clip||t.externalId,e.match("sportscenter")){this.gameId=t.playGameID,this.channel=t.playChannel,this.simulcastAiringId=t.simulcastAiringId;var n=parseInt(t.resumeTime,10);isNaN(n)||(this.resumeTime=n),this.eventId=t.eventId}else e.match("abcnews")&&(this.channel=t.playChannel,this.id=t.videoID||t.id);this.source=t["x-source"],t.videoID?this.entityType=Bn.shortform:this.entityType=Bn.longform,this.type=Vn.video}return e.prototype.toString=function(e){return e==Gn.graphQL?"<MediaItemIdentifier id:"+this.id+", gameId:"+this.gameId+", channel:"+this.channel+", source:"+this.source+">":"<MediaItemIdentifier id:"+this.id+", source:"+this.source+">"},e.identifierStringForNetwork=function(e,t){switch(t){case Gn.cfa:return"natgeo://playVideo?videoID="+e;case Gn.itemFeed:return"abcnews://playVideo?playChannel="+e;case Gn.graphQL:default:return"sportscenter://x-callback-url/showWatchStream?playChannel="+e}},e}();function ni(e,t,n,i){if(!t)return{};var r,a,s,o=null;e===ei.natGeo?o=function(e){if(!e)return{};var t={},n=e.id,i=e.title,r=e.duration;return t.c_video_id_code=n,t.c_a_media_airdate="unknown",t.c_a_media_daypart="daytime",t.c_a_media_digitaldate="unknown",t.c_a_media_episode="none",t.c_a_media_feed="natgeo live",t.c_a_media_format="vod",t.c_a_media_genre="none",t.c_a_media_network="natgeo",t.c_a_media_originator="natgeo",t.c_a_media_pass_auth="none",t.c_a_media_pass_mvpd="none",t.c_a_media_rating="none",t.c_a_media_season="none",t.c_a_media_show=i,t.c_a_media_streamtype=Hn.video,t.c_a_media_length=r,t}(t):(r=function(e,t,n){if(!e)return{};var i=e.duration,r=e.id,a=e.league,s=e.name,o=e.network,c=e.program,u=e.sport,l=e.startDateTime,d=e.tracking,h="1";n&&!0===n.hasEspnId3Heartbeats&&!1===n.hasPassThroughAds&&"SHARED INV"!==n.commercialReplacement&&(h="2");var p={type:"content"};if(p.assetid=d&&d.trackingId||r,p.program=s,p.title=s,p.clientid="us-600140",t===Bn.longform){if(p.length=""+i,p.segB=a&&a.name||"No League",p.segC=""+(c&&c.code||"")+(u&&u.code||""),l){var f=new Date(l);p.airdate=f.getUTCFullYear().toString()+("0"+f.getUTCMonth()).slice(-2)+("0"+f.getUTCDate()).slice(-2)+" "+("0"+f.getUTCHours()).slice(-2)+":"+("0"+f.getUTCMinutes()).slice(-2)+":"+("0"+f.getUTCSeconds()).slice(-2)}p.isfullepisode="y",p.crossId1=d&&d.nielsenCrossId1||"",p.crossId2=o&&o.name||"",p.adloadtype=h,p.hasAds="1",p.progen="SE",p.vcid="b01"}return t===Bn.shortform&&(p.accmethod="1",p.length=""+i,p.segA=s,p.segB="No League",p.segC="VOD",p.isfullepisode="n",p.crossId1="",p.adloadtype="1",p.vcid="c17",p.adloadtype="2"),p}(t,n,i),a=function(e,t){if(!e)return{};var n=e.id,i=e.duration,r=e.name,a=e.league,s=e.startDateTime,o=e.network,c=e.sport,u=e.status,l=e.tracking,d={};if(t===Bn.longform)d.ns_st_cl=0,d.ns_st_ct="vc",!u||"live"!==u.toLowerCase()&&"over"!==u.toLowerCase()?(d.ns_st_cl=i,d.ns_st_ct="vc12",d.ns_st_pr="VOD",d.ns_st_ep=r):(d.ns_st_cl=0,d.ns_st_ct="vc13",d.ns_st_pr=r,d.ns_st_ep="*null"),d.c3="WATCHESPNLIVE",d.c6=a&&a.name?a||"No league":c&&c.code||"No Sport";else{d.ns_st_cl=i,d.ns_st_ct="vc11",d.ns_st_pr="VOD",d.ns_st_ep=r;var h=l||{},p=h.sportName,f=h.leagueName;d.c3="vod",d.c6=""+(f&&"no league"!==f.toLowerCase()?f:p||"No Sport")}if(d.ns_st_ti="*null",d.ns_st_ia="*null",d.ns_st_ce="*null",d.ns_st_ci=n,s){var m=new Date(s);d.ns_st_ddt=m.toDateString(),d.ns_st_tdt=m.toDateString()}return d.ns_st_st=o?o.id:"*null",d.ns_st_en="*null",d.ns_st_cn="1",d.ns_st_pn="1",d.ns_st_tp="1",d.ns_st_pu="ESPN",d.ns_st_cu="none",d.ns_st_ad="0",d.ns_st_ge="Sports",d}(t,n),s=function(e,t,n){if(!e)return{};var i=e.name,r=e.id,a=e.airingId,s=e.eventId,o=e.duration,c=e.network,u=e.status,l=e.sport,d=e.league,h={};h.contentId=r,a&&(h.airingId=a),s&&(h.eventId=""+s,h.eventName=i),c&&(h.network=c.id),t===Bn.shortform?h.assetType="clip":!u||"live"!==u.toLowerCase()&&"over"!==u.toLowerCase()?h.assetType="vod":h.assetType="live";var p=i+" - "+r;return c&&c.type===Nn.linear&&"live"===h.assetType&&(p=c.id),h.sport=l&&l.name||"Not Applicable",h.league=d&&d.name||"Not Applicable",h.appBrand=ei.espn,{assetName:p,duration:o,streamUrl:n&&n.url,custom:h}}(t,n,i),o=function(e,t){if(!e)return{};var n=e.duration,i=e.airingId,r=e.network,a=e.status,s=e.sport,o=e.league,c=e.name,u=e.program,l=e.startDateTime,d=e.tracking,h=e.originalPublishDate,p=e.expirationDate,f=e.lastModifiedDate,m=e.ad,y=e.coverageType,g=e.brands,v={};if(v.ContentDuration=n,t===Bn.longform){if(v.CMSID=d&&d.name||c,v.isFullEpisode="y",i&&(v.AiringID=i),r&&(v.NetworkName=r.id,v.Channel=r.id),a&&(v.VideoType="REPLAY"===a?"replay":"live"),v.Sport=s&&s.name||"Not Applicable",v.SportCode=s&&s.code||"Not Applicable",v.League=o&&o.name||"Not Applicable",u&&u.code&&u.categoryCode?v.ProgramCode=u.categoryCode+u.code:v.ProgramCode="Not Applicable",v.IsStudio=u&&u.isStudio||"Not Applicable",l){var b=new Date(l);v.AirDate=b.toDateString(),v.AirTime=b.toTimeString()}if(Array.isArray(g)&&g.length){var _=g[0],w=_.id,P=_.name,I=_.type;v["a.media.asset"]=w,v["a.media.show"]=P,v["a.media.genre"]=I}}else if(t===Bn.shortform){if(v.isFullEpisode="n",v.VideoType="vod",v.Sport=d&&d.sportName||"Not Applicable",v.League=d&&d.leagueName||"Not Applicable",v.ShowCode=m&&m.bundle||"Not Applicable",d&&d.name&&(v.CMSID=d.name),h){b=new Date(h);v.PublishDate=b.toISOString().substring(0,10),v.PublishTime=b.toISOString().substring(11)}if(p){b=new Date(p);v.ExpirationDate=b.toISOString()}if(f){b=new Date(f);v.DateLastModified=b.toISOString()}y&&(v.VideoTypeDetail=y)}return v}(t,n));var c={};return c[xn.nielsen]=r,c[xn.comscore]=a,c[xn.conviva]=s,c[xn.heartbeats]=o,c}function ii(e,t,n){return e.sort((function(e,t){var n="PRIMARY"===e.tier?0:"SECONDARY"===e.tier?1:2,i="PRIMARY"===t.tier?0:"SECONDARY"===t.tier?1:2;return n<i?-1:n>i?1:0})).sort((function(e,n){var i=e.network&&e.network.id.toLowerCase()||"unknown",r=n.network&&n.network.id.toLowerCase()||"unknown",a=t.indexOf(i),s=t.indexOf(r);return-1===a&&(a=999),-1===s&&(s=999),a<s?-1:a>s?1:0})).sort((function(e,t){var i=e.language===n?0:1,r=t.language===n?0:1;return i<r?-1:i<r?1:0}))}!function(e){e.abc="abc",e.abcNews="abcnews",e.abcNewsLive="abcnewslive",e.abcOtv="abcotv",e.cricinfo="cricinfo",e.disney="dch",e.disneyJr="djr",e.disneyXD="dxd",e.disneyNow="dnow",e.espn="espn",e.espnFantasy="espnFantasy",e.fiveThirtyEight="fivethirtyeight",e.foxLatam="foxlatam",e.freeform="ff",e.fxNow="fxnow",e.fx="fx",e.fxm="fxm",e.fxx="fxx",e.oscar="oscar",e.marvel="marvel",e.natGeoTV="ngtv",e.natGeo="ngc",e.natGeoWild="ngw",e.natgeoBrasil="natgeobrasil",e.theUndefeated="theundefeated",e.unknown="000"}(ei||(ei={}));var ri=["espn_ppv","espn_dtc","espn1","espn2","espn3","espnu","sec","espnews","espndeportes","longhorn","goalline","buzzerbeater","secplus","acc","accextra","espn_free","bam_dtc"],ai=function(e,t,n,i){e==Gn.graphQL?(this.serviceUrl=t||"https://watch.graph.api.espn.com/api",this.apiKey=n||"d15c5790-7cb0-4fe1-8782-25f4698d0739",this.networkSortOrder=i||ri):e==Gn.cfa?this.serviceUrl=t||"https://natgeo.entertainment.client.dtci.technology/v1/playback/video/id/mock":e===Gn.itemFeed&&(this.serviceUrl=t||"https://abcnews.go.com/video/itemfeed")},si=function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return M(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var r,a,s,o,c,u;return M(this,(function(l){switch(l.label){case 0:return r=t.map((function(e){return new ti(e)})),a=i.serviceUrl,s=i.apiKey,o=i.networkSortOrder,[4,S.all(r.map((function(t){return e.getPromiseMediaItems(t,a,s,n)})))];case 1:return c=l.sent(),(u=c.filter((function(e){return!(e instanceof Error)&&e instanceof Zn}))).length?[2,ii(u,o,navigator.language)]:[2,null]}}))}))},e.getPromiseMediaItems=function(t,n,i,r){return C(this,void 0,void 0,(function(){var a,s,o,c,u,l,d,h,p,f,m,y;return M(this,(function(g){switch(g.label){case 0:a=function(e,t,n,i){var r="",a="",s="",o=i||"US";return e.entityType===Bn.shortform?(r="VOD",s="{id name description authTypes language duration originalPublishDate expirationDate requiresLinearPlayback lastModifiedDate source { url authorizationType } image { url } tracking { name sportName leagueName } coverageType prerollSource:source(variant:PREROLL) { url authorizationType }ad { sport bundle } links { web } cerebroId syndicatable}",a='id:"'+e.id+'"'):(r="airing",s="{ id name description mrss:adobeRSS authTypes requiresLinearPlayback status:type startDateTime endDateTime duration source(authorization: SHIELD) { url authorizationType hasEspnId3Heartbeats hasNielsenWatermarks hasPassThroughAds commercialReplacement startSessionUrl } network { id type name adobeResource } image { url } sport { name code uid } league { name uid } program { code categoryCode isStudio } seekInSeconds simulcastAiringId airingId tracking { nielsenCrossId1 trackingId } eventId packages { name } language tier feedName brands { id name type } }",e.id?a='id:"'+e.id+'"':e.channel?(r="airings",a='networks:["'+e.channel+'"],type:LIVE'):e.gameId&&(r="airings",a='eventId:"'+(e.eventId||e.gameId)+'"')),t+"?apiKey="+n+"&query="+encodeURIComponent("{ "+r+"("+a+',countryCode:"'+o+'",deviceType:SETTOP,tz:"Z") '+s+" }")}(t,n,i,r.countryCode),g.label=1;case 1:return g.trys.push([1,4,,5]),[4,T(a)];case 2:return[4,g.sent().json()];case 3:if(s=g.sent(),o=s.data.airing,(c=s.data.airings)&&(u=t.simulcastAiringId?function(e){return e.simulcastAiringId===t.simulcastAiringId}:function(){return!0},o=c.filter(u)[0]),l=s.data.VOD,!(d=o||l))throw new Error("No results found.");if(h=function(e,t,n){var i=e.id,r=e.name,a=e.description,s=e.duration,o=e.image,c=e.eventId,u=e.requiresLinearPlayback,l=e.authTypes,d=e.source,h=e.prerollSource,p=e.packages,f=e.language,m=e.mrss,y=e.seekInSeconds,g=e.tracking,v=e.simulcastAiringId,b=e.network,_=e.status,w=e.cerebroId,P=e.syndicatable,I=_&&("LIVE"===_.toUpperCase()||"OVER"===_.toUpperCase())?Fn.live:Fn.onDemand,S=function(e){switch(e){case"NONE":return Wn.none;case"START_SESSION":return Wn.startSession;case"BAM":return Wn.bam;case"SHIELD":return Wn.shield}}(d.authorizationType),T=new Jn(d.url,S,d.hasEspnId3Heartbeats,d.hasNielsenWatermarks,d.hasPassThroughAds,d.commercialReplacement,d.startSessionUrl);n&&n.sourceVariant===Un.stitchedPreroll&&h&&((T=new Jn(h.url,Wn.none)).variant=Un.stitchedPreroll);var A=u?On.linearPlayback:On.all,k=g&&g.trackingId||i,E=new Zn(i,r,s,f,T);if(E.authenticationTypes=l.map((function(e){switch(e){case"DIRECT":return $n.direct;case"OPEN":return $n.open;case"MVPD":return $n.mvpd;case"ISP":return $n.isp;default:return $n.none}})),E.description=a,E.isSyndicatable=P,o&&o.url&&E.images.push(new Qn(o.url)),E.mrss=m,b){var C="linear"===b.type?Nn.linear:Nn.event;E.network=new Yn(b.id,C,b.name,b.adobeResource)}return E.seekInSeconds=y,E.streamType=I,E.supportedMediaCommands=A,E.brand=E.brand?E.brand:"espn",E.tracking=ni(E.brand,e,t,T),E.references={eventId:c,simulcastAiringId:v,trackingId:k,cerebroId:w},E.type=Vn.video,E.entityType=t,E.apiSource=Gn.graphQL,E.packages=(p||[]).map((function(e){return new Xn(e.name)})),E}(d,t.entityType,r),t.resumeTime&&(h.seekInSeconds=t.resumeTime),!h.source.url){if(p="OVER"===d.status.toUpperCase(),f=d.network&&d.network.type===Nn.linear,m=d.network&&d.network.id,p&&f&&m)return[2,e.retryGetMediaItems(m,n,i,r)];throw new Error("No playable url")}return[2,h];case 4:return y=g.sent(),P.warn("Failed to retrieve MediaItem from GraphQL: "+y),[2,null];case 5:return[2]}}))}))},e.retryGetMediaItems=function(t,n,i,r){return C(this,void 0,void 0,(function(){var a,s,o,c;return M(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),a=ti.identifierStringForNetwork(t,Gn.graphQL),s=new ti(a),[4,e.getPromiseMediaItems(s,n,i,r)];case 1:if((o=u.sent())&&o instanceof Zn==!0)return[2,o];throw new Error("Retry fetchMediaItems failed with "+t);case 2:return c=u.sent(),P.warn("MediaItem is over and retry failed: "+c),[2,null];case 3:return[2]}}))}))},e.defaultConfiguration=new ai(Gn.graphQL),e}();var oi=function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return M(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var n,r;return M(this,(function(a){switch(a.label){case 0:return n=t.map((function(e){return new ti(e)})),r=i.serviceUrl,[4,S.all(n.map((function(t){return e.getPromiseMediaItem(t,r)})))];case 1:return[2,a.sent().filter((function(e){return!(e instanceof Error)&&e instanceof Zn}))]}}))}))},e.getPromiseMediaItem=function(e,t){return C(this,void 0,void 0,(function(){var n,i,r;return M(this,(function(a){switch(a.label){case 0:n=t.replace("videoID",e.id),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,T(n)];case 2:return[4,a.sent().json()];case 3:return i=a.sent(),[2,function(e){var t=e.id,n=e.title,i=e.description,r=e.duration,a=e.source,s=e.type,o=e.entityType,c=e.streamType,u=e.authenticationTypes,l=e.language,d=e.network,h=e.brand,p=e.images,f=o,m=a.type,y=new Jn(a.url,m),g=new Zn(t,n,r,l,y);return g.authenticationTypes=u.map((function(e){switch(e){case"DIRECT":return $n.direct;case"OPEN":return $n.open;case"MVPD":return $n.mvpd;case"ISP":return $n.isp;default:return $n.none}})),g.description=i,d&&(g.network=new Yn(d.id,d.type,d.name,d.resource)),g.streamType=c,g.brand=h,g.tracking=ni(g.brand,e,f,y),g.images=p,g.type=s,g.entityType=f,g.apiSource=Gn.cfa,g}(i)];case 4:return r=a.sent(),P.warn("Failed to retrieve MediaItem from CFA: "+r),[2,null];case 5:return[2]}}))}))},e.defaultConfiguration=new ai(Gn.cfa),e}(),ci=Object.freeze({}),ui=Object.freeze({}),li=Gn.itemFeed,di={lf:"longform",sf:"shortform",live:"longform"},hi={"abcn:fivethirtyeight":"fivethirtyeight",abcn:"abcnews"},pi={name:"abc_news_live",type:"linear"},fi=["HLS_ALL","PDL_MED","PDL_LOW"];function mi(e){var t,n,i,r=(e||ci).channel||ci,a=r.item||ci,s=a["media-group"]||ci,o=s["media-content"]||ui,c=s["media-title"],u=(function(e){for(var t,n,i=fi.length,r=e.length,a=0;a<i;a++)for(var s=fi[a],o=0;o<r;o++){var c=e[o];if((null===(n=null===(t=null==c?void 0:c["media-category"])||void 0===t?void 0:t["@attributes"])||void 0===n?void 0:n.label)===s)return c}}(o)||ci)["@attributes"]||ci,l=(s["media-thumbnail"]||ci)["@attributes"]||ci,d=a.guid,h=a.title,p=a.temporalType,f=a.timestamp,m=a.link,y=u.duration,g=u.url,v=u.medium,b=(a.omniture||ci).channel||"",_=O(String(b).split(":"),1)[0],w=hi[b]||hi[void 0===_?"abcn":_]||"abcnews",P="vod"===p,I="live"===p,S=di[a.videoContentType]||(P?"shortform":"longform"),T=c||h,A=r.language||"en";try{n=(t=O(new Date(f).toISOString().split("T"),2))[0],i=t[1]}catch(e){console.warn(e)}var k="akamai live stream"!==a.mediatype||P?{}:E(E({},pi),{id:d}),C={id:d,apiSource:li,seasonNumber:"none",eventId:"none",episodeNumber:"none",genre:"news",tvrating:"none",network:k,show:{title:T},title:T,duration:y,language:A,source:{url:g,type:"none"},description:a.description||s["media-description"],authenticationTypes:["NONE"],mrss:null,seekInSeconds:null,brand:w,type:"video"===v?"video":"audio",entityType:S,streamType:I?"live":"onDemand",images:l?[{url:l.url}]:null,airDate:a.timestamp,availableDate:a.pubDate,references:{itemfeed:d},tracking:{omniture:a.omniture,nielsen:{type:"content",assetid:d,program:T,title:T},conviva:{assetName:h,duration:y,streamURL:g,custom:{contentId:d,assetType:P?"clip":"live",sport:"none",league:"none",appBrand:a.category||"abcnews"}},heartbeats:{ContentDuration:y,isFullEpisode:"shortform"===S||I?"n":"y",VideoType:p,CMSID:T,PublishDate:n,PublishTime:i}},webHref:m};return Zn.fromObject(C)}var yi,gi,vi=w((function(e,t){function n(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function i(e,t){return t.encode?t.strict?encodeURIComponent(e).replace(/[!'()*]/g,e=>"%"+e.charCodeAt(0).toString(16).toUpperCase()):encodeURIComponent(e):e}function r(e,t){return t.decode?Ze(e):e}function a(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function s(e){const t=(e=a(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function o(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function c(e,t){n((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const i=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,i)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===i[e]&&(i[e]={}),i[e][t[1]]=n):i[e]=n};case"bracket":return(e,n,i)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==i[e]?i[e]=[].concat(i[e],n):i[e]=[n]:i[e]=n};case"comma":case"separator":return(t,n,i)=>{const a="string"==typeof n&&n.includes(e.arrayFormatSeparator),s="string"==typeof n&&!a&&r(n,e).includes(e.arrayFormatSeparator);n=s?r(n,e):n;const o=a||s?n.split(e.arrayFormatSeparator).map(t=>r(t,e)):null===n?n:r(n,e);i[t]=o};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),a=Object.create(null);if("string"!=typeof e)return a;if(!(e=e.trim().replace(/^[?#&]/,"")))return a;for(const n of e.split("&")){if(""===n)continue;let[e,s]=et(t.decode?n.replace(/\+/g," "):n,"=");s=void 0===s?null:["comma","separator"].includes(t.arrayFormat)?s:r(s,t),i(r(e,t),s,a)}for(const e of Object.keys(a)){const n=a[e];if("object"==typeof n&&null!==n)for(const e of Object.keys(n))n[e]=o(n[e],t);else a[e]=o(n,t)}return!1===t.sort?a:(!0===t.sort?Object.keys(a).sort():Object.keys(a).sort(t.sort)).reduce((e,t)=>{const n=a[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((e,t)=>Number(e)-Number(t)).map(e=>t[e]):t}(n):e[t]=n,e},Object.create(null))}t.extract=s,t.parse=c,t.stringify=(e,t)=>{if(!e)return"";n((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const r=n=>t.skipNull&&null==e[n]||t.skipEmptyString&&""===e[n],a=function(e){switch(e.arrayFormat){case"index":return t=>(n,r)=>{const a=n.length;return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[i(t,e),"[",a,"]"].join("")]:[...n,[i(t,e),"[",i(a,e),"]=",i(r,e)].join("")]};case"bracket":return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[i(t,e),"[]"].join("")]:[...n,[i(t,e),"[]=",i(r,e)].join("")];case"comma":case"separator":return t=>(n,r)=>null==r||0===r.length?n:0===n.length?[[i(t,e),"=",i(r,e)].join("")]:[[n,i(r,e)].join(e.arrayFormatSeparator)];default:return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,i(t,e)]:[...n,[i(t,e),"=",i(r,e)].join("")]}}(t),s={};for(const t of Object.keys(e))r(t)||(s[t]=e[t]);const o=Object.keys(s);return!1!==t.sort&&o.sort(t.sort),o.map(n=>{const r=e[n];return void 0===r?"":null===r?i(n,t):Array.isArray(r)?r.reduce(a(n),[]).join("&"):i(n,t)+"="+i(r,t)}).filter(e=>e.length>0).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[n,i]=et(e,"#");return Object.assign({url:n.split("?")[0]||"",query:c(s(e),t)},t&&t.parseFragmentIdentifier&&i?{fragmentIdentifier:r(i,t)}:{})},t.stringifyUrl=(e,n)=>{n=Object.assign({encode:!0,strict:!0},n);const r=a(e.url).split("?")[0]||"",s=t.extract(e.url),o=t.parse(s,{sort:!1}),c=Object.assign(o,e.query);let u=t.stringify(c,n);u&&(u="?"+u);let l=function(e){let t="";const n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);return e.fragmentIdentifier&&(l="#"+i(e.fragmentIdentifier,n)),`${r}${u}${l}`},t.pick=(e,n,i)=>{i=Object.assign({parseFragmentIdentifier:!0},i);const{url:r,query:a,fragmentIdentifier:s}=t.parseUrl(e,i);return t.stringifyUrl({url:r,query:tt(a,n),fragmentIdentifier:s},i)},t.exclude=(e,n,i)=>{const r=Array.isArray(n)?e=>!n.includes(e):(e,t)=>!n(e,t);return t.pick(e,r,i)}})),bi=(vi.extract,vi.parse,vi.stringify,vi.parseUrl,vi.stringifyUrl,vi.pick,vi.exclude,function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return M(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var n,r;return M(this,(function(a){switch(a.label){case 0:return n=t.map((function(e){return new ti(e)})),r=i.serviceUrl,[4,S.all(n.map((function(t){return e.getPromiseMediaItem(t,r)})))];case 1:return[2,a.sent().filter((function(e){return!(e instanceof Error)&&e instanceof Zn}))]}}))}))},e.getPromiseMediaItem=function(e,t){return C(this,void 0,void 0,(function(){var n,i,r;return M(this,(function(a){switch(a.label){case 0:n=vi.stringify({id:e.id||e.channel}),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,T(t+"?"+n+"&requester=guardians")];case 2:return[4,a.sent().json()];case 3:return i=a.sent(),[2,mi(i)];case 4:return r=a.sent(),P.warn("Failed to retrieve MediaItem from ItemFeed endpoint: "+r),[2,null];case 5:return[2]}}))}))},e.defaultConfiguration=new ai(Gn.itemFeed),e}());!function(){function e(){}Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(e,t){return C(this,void 0,void 0,(function(){var n,i=this;return M(this,(function(r){switch(r.label){case 0:return n=t||{sourceVariant:null},[4,S.all(e.map((function(e){return C(i,void 0,void 0,(function(){var t,i,r,a;return M(this,(function(s){switch(s.label){case 0:t=e.match("natgeo")?oi:e.match("abcnews")?bi:si,(r=new t).configuration=this.configuration||r.configuration,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,r.getMediaItems([e],n)];case 2:return a=s.sent(),i=null==a?void 0:a[0],[3,4];case 3:return s.sent(),[3,4];case 4:return[2,i]}}))}))})))];case 1:return[2,r.sent()]}}))}))}}();!function(e){e.localStorage="LOCAL_STORAGE",e.sessionStorage="SESSION_STORAGE"}(yi||(yi={})),function(e){e.token="token",e.tokenType="tokenType",e.resource="resource",e.requestor="requestor",e.fullToken="fullToken",e.zipcode="zipcode",e.mvpd="mvpd"}(gi||(gi={}));var _i,wi,Pi=function(){function e(e,t,n,i){void 0===i&&(i={}),this.authenticationType=e,this.authenticatedProvider=t,this.authenticatedIdentity=n,this.customData=i}return e.CustomDataKey=gi,e}(),Ii=function(e,t){this.success=e,this.payload=t};!function(e){e.standard="default",e.googleAdManager="gam"}(_i||(_i={})),function(e){e.standard="default",e.prod="prod",e.development="dev"}(wi||(wi={}));Object.freeze({}),Object.freeze("");var Si=function(){function e(){this.isAuthenticated=!0,this.authenticatedIdentity=null,this.authenticatedProvider=null,this.preauthorizedResources=this.isAuthenticated?["espn_free"]:[]}return e.prototype.checkAuthentication=function(){return S.resolve(!0)},e.prototype.authenticate=function(){return S.resolve(!0)},e.prototype.deauthenticate=function(){return S.resolve(!0)},e.prototype.checkAuthorization=function(e){var t;if(-1===e.authenticationTypes.indexOf($n.open)||!this.isAuthenticated)return S.resolve(new Ii(!1,null));var n=((t={})[Pi.CustomDataKey.token]="IA==",t[Pi.CustomDataKey.tokenType]="DEVICE",t),i=new Pi($n.open,this.authenticatedProvider,this.authenticatedIdentity,n),r=new Ii(!0,i);return S.resolve(r)},e}();const Ti="SESSIONTOKEN",Ai="GATEKEEPER";class ki{constructor(e,t,n,i){this.partner=e,this.platform=t,this.shieldAPI=n,this.palEnabled=i,this.isAuthenticated=!1,this.authenticatedIdentity=null,this.authenticatedProvider=null,this.preauthorizedResources=[],this.isSubscriber_=!1,this.authenticatedProvider=new yt("espn","","",""),this.isAuthenticated=!0,this.shieldAPI=n,this.palEnabled=i}get sessionToken(){return this.sessionToken_}set sessionToken(e){this.sessionToken_=e}get isSubscriber(){return this.isSubscriber_}set isSubscriber(e){this.isSubscriber_=e}checkAuthentication(){return this.isAuthenticated=!!this.sessionToken,S.resolve(this.isAuthenticated)}authenticate(){return this.isAuthenticated=!!this.sessionToken,S.resolve(this.isAuthenticated)}deauthenticate(){return this.isAuthenticated=!1,this.authenticatedProvider=null,this.authenticatedIdentity=null,S.resolve(!0)}checkAuthorization(e,t){var n,i;return C(this,void 0,void 0,(function*(){const{id:r,authenticationTypes:a=[],mrss:s}=e;if(-1===a.indexOf(we.direct)||!this.isAuthenticated||!this.isSubscriber)return S.resolve(new vt(!1,null));const o=null===(n=e.source)||void 0===n?void 0:n.url,c=this.sessionToken;if(this.palEnabled&&!(null==t?void 0:t.palNonce))try{t.palNonce=yield Ct.getGooglePalNonce(t,3e3)}catch(e){console.warn(e)}const u=(null===(i=null==t?void 0:t.dictionaryForStartSession)||void 0===i?void 0:i.call(t))||{};try{const e=yield this.shieldAPI.getAssetForUrl(o,c,Ti,s,u,r),{captions:t,gatekeeperToken:n,hasEspnId3Heartbeats:i,hasNielsenWatermarks:a,hasPassThroughAds:l,stream:d,streamInfo:h}=e,p={[gt.CustomDataKey.tokenType]:Ai,captions:t,gatekeeperToken:n,hasEspnId3Heartbeats:i,hasNielsenWatermarks:a,hasPassThroughAds:l,hasShieldResponse:!0,stream:d,streamInfo:h},f=new gt(we.direct,this.authenticatedProvider,this.authenticatedIdentity,p),m=new vt(!0,f);return S.resolve(m)}catch(e){let t=null;return(null==e?void 0:e.message)&&(t=new gt(we.direct,this.authenticatedProvider,this.authenticatedIdentity,{errorMessage:e.message})),S.reject(new vt(!1,t))}}))}}var Ei=function(){function e(t,n,i){s(this,e),this.id=t,this.profile=n,this.preferences=i}return c(e,[{key:"favoriteSports",get:function(){return this.preferences.filter((function(e){return e.metadata.sportId&&!e.metadata.teamId})).map((function(e){return e.metadata}))}},{key:"favoriteTeams",get:function(){return this.preferences.filter((function(e){return e.metadata.teamInfo})).map((function(e){return e.metadata}))}},{key:"fantasyPreferences",get:function(){return this.preferences.filter((function(e){return 9===e.type.id}))}},{key:"isLeagueManager",get:function(){return this.preferences.some((function(e){var t=e.metadata&&e.metadata.entry&&e.metadata.entry;return t&&!0===t.isLeagueManager}))}},{key:"toString",value:function(){return"<Fan id:".concat(this.id,">")}}],[{key:"fromJson",value:function(t){if(!t)return null;var n=Ci.fromJson(t.profile),i=t.preferences.map((function(e){return Di.fromJson(e)}));return new e(t.id,n,i)}}]),e}(),Ci=function(){function e(t,n,i){s(this,e),this.isInsider=t,this.hasNotificationPreferences=n,this.settings=i}return c(e,[{key:"toString",value:function(){return"<FanProfile isInsider:".concat(this.isInsider,", hasNotificationPreferences:").concat(this.hasNotificationPreferences,">")}}],[{key:"fromJson",value:function(t){if(!t)return null;var n=Mi.fromJson(t.settings);return new e(t.isInsider,t.hasNotificationPreferences,n)}}]),e}(),Mi=function(){function e(t){s(this,e),this.videoAutoStart=t}return c(e,null,[{key:"fromJson",value:function(t){return t?new e(Oi.fromJson(t.videoAutoStart)):null}}]),e}(),Oi=function(){function e(t){s(this,e),this.value=t}return c(e,null,[{key:"fromJson",value:function(t){return t?new e(t.value):null}}]),e}(),Di=function(){function e(t,n,i){s(this,e),this.id=t,this.metadata=n,this.type=i}return c(e,null,[{key:"fromJson",value:function(t){if(!t)return null;var n=Li.fromJson(t.metaData||t.metadata),i=Ni.fromJson(t.type);return new e(t.id,n,i)}}]),e}(),Ni=function(){function e(t,n,i){s(this,e),this.id=t,this.name=n,this.code=i}return c(e,null,[{key:"fromJson",value:function(t){return t?new e(t.id,t.name,t.code):null}}]),e}(),Li=function(){function e(t,n,i,r){s(this,e),this.sportId=t,this.teamId=n,this.teamInfo=i,this.entry=r}return c(e,[{key:"uid",get:function(){if(this.teamInfo)return this.teamInfo.uid;var e=null;return this.sportId&&(e="s:".concat(this.sportId),this.teamId&&(e="".concat(e,"~t:").concat(this.teamId))),e}}],[{key:"fromJson",value:function(t){if(!t)return null;var n=null;if(t.teamInfo)n=new Fi(t.teamInfo.uid,t.teamInfo.name,t.teamInfo.fullName,t.teamInfo.logoUrl,t.teamInfo.darkLogoUrl,t.teamInfo.scoreboardLogoUrl,t.teamInfo.scoreboardDarkLogoUrl);else if(t.team){var i=t.team,r=i.coreData.logos.filter((function(e){return-1!==e.rel.indexOf("default")})).map((function(e){return e.href}))[0],a=i.coreData.logos.filter((function(e){return-1!==e.rel.indexOf("dark")&&-1===e.rel.indexOf("scoreboard")})).map((function(e){return e.href}))[0],s=i.coreData.logos.filter((function(e){return-1!==e.rel.indexOf("scoreboard")&&-1===e.rel.indexOf("dark")})).map((function(e){return e.href}))[0],o=i.coreData.logos.filter((function(e){return-1!==e.rel.indexOf("scoreboard")&&-1!==e.rel.indexOf("dark")})).map((function(e){return e.href}))[0];n=new Fi(i.uid,i.name,i.text,r,a||r,s||r,o||a||r)}var c=Ui.fromJson(t.entry);return new e(t.sportId,t.teamId,n,c)}}]),e}(),Ui=function(){function e(t){s(this,e),this.groups=t}return c(e,[{key:"isLeagueManager",get:function(){return this.groups.some((function(e){return!0===e.groupManager}))}}],[{key:"fromJson",value:function(t){return t?new e((t.groups||[]).map((function(e){return ji.fromJson(e)}))):null}}]),e}(),ji=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];s(this,e),this.groupManager=t}return c(e,null,[{key:"fromJson",value:function(t){return t?new e(t.groupManager):null}}]),e}(),Fi=c((function e(t,n,i,r,a,o,c){s(this,e),this.uid=t,this.name=n,this.fullName=i,this.logoUrl=r,this.darkLogoUrl=a,this.scoreboardLogoUrl=o,this.scoreboardDarkLogoUrl=c})),Ri="https://fan.api.espn.com/apis/v2/fans",xi=function(e){return"object"===a(e)&&null!==e&&!Array.isArray(e)},Hi=function(){function e(){s(this,e),this.serviceUrl=Ri}return c(e,[{key:"getFan",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=ie.platform,r=t||{},a=r.headers,s=void 0===a?{}:a,o=this.serviceUrl||Ri,c="".concat(o,"/").concat(encodeURIComponent(e),"?prefType=sports&prefType=teams&prefType=fantasy&coreData=logos"),u={"X-Personalization-Source":"espn-watchsdk-js-".concat(n)};xi(s)&&(u=i(i({},u),s));var l={method:"GET",headers:u};return T(c,l).then((function(e){return e.json()})).then((function(e){return Ei.fromJson(e)}))}}]),e}(),Bi=function(e){function n(){return s(this,n),t(this,n,arguments)}return d(n,e),c(n,null,[{key:"getFan",value:function(e,t){var i=Q.shared.getConfiguration("fanApi",{serviceUrl:Ri}).serviceUrl;n.fanApiServiceUrl_&&(i=n.fanApiServiceUrl_);var r=new Hi;return r.serviceUrl=i,r.getFan(e,t)}}]),n}(Hi);u(Bi,"fanApiServiceUrl_",void 0);localStorage.getItem("FanManager.anonSwid")||T("https://log.espn.com/log?srvc=sz&silent&returnBody=SWID&responseType=JSON").then((function(e){return e.json()})).then((function(e){var t=e.SWID;t&&localStorage.setItem("FanManager.anonSwid",t)}));var zi,Vi=function(){function e(){s(this,e)}return c(e,null,[{key:"swid",get:function(){return localStorage.getItem("FanManager.anonSwid")}}]),e}(),Ki=function(){function e(){s(this,e)}return c(e,null,[{key:"swid",get:function(){return localStorage.getItem("FanManager.swid")||Vi.swid},set:function(e){if(!e)return localStorage.removeItem("FanManager.swid"),void localStorage.removeItem("FanManager.fan");localStorage.setItem("FanManager.swid",e)}},{key:"fan",get:function(){var e=localStorage.getItem("FanManager.fan");try{return Ei.fromJson(JSON.parse(e))}catch(e){return null}}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=localStorage.getItem("FanManager.swid");if(!n)return S.resolve(e.fan);var i=t||{},r=i.getFanOptions;return Bi.getFan(n,r).then((function(e){return localStorage.setItem("FanManager.fan",JSON.stringify(e)),e}))}},{key:"serviceUrl",set:function(e){Bi.fanApiServiceUrl_=e}}]),e}(),Gi=function(){function e(e,t,n,i,r,a,s,o,c){this.id=e,this.name=t,this.adobeId=n,this.tier=i,this.websiteUrl=r,this.images=a,this.rank=s,this.availability=o,this.accessType=c,this.id=e,this.name=t,this.adobeId=n,this.tier=i,this.websiteUrl=r,this.images=a||[],this.rank=s,this.availability=o,this.accessType=c}return e.prototype.getPreferredLogoUrl=function(e){var t=this.images.filter((function(e){return"COLOR_NEGATIVE"===e.type})).map((function(e){return e.type}))[0],n=this.images.filter((function(e){return"BW_NEGATIVE"===e.type})).map((function(e){return e.type}))[0]||t;return n?"https://s.secure.espncdn.com/stitcher/watch/clients/"+e+"-web/providers/"+this.adobeId+".png?height=40&imageType="+n:this.images.filter((function(e){return"DESKTOP"===e.type})).map((function(e){return e.href}))[0]||null},e.prototype.toString=function(){return"<Provider id:"+this.id+", name:"+this.name+", adobeId:"+this.adobeId+">"},e}();!function(e){e.mvpd="mvpd",e.isp="isp",e.tve="tve"}(zi||(zi={}));var qi=zi,$i=function(e){this.serviceUrl=e,this.serviceUrl=e};function Wi(e,t){var n=e.tier||99,i=t.tier||99;if(n<i)return-1;if(n>i)return 1;var r=e.rank||9999,a=t.rank||9999;if(r<a)return-1;if(r>a)return 1;var s=e.name.toLowerCase(),o=t.name.toLowerCase();return s<o?-1:s>o?1:0}var Ji={negativebgcolorImage:"COLOR_NEGATIVE",negativebgbwImage:"BW_NEGATIVE",positivebgcolorImage:"COLOR_POSITIVE",positivebgbwImage:"BW_POSITIVE",desktop:"DESKTOP"};function Yi(e,t){if(!e)return null;var n=e.id,i=e.name,r=e.websiteUrl,a=e.adobeId,s=e.logos,o=e.accessType,c=function(e){return Object.keys(e).filter((function(t){return Ji[t]&&!!e[t]})).map((function(t){return{href:e[t].trim(),type:Ji[t]}}))}(s),u=e.countries.filter((function(e){return e.countryCode.toLowerCase()===t.toLowerCase()}))[0],l=u&&u.tier,d=u&&u.rank;return new Gi(n,i,a,l,r,c,d,null,o)}function Qi(e,t){return e.rows?e.rows.map((function(e){return Yi(e.data,t)})).sort(Wi):[Yi(e,t)]}var Xi={};Xi[qi.mvpd]="adobeId",Xi[qi.isp]="ispId",Xi[qi.tve]="id";var Zi,er=new $i("https://affiliate.api.espn.com/affiliateApi/affiliates?includeProperties=true&rows=1000&apikey=q458c7hcllto16w0wcjytqoxq"),tr=function(){function e(e){this.locationProvider=e||{getCountryCode:function(){return"us"}},this.applicationId=null,this.configuration=er}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"applicationId",{get:function(){return this.applicationId_},set:function(e){this.applicationId_=e},enumerable:!0,configurable:!0}),e.prototype.getProvider=function(e,t,n){return void 0===n&&(n={}),C(this,void 0,void 0,(function(){var i,r,a,s;return M(this,(function(o){switch(o.label){case 0:return i=t||qi.mvpd,r=Xi[i]||"adobeId",n[r]=e,[4,this.getProviders(n)];case 1:if(a=o.sent(),!(s=a[0]))throw new Error("Unable to find provider.");return[2,s]}}))}))},e.prototype.getProviders=function(e){return void 0===e&&(e={}),C(this,void 0,void 0,(function(){var t,n,i,r,a,s,o;return M(this,(function(c){switch(c.label){case 0:t=this.configuration.serviceUrl,n=-1===t.indexOf("?")?"?":"&",i=this.applicationId,r=function(e){return-1!==["PR","GU","VI"].indexOf(e)?"US":e}(this.locationProvider.getCountryCode().toUpperCase()),e.country=r,i&&(e.application=i),a=Object.keys(e).map((function(t){if("id"!==t)return t+"="+encodeURIComponent(e[t])})).join("&"),s=""+t+n+a,e.id&&(o=t.split("?"),s=o[0]+"/"+e.id+"?"+o[1]),c.label=1;case 1:return c.trys.push([1,4,,5]),[4,T(s)];case 2:return[4,c.sent().json()];case 3:return[2,Qi(c.sent(),r)];case 4:return c.sent(),[2,[]];case 5:return[2]}}))}))},e.defaultConfiguration=er,e}(),nr=function(){function e(){s(this,e)}return c(e,[{key:"getCountryCode",value:function(){}}]),e}(),ir=function(e){function n(){return s(this,n),t(this,n,arguments)}return d(n,e),c(n,[{key:"getCountryCode",value:function(){return"us"}}]),n}(nr),rr=function(e){function n(e){return s(this,n),t(this,n,[e||new ir])}return d(n,e),c(n,[{key:"configuration",get:function(){var e=Q.shared.getConfiguration("provider",i({applicationKeyMap:{}},tr.defaultConfiguration));return P.debug("ESPNAffiliateAPI.getConfiguration ".concat(JSON.stringify(e))),e},set:function(e){g(h(n.prototype),"configuration",e,this,!0)}},{key:"applicationId",get:function(){var e=function(e){return"US"===e||"GU"===e||"PR"===e||"VI"===e}(this.locationProvider.getCountryCode().toUpperCase())&&"web"===ie.platform?"".concat(ie.partner,"_").concat(ie.platform):"".concat(ie.platform),t=this.configuration.applicationKeyMap||{};return t[e]&&(e=t[e]),P.debug("ESPNAffiliateAPI.getApplicationId ".concat(e)),e},set:function(e){g(h(n.prototype),"applicationId",e,this,!0)}}]),n}(tr),ar=function(){function e(){s(this,e)}return c(e,null,[{key:"getBuilder",value:function(){var e=Q.shared.getConfiguration("adobeCM",Z);if(!1===e.enabled)return null;var t=ie.platform,n=e.applications&&e.applications[t],i=e.applicationId||n&&n.applicationId,r=u(u(u(u(u({},R,i),x,t),H,""),B,"false"),z,"ESPN");return new gn("ESPN",i,r).withServiceUrl(e.serviceUrl).withMessages(e.messages||{})}}]),e}();!function(e){e[e.all=0]="all",e[e.linearPlayback=1]="linearPlayback"}(Zi||(Zi={}));var sr,or=Zi;!function(e){e.linear="linear",e.event="event"}(sr||(sr={}));var cr,ur=sr;!function(e){e.stitchedPreroll="stitchedPreroll"}(cr||(cr={}));var lr,dr=cr;!function(e){e.live="live",e.onDemand="onDemand"}(lr||(lr={}));var hr,pr=lr;!function(e){e.nielsen="nielsen",e.comscore="comscore",e.conviva="conviva",e.heartbeats="heartbeats"}(hr||(hr={}));var fr,mr=hr;!function(e){e.shortform="shortform",e.longform="longform"}(fr||(fr={}));var yr,gr=fr;!function(e){e.audio="audio",e.video="video"}(yr||(yr={}));var vr,br=yr;!function(e){e.pluto="pluto",e.graphQL="graphQL",e.cfa="cfa",e.itemFeed="itemFeed"}(vr||(vr={}));var _r,wr=vr;!function(e){e.open="OPEN",e.direct="DIRECT",e.mvpd="MVPD",e.isp="ISP",e.none="NONE"}(_r||(_r={}));var Pr,Ir=_r;!function(e){e.none="none",e.startSession="startSession",e.bam="bam",e.shield="shield",e.entitlement="entitlement"}(Pr||(Pr={}));var Sr=Pr,Tr=function(){function e(e,t,n,i,r,a,s,o){this.url=e,this.type=t,this.hasEspnId3Heartbeats=n,this.hasNielsenWatermarks=i,this.hasPassThroughAds=r,this.commercialReplacement=a,this.startSessionUrl=s,this.variant=o}return e.fromObject=function(t){if(!t)return null;var n=t.url,i=t.type,r=t.hasEspnId3Heartbeats,a=t.hasNielsenWatermarks,s=t.hasPassThroughAds,o=t.commercialReplacement,c=t.startSessionUrl,u=t.variant;return new e(n,Sr[i],r,a,s,o,c,u)},e}(),Ar=function(){function e(e,t,n,i){this.id=e,this.type=t,this.name=n,this.resource=i}return e.fromObject=function(t){if(!t)return null;var n=ur[t.type];return new e(t.id,n,t.name,t.resource)},e}(),kr=function(){function e(e){this.url=e}return e.fromObject=function(t){return t&&t.url?new e(t.url):null},e}(),Er=function(){function e(e){this.name=e}return Object.defineProperty(e.prototype,"logoUrl",{get:function(){return"https://secure.espncdn.com/watchespn/images/espnplus/packages/"+this.name+".png"},enumerable:!1,configurable:!0}),e.fromObject=function(t){return t?new e(t.name):null},e}(),Cr=function(){function e(e,t,n,i,r){this.id=e,this.title=t,this.duration=n,this.language=i||"en",this.source=r,this.description=null,this.authenticationTypes=[],this.mrss=null,this.seekInSeconds=null,this.tracking={},this.references={},this.network=null,this.streamType=null,this.supportedMediaCommands=or.all,this.images=[],this.type=br.video,this.packages=[],this.tier=null,this.entityType=null,this.isSyndicatable=null,this.brand=null,this.apiSource=null,this.adUnitId=null,this.cues=null,this.adTarget=null,this.show=null}return Object.defineProperty(e.prototype,"isLinear",{get:function(){return!!this.network&&this.network.type===ur.linear},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLive",{get:function(){return this.streamType===pr.live},enumerable:!1,configurable:!0}),e.fromObject=function(t){var n=Tr.fromObject(t.source),i=new e(t.id,t.title,t.duration,t.language,n);return i.airDate=t.airDate,i.apiSource=t.apiSource,i.authenticationTypes=t.authenticationTypes,i.description=t.description,i.images=(t.images||[]).map((function(e){return kr.fromObject(e)})),i.mrss=t.mrss,i.network=Ar.fromObject(t.network),i.seekInSeconds=t.seekInSeconds,i.streamType=pr[t.streamType],i.supportedMediaCommands=t.supportedMediaCommands,i.tracking=t.tracking,i.references=t.references,i.packages=(t.packages||[]).map((function(e){return Er.fromObject(e)})),i.tier=t.tier,i.type=br[t.type],i.entityType=gr[t.entityType],i.isSyndicatable=t.isSyndicatable,i.brand=t.brand,i.adUnitId=t.adUnitId,i.cues=t.cues,i.show=t.show,i.adTarget=t.adTarget,i.availableDate=t.availableDate,i.episodeNumber=t.episodeNumber,i.locale=t.locale,i.seasonNumber=t.seasonNumber,i.tmsid=t.tmsid,i.videoShowGenre=t.videoShowGenre,i},e.prototype.toString=function(){return"<MediaItem id:"+this.id+", title:"+this.title+", streamType:"+this.streamType+">"},e}();var Mr,Or=function(){function e(e){var t=function(e){var t=e.split("?")[1],n={};if(t)for(var i=t.split("&"),r=0;r<i.length;r+=1){var a=i[r].split("=");n[a[0]]=a[1]}return n}(e);if(this.original=e,this.id=t.videoID||t.playID||t.clip||t.externalId,e.match("sportscenter")){this.gameId=t.playGameID,this.channel=t.playChannel,this.simulcastAiringId=t.simulcastAiringId;var n=parseInt(t.resumeTime,10);isNaN(n)||(this.resumeTime=n),this.eventId=t.eventId}else e.match("abcnews")&&(this.channel=t.playChannel,this.id=t.videoID||t.id);this.source=t["x-source"],t.videoID?this.entityType=gr.shortform:this.entityType=gr.longform,this.type=br.video}return e.prototype.toString=function(e){return e==wr.graphQL?"<MediaItemIdentifier id:"+this.id+", gameId:"+this.gameId+", channel:"+this.channel+", source:"+this.source+">":"<MediaItemIdentifier id:"+this.id+", source:"+this.source+">"},e.identifierStringForNetwork=function(e,t){switch(t){case wr.cfa:return"natgeo://playVideo?videoID="+e;case wr.itemFeed:return"abcnews://playVideo?playChannel="+e;case wr.graphQL:default:return"sportscenter://x-callback-url/showWatchStream?playChannel="+e}},e}();function Dr(e,t,n,i){if(!t)return{};var r,a,s,o=null;e===Mr.natGeo?o=function(e){if(!e)return{};var t={},n=e.id,i=e.title,r=e.duration;return t.c_video_id_code=n,t.c_a_media_airdate="unknown",t.c_a_media_daypart="daytime",t.c_a_media_digitaldate="unknown",t.c_a_media_episode="none",t.c_a_media_feed="natgeo live",t.c_a_media_format="vod",t.c_a_media_genre="none",t.c_a_media_network="natgeo",t.c_a_media_originator="natgeo",t.c_a_media_pass_auth="none",t.c_a_media_pass_mvpd="none",t.c_a_media_rating="none",t.c_a_media_season="none",t.c_a_media_show=i,t.c_a_media_streamtype=yr.video,t.c_a_media_length=r,t}(t):(r=function(e,t,n){if(!e)return{};var i=e.duration,r=e.id,a=e.league,s=e.name,o=e.network,c=e.program,u=e.sport,l=e.startDateTime,d=e.tracking,h="1";n&&!0===n.hasEspnId3Heartbeats&&!1===n.hasPassThroughAds&&"SHARED INV"!==n.commercialReplacement&&(h="2");var p={type:"content"};if(p.assetid=d&&d.trackingId||r,p.program=s,p.title=s,p.clientid="us-600140",t===gr.longform){if(p.length=""+i,p.segB=a&&a.name||"No League",p.segC=""+(c&&c.code||"")+(u&&u.code||""),l){var f=new Date(l);p.airdate=f.getUTCFullYear().toString()+("0"+f.getUTCMonth()).slice(-2)+("0"+f.getUTCDate()).slice(-2)+" "+("0"+f.getUTCHours()).slice(-2)+":"+("0"+f.getUTCMinutes()).slice(-2)+":"+("0"+f.getUTCSeconds()).slice(-2)}p.isfullepisode="y",p.crossId1=d&&d.nielsenCrossId1||"",p.crossId2=o&&o.name||"",p.adloadtype=h,p.hasAds="1",p.progen="SE",p.vcid="b01"}return t===gr.shortform&&(p.accmethod="1",p.length=""+i,p.segA=s,p.segB="No League",p.segC="VOD",p.isfullepisode="n",p.crossId1="",p.adloadtype="1",p.vcid="c17",p.adloadtype="2"),p}(t,n,i),a=function(e,t){if(!e)return{};var n=e.id,i=e.duration,r=e.name,a=e.league,s=e.startDateTime,o=e.network,c=e.sport,u=e.status,l=e.tracking,d={};if(t===gr.longform)d.ns_st_cl=0,d.ns_st_ct="vc",!u||"live"!==u.toLowerCase()&&"over"!==u.toLowerCase()?(d.ns_st_cl=i,d.ns_st_ct="vc12",d.ns_st_pr="VOD",d.ns_st_ep=r):(d.ns_st_cl=0,d.ns_st_ct="vc13",d.ns_st_pr=r,d.ns_st_ep="*null"),d.c3="WATCHESPNLIVE",d.c6=a&&a.name?a||"No league":c&&c.code||"No Sport";else{d.ns_st_cl=i,d.ns_st_ct="vc11",d.ns_st_pr="VOD",d.ns_st_ep=r;var h=l||{},p=h.sportName,f=h.leagueName;d.c3="vod",d.c6=""+(f&&"no league"!==f.toLowerCase()?f:p||"No Sport")}if(d.ns_st_ti="*null",d.ns_st_ia="*null",d.ns_st_ce="*null",d.ns_st_ci=n,s){var m=new Date(s);d.ns_st_ddt=m.toDateString(),d.ns_st_tdt=m.toDateString()}return d.ns_st_st=o?o.id:"*null",d.ns_st_en="*null",d.ns_st_cn="1",d.ns_st_pn="1",d.ns_st_tp="1",d.ns_st_pu="ESPN",d.ns_st_cu="none",d.ns_st_ad="0",d.ns_st_ge="Sports",d}(t,n),s=function(e,t,n){if(!e)return{};var i=e.name,r=e.id,a=e.airingId,s=e.eventId,o=e.duration,c=e.network,u=e.status,l=e.sport,d=e.league,h={};h.contentId=r,a&&(h.airingId=a),s&&(h.eventId=""+s,h.eventName=i),c&&(h.network=c.id),t===gr.shortform?h.assetType="clip":!u||"live"!==u.toLowerCase()&&"over"!==u.toLowerCase()?h.assetType="vod":h.assetType="live";var p=i+" - "+r;return c&&c.type===ur.linear&&"live"===h.assetType&&(p=c.id),h.sport=l&&l.name||"Not Applicable",h.league=d&&d.name||"Not Applicable",h.appBrand=Mr.espn,{assetName:p,duration:o,streamUrl:n&&n.url,custom:h}}(t,n,i),o=function(e,t){if(!e)return{};var n=e.duration,i=e.airingId,r=e.network,a=e.status,s=e.sport,o=e.league,c=e.name,u=e.program,l=e.startDateTime,d=e.tracking,h=e.originalPublishDate,p=e.expirationDate,f=e.lastModifiedDate,m=e.ad,y=e.coverageType,g=e.brands,v={};if(v.ContentDuration=n,t===gr.longform){if(v.CMSID=d&&d.name||c,v.isFullEpisode="y",i&&(v.AiringID=i),r&&(v.NetworkName=r.id,v.Channel=r.id),a&&(v.VideoType="REPLAY"===a?"replay":"live"),v.Sport=s&&s.name||"Not Applicable",v.SportCode=s&&s.code||"Not Applicable",v.League=o&&o.name||"Not Applicable",u&&u.code&&u.categoryCode?v.ProgramCode=u.categoryCode+u.code:v.ProgramCode="Not Applicable",v.IsStudio=u&&u.isStudio||"Not Applicable",l){var b=new Date(l);v.AirDate=b.toDateString(),v.AirTime=b.toTimeString()}if(Array.isArray(g)&&g.length){var _=g[0],w=_.id,P=_.name,I=_.type;v["a.media.asset"]=w,v["a.media.show"]=P,v["a.media.genre"]=I}}else if(t===gr.shortform){if(v.isFullEpisode="n",v.VideoType="vod",v.Sport=d&&d.sportName||"Not Applicable",v.League=d&&d.leagueName||"Not Applicable",v.ShowCode=m&&m.bundle||"Not Applicable",d&&d.name&&(v.CMSID=d.name),h){b=new Date(h);v.PublishDate=b.toISOString().substring(0,10),v.PublishTime=b.toISOString().substring(11)}if(p){b=new Date(p);v.ExpirationDate=b.toISOString()}if(f){b=new Date(f);v.DateLastModified=b.toISOString()}y&&(v.VideoTypeDetail=y)}return v}(t,n));var c={};return c[mr.nielsen]=r,c[mr.comscore]=a,c[mr.conviva]=s,c[mr.heartbeats]=o,c}function Nr(e,t,n){return e.sort((function(e,t){var n="PRIMARY"===e.tier?0:"SECONDARY"===e.tier?1:2,i="PRIMARY"===t.tier?0:"SECONDARY"===t.tier?1:2;return n<i?-1:n>i?1:0})).sort((function(e,n){var i=e.network&&e.network.id.toLowerCase()||"unknown",r=n.network&&n.network.id.toLowerCase()||"unknown",a=t.indexOf(i),s=t.indexOf(r);return-1===a&&(a=999),-1===s&&(s=999),a<s?-1:a>s?1:0})).sort((function(e,t){var i=e.language===n?0:1,r=t.language===n?0:1;return i<r?-1:i<r?1:0}))}!function(e){e.abc="abc",e.abcNews="abcnews",e.abcNewsLive="abcnewslive",e.abcOtv="abcotv",e.cricinfo="cricinfo",e.disney="dch",e.disneyJr="djr",e.disneyXD="dxd",e.disneyNow="dnow",e.espn="espn",e.espnFantasy="espnFantasy",e.fiveThirtyEight="fivethirtyeight",e.foxLatam="foxlatam",e.freeform="ff",e.fxNow="fxnow",e.fx="fx",e.fxm="fxm",e.fxx="fxx",e.oscar="oscar",e.marvel="marvel",e.natGeoTV="ngtv",e.natGeo="ngc",e.natGeoWild="ngw",e.natgeoBrasil="natgeobrasil",e.theUndefeated="theundefeated",e.unknown="000"}(Mr||(Mr={}));var Lr=["espn_ppv","espn_dtc","espn1","espn2","espn3","espnu","sec","espnews","espndeportes","longhorn","goalline","buzzerbeater","secplus","acc","accextra","espn_free","bam_dtc"],Ur=function(e,t,n,i){e==wr.graphQL?(this.serviceUrl=t||"https://watch.graph.api.espn.com/api",this.apiKey=n||"d15c5790-7cb0-4fe1-8782-25f4698d0739",this.networkSortOrder=i||Lr):e==wr.cfa?this.serviceUrl=t||"https://natgeo.entertainment.client.dtci.technology/v1/playback/video/id/mock":e===wr.itemFeed&&(this.serviceUrl=t||"https://abcnews.go.com/video/itemfeed")},jr=function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return M(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var r,a,s,o,c,u;return M(this,(function(l){switch(l.label){case 0:return r=t.map((function(e){return new Or(e)})),a=i.serviceUrl,s=i.apiKey,o=i.networkSortOrder,[4,S.all(r.map((function(t){return e.getPromiseMediaItems(t,a,s,n)})))];case 1:return c=l.sent(),(u=c.filter((function(e){return!(e instanceof Error)&&e instanceof Cr}))).length?[2,Nr(u,o,navigator.language)]:[2,null]}}))}))},e.getPromiseMediaItems=function(t,n,i,r){return C(this,void 0,void 0,(function(){var a,s,o,c,u,l,d,h,p,f,m,y;return M(this,(function(g){switch(g.label){case 0:a=function(e,t,n,i){var r="",a="",s="",o=i||"US";return e.entityType===gr.shortform?(r="VOD",s="{id name description authTypes language duration originalPublishDate expirationDate requiresLinearPlayback lastModifiedDate source { url authorizationType } image { url } tracking { name sportName leagueName } coverageType prerollSource:source(variant:PREROLL) { url authorizationType }ad { sport bundle } links { web } cerebroId syndicatable}",a='id:"'+e.id+'"'):(r="airing",s="{ id name description mrss:adobeRSS authTypes requiresLinearPlayback status:type startDateTime endDateTime duration source(authorization: SHIELD) { url authorizationType hasEspnId3Heartbeats hasNielsenWatermarks hasPassThroughAds commercialReplacement startSessionUrl } network { id type name adobeResource } image { url } sport { name code uid } league { name uid } program { code categoryCode isStudio } seekInSeconds simulcastAiringId airingId tracking { nielsenCrossId1 trackingId } eventId packages { name } language tier feedName brands { id name type } }",e.id?a='id:"'+e.id+'"':e.channel?(r="airings",a='networks:["'+e.channel+'"],type:LIVE'):e.gameId&&(r="airings",a='eventId:"'+(e.eventId||e.gameId)+'"')),t+"?apiKey="+n+"&query="+encodeURIComponent("{ "+r+"("+a+',countryCode:"'+o+'",deviceType:SETTOP,tz:"Z") '+s+" }")}(t,n,i,r.countryCode),g.label=1;case 1:return g.trys.push([1,4,,5]),[4,T(a)];case 2:return[4,g.sent().json()];case 3:if(s=g.sent(),o=s.data.airing,(c=s.data.airings)&&(u=t.simulcastAiringId?function(e){return e.simulcastAiringId===t.simulcastAiringId}:function(){return!0},o=c.filter(u)[0]),l=s.data.VOD,!(d=o||l))throw new Error("No results found.");if(h=function(e,t,n){var i=e.id,r=e.name,a=e.description,s=e.duration,o=e.image,c=e.eventId,u=e.requiresLinearPlayback,l=e.authTypes,d=e.source,h=e.prerollSource,p=e.packages,f=e.language,m=e.mrss,y=e.seekInSeconds,g=e.tracking,v=e.simulcastAiringId,b=e.network,_=e.status,w=e.cerebroId,P=e.syndicatable,I=_&&("LIVE"===_.toUpperCase()||"OVER"===_.toUpperCase())?pr.live:pr.onDemand,S=function(e){switch(e){case"NONE":return Sr.none;case"START_SESSION":return Sr.startSession;case"BAM":return Sr.bam;case"SHIELD":return Sr.shield}}(d.authorizationType),T=new Tr(d.url,S,d.hasEspnId3Heartbeats,d.hasNielsenWatermarks,d.hasPassThroughAds,d.commercialReplacement,d.startSessionUrl);n&&n.sourceVariant===dr.stitchedPreroll&&h&&((T=new Tr(h.url,Sr.none)).variant=dr.stitchedPreroll);var A=u?or.linearPlayback:or.all,k=g&&g.trackingId||i,E=new Cr(i,r,s,f,T);if(E.authenticationTypes=l.map((function(e){switch(e){case"DIRECT":return Ir.direct;case"OPEN":return Ir.open;case"MVPD":return Ir.mvpd;case"ISP":return Ir.isp;default:return Ir.none}})),E.description=a,E.isSyndicatable=P,o&&o.url&&E.images.push(new kr(o.url)),E.mrss=m,b){var C="linear"===b.type?ur.linear:ur.event;E.network=new Ar(b.id,C,b.name,b.adobeResource)}return E.seekInSeconds=y,E.streamType=I,E.supportedMediaCommands=A,E.brand=E.brand?E.brand:"espn",E.tracking=Dr(E.brand,e,t,T),E.references={eventId:c,simulcastAiringId:v,trackingId:k,cerebroId:w},E.type=br.video,E.entityType=t,E.apiSource=wr.graphQL,E.packages=(p||[]).map((function(e){return new Er(e.name)})),E}(d,t.entityType,r),t.resumeTime&&(h.seekInSeconds=t.resumeTime),!h.source.url){if(p="OVER"===d.status.toUpperCase(),f=d.network&&d.network.type===ur.linear,m=d.network&&d.network.id,p&&f&&m)return[2,e.retryGetMediaItems(m,n,i,r)];throw new Error("No playable url")}return[2,h];case 4:return y=g.sent(),P.warn("Failed to retrieve MediaItem from GraphQL: "+y),[2,null];case 5:return[2]}}))}))},e.retryGetMediaItems=function(t,n,i,r){return C(this,void 0,void 0,(function(){var a,s,o,c;return M(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),a=Or.identifierStringForNetwork(t,wr.graphQL),s=new Or(a),[4,e.getPromiseMediaItems(s,n,i,r)];case 1:if((o=u.sent())&&o instanceof Cr==!0)return[2,o];throw new Error("Retry fetchMediaItems failed with "+t);case 2:return c=u.sent(),P.warn("MediaItem is over and retry failed: "+c),[2,null];case 3:return[2]}}))}))},e.defaultConfiguration=new Ur(wr.graphQL),e}();var Fr=function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return M(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var n,r;return M(this,(function(a){switch(a.label){case 0:return n=t.map((function(e){return new Or(e)})),r=i.serviceUrl,[4,S.all(n.map((function(t){return e.getPromiseMediaItem(t,r)})))];case 1:return[2,a.sent().filter((function(e){return!(e instanceof Error)&&e instanceof Cr}))]}}))}))},e.getPromiseMediaItem=function(e,t){return C(this,void 0,void 0,(function(){var n,i,r;return M(this,(function(a){switch(a.label){case 0:n=t.replace("videoID",e.id),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,T(n)];case 2:return[4,a.sent().json()];case 3:return i=a.sent(),[2,function(e){var t=e.id,n=e.title,i=e.description,r=e.duration,a=e.source,s=e.type,o=e.entityType,c=e.streamType,u=e.authenticationTypes,l=e.language,d=e.network,h=e.brand,p=e.images,f=o,m=a.type,y=new Tr(a.url,m),g=new Cr(t,n,r,l,y);return g.authenticationTypes=u.map((function(e){switch(e){case"DIRECT":return Ir.direct;case"OPEN":return Ir.open;case"MVPD":return Ir.mvpd;case"ISP":return Ir.isp;default:return Ir.none}})),g.description=i,d&&(g.network=new Ar(d.id,d.type,d.name,d.resource)),g.streamType=c,g.brand=h,g.tracking=Dr(g.brand,e,f,y),g.images=p,g.type=s,g.entityType=f,g.apiSource=wr.cfa,g}(i)];case 4:return r=a.sent(),P.warn("Failed to retrieve MediaItem from CFA: "+r),[2,null];case 5:return[2]}}))}))},e.defaultConfiguration=new Ur(wr.cfa),e}(),Rr=Object.freeze({}),xr=Object.freeze({}),Hr=wr.itemFeed,Br={lf:"longform",sf:"shortform",live:"longform"},zr={"abcn:fivethirtyeight":"fivethirtyeight",abcn:"abcnews"},Vr={name:"abc_news_live",type:"linear"},Kr=["HLS_ALL","PDL_MED","PDL_LOW"];function Gr(e){var t,n,i,r=(e||Rr).channel||Rr,a=r.item||Rr,s=a["media-group"]||Rr,o=s["media-content"]||xr,c=s["media-title"],u=(function(e){for(var t,n,i=Kr.length,r=e.length,a=0;a<i;a++)for(var s=Kr[a],o=0;o<r;o++){var c=e[o];if((null===(n=null===(t=null==c?void 0:c["media-category"])||void 0===t?void 0:t["@attributes"])||void 0===n?void 0:n.label)===s)return c}}(o)||Rr)["@attributes"]||Rr,l=(s["media-thumbnail"]||Rr)["@attributes"]||Rr,d=a.guid,h=a.title,p=a.temporalType,f=a.timestamp,m=a.link,y=u.duration,g=u.url,v=u.medium,b=(a.omniture||Rr).channel||"",_=O(String(b).split(":"),1)[0],w=zr[b]||zr[void 0===_?"abcn":_]||"abcnews",P="vod"===p,I="live"===p,S=Br[a.videoContentType]||(P?"shortform":"longform"),T=c||h,A=r.language||"en";try{n=(t=O(new Date(f).toISOString().split("T"),2))[0],i=t[1]}catch(e){console.warn(e)}var k="akamai live stream"!==a.mediatype||P?{}:E(E({},Vr),{id:d}),C={id:d,apiSource:Hr,seasonNumber:"none",eventId:"none",episodeNumber:"none",genre:"news",tvrating:"none",network:k,show:{title:T},title:T,duration:y,language:A,source:{url:g,type:"none"},description:a.description||s["media-description"],authenticationTypes:["NONE"],mrss:null,seekInSeconds:null,brand:w,type:"video"===v?"video":"audio",entityType:S,streamType:I?"live":"onDemand",images:l?[{url:l.url}]:null,airDate:a.timestamp,availableDate:a.pubDate,references:{itemfeed:d},tracking:{omniture:a.omniture,nielsen:{type:"content",assetid:d,program:T,title:T},conviva:{assetName:h,duration:y,streamURL:g,custom:{contentId:d,assetType:P?"clip":"live",sport:"none",league:"none",appBrand:a.category||"abcnews"}},heartbeats:{ContentDuration:y,isFullEpisode:"shortform"===S||I?"n":"y",VideoType:p,CMSID:T,PublishDate:n,PublishTime:i}},webHref:m};return Cr.fromObject(C)}var qr,$r=w((function(e,t){function n(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function i(e,t){return t.encode?t.strict?encodeURIComponent(e).replace(/[!'()*]/g,e=>"%"+e.charCodeAt(0).toString(16).toUpperCase()):encodeURIComponent(e):e}function r(e,t){return t.decode?Ze(e):e}function a(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function s(e){const t=(e=a(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function o(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function c(e,t){n((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const i=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,i)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===i[e]&&(i[e]={}),i[e][t[1]]=n):i[e]=n};case"bracket":return(e,n,i)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==i[e]?i[e]=[].concat(i[e],n):i[e]=[n]:i[e]=n};case"comma":case"separator":return(t,n,i)=>{const a="string"==typeof n&&n.includes(e.arrayFormatSeparator),s="string"==typeof n&&!a&&r(n,e).includes(e.arrayFormatSeparator);n=s?r(n,e):n;const o=a||s?n.split(e.arrayFormatSeparator).map(t=>r(t,e)):null===n?n:r(n,e);i[t]=o};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),a=Object.create(null);if("string"!=typeof e)return a;if(!(e=e.trim().replace(/^[?#&]/,"")))return a;for(const n of e.split("&")){if(""===n)continue;let[e,s]=et(t.decode?n.replace(/\+/g," "):n,"=");s=void 0===s?null:["comma","separator"].includes(t.arrayFormat)?s:r(s,t),i(r(e,t),s,a)}for(const e of Object.keys(a)){const n=a[e];if("object"==typeof n&&null!==n)for(const e of Object.keys(n))n[e]=o(n[e],t);else a[e]=o(n,t)}return!1===t.sort?a:(!0===t.sort?Object.keys(a).sort():Object.keys(a).sort(t.sort)).reduce((e,t)=>{const n=a[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((e,t)=>Number(e)-Number(t)).map(e=>t[e]):t}(n):e[t]=n,e},Object.create(null))}t.extract=s,t.parse=c,t.stringify=(e,t)=>{if(!e)return"";n((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const r=n=>t.skipNull&&null==e[n]||t.skipEmptyString&&""===e[n],a=function(e){switch(e.arrayFormat){case"index":return t=>(n,r)=>{const a=n.length;return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[i(t,e),"[",a,"]"].join("")]:[...n,[i(t,e),"[",i(a,e),"]=",i(r,e)].join("")]};case"bracket":return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[i(t,e),"[]"].join("")]:[...n,[i(t,e),"[]=",i(r,e)].join("")];case"comma":case"separator":return t=>(n,r)=>null==r||0===r.length?n:0===n.length?[[i(t,e),"=",i(r,e)].join("")]:[[n,i(r,e)].join(e.arrayFormatSeparator)];default:return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,i(t,e)]:[...n,[i(t,e),"=",i(r,e)].join("")]}}(t),s={};for(const t of Object.keys(e))r(t)||(s[t]=e[t]);const o=Object.keys(s);return!1!==t.sort&&o.sort(t.sort),o.map(n=>{const r=e[n];return void 0===r?"":null===r?i(n,t):Array.isArray(r)?r.reduce(a(n),[]).join("&"):i(n,t)+"="+i(r,t)}).filter(e=>e.length>0).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[n,i]=et(e,"#");return Object.assign({url:n.split("?")[0]||"",query:c(s(e),t)},t&&t.parseFragmentIdentifier&&i?{fragmentIdentifier:r(i,t)}:{})},t.stringifyUrl=(e,n)=>{n=Object.assign({encode:!0,strict:!0},n);const r=a(e.url).split("?")[0]||"",s=t.extract(e.url),o=t.parse(s,{sort:!1}),c=Object.assign(o,e.query);let u=t.stringify(c,n);u&&(u="?"+u);let l=function(e){let t="";const n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);return e.fragmentIdentifier&&(l="#"+i(e.fragmentIdentifier,n)),`${r}${u}${l}`},t.pick=(e,n,i)=>{i=Object.assign({parseFragmentIdentifier:!0},i);const{url:r,query:a,fragmentIdentifier:s}=t.parseUrl(e,i);return t.stringifyUrl({url:r,query:tt(a,n),fragmentIdentifier:s},i)},t.exclude=(e,n,i)=>{const r=Array.isArray(n)?e=>!n.includes(e):(e,t)=>!n(e,t);return t.pick(e,r,i)}})),Wr=($r.extract,$r.parse,$r.stringify,$r.parseUrl,$r.stringifyUrl,$r.pick,$r.exclude,function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return M(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var n,r;return M(this,(function(a){switch(a.label){case 0:return n=t.map((function(e){return new Or(e)})),r=i.serviceUrl,[4,S.all(n.map((function(t){return e.getPromiseMediaItem(t,r)})))];case 1:return[2,a.sent().filter((function(e){return!(e instanceof Error)&&e instanceof Cr}))]}}))}))},e.getPromiseMediaItem=function(e,t){return C(this,void 0,void 0,(function(){var n,i,r;return M(this,(function(a){switch(a.label){case 0:n=$r.stringify({id:e.id||e.channel}),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,T(t+"?"+n+"&requester=guardians")];case 2:return[4,a.sent().json()];case 3:return i=a.sent(),[2,Gr(i)];case 4:return r=a.sent(),P.warn("Failed to retrieve MediaItem from ItemFeed endpoint: "+r),[2,null];case 5:return[2]}}))}))},e.defaultConfiguration=new Ur(wr.itemFeed),e}());!function(){function e(){}Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(e,t){return C(this,void 0,void 0,(function(){var n,i=this;return M(this,(function(r){switch(r.label){case 0:return n=t||{sourceVariant:null},[4,S.all(e.map((function(e){return C(i,void 0,void 0,(function(){var t,i,r,a;return M(this,(function(s){switch(s.label){case 0:t=e.match("natgeo")?Fr:e.match("abcnews")?Wr:jr,(r=new t).configuration=this.configuration||r.configuration,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,r.getMediaItems([e],n)];case 2:return a=s.sent(),i=null==a?void 0:a[0],[3,4];case 3:return s.sent(),[3,4];case 4:return[2,i]}}))}))})))];case 1:return[2,r.sent()]}}))}))}}();!function(e){e.localStorage="LOCAL_STORAGE",e.sessionStorage="SESSION_STORAGE"}(qr||(qr={}));var Jr,Yr=qr,Qr=function(){function e(e,t,n,i){this.id=e,this.name=t,this.logoUrl=n,this.websiteUrl=i}return e.prototype.toString=function(){return"<AuthenticatedProvider id:"+this.id+", name:"+this.name+", logoUrl:"+this.logoUrl+", websiteUrl:"+this.websiteUrl+">"},e.fromObject=function(t){return new e(t.id,t.name,t.logoUrl,t.websiteUrl)},e}();!function(e){e.token="token",e.tokenType="tokenType",e.resource="resource",e.requestor="requestor",e.fullToken="fullToken",e.zipcode="zipcode",e.mvpd="mvpd"}(Jr||(Jr={}));var Xr,Zr,ea=function(){function e(e,t,n,i){void 0===i&&(i={}),this.authenticationType=e,this.authenticatedProvider=t,this.authenticatedIdentity=n,this.customData=i}return e.CustomDataKey=Jr,e}(),ta=function(e,t){this.success=e,this.payload=t};!function(e){e.standard="default",e.googleAdManager="gam"}(Xr||(Xr={})),function(e){e.standard="default",e.prod="prod",e.development="dev"}(Zr||(Zr={}));Object.freeze({}),Object.freeze("");var na,ia=function(e,t){t.setItem("watchsdk.isp_authenticator.state",JSON.stringify(e))},ra=new function(e){this.userDataServiceUrl=e}("https://broadband.espn.com/espn3/auth/watchespn/user"),aa=function(){function e(e,t,n){switch(this.partner=e,this.platform=t,this.providerDataSource=null,this.configuration=ra,n){case Yr.localStorage:this.storage=localStorage;break;case Yr.sessionStorage:this.storage=sessionStorage;break;default:this.storage=localStorage}this.state_={};try{var i=this.storage.getItem("watchsdk.isp_authenticator.state");i||(i=function(e){var t="true"===e.getItem("ISPAuthenticator.isAuthenticated"),n=e.getItem("ISPAuthenticator.authenticatedIdentity"),i=null;try{i=JSON.parse(e.getItem("ISPAuthenticator.authenticatedProvider"))}catch(e){}var r={isAuthenticated:t,authenticatedIdentity:n,authenticatedProvider:i};return e.removeItem("ISPAuthenticator.isAuthenticated"),e.removeItem("ISPAuthenticator.authenticatedIdentity"),e.removeItem("ISPAuthenticator.authenticatedProvider"),r}(this.storage),ia(this.state_,this.storage));var r=JSON.parse(i.toString());r.authenticatedProvider&&(r.authenticatedProvider=Qr.fromObject(r.authenticatedProvider)),this.state_=r}catch(e){}}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAuthenticated",{get:function(){return"true"===this.state_.isAuthenticated||!0===this.state_.isAuthenticated},set:function(e){this.state_.isAuthenticated=e,ia(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"authenticatedIdentity",{get:function(){return this.state_.authenticatedIdentity},set:function(e){if(!e)return delete this.state_.authenticatedIdentity,void ia(this.state_,this.storage);this.state_.authenticatedIdentity=e,ia(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"authenticatedProvider",{get:function(){return this.state_.authenticatedProvider},set:function(e){if(!e)return delete this.state_.authenticatedProvider,void ia(this.state_,this.storage);this.state_.authenticatedProvider=e,ia(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preauthorizedResources",{get:function(){return this.isAuthenticated?["espn3"]:[]},enumerable:!0,configurable:!0}),e.prototype.checkAuthentication=function(){var e=this,t=this.configuration.userDataServiceUrl;return T(t+"?partner="+this.partner+"&platform="+this.platform).then((function(e){return e.json()})).then((function(n){var i=n.user&&n.user.authentication&&n.user.authentication.isp;if(i){e.isAuthenticated=!0;var r=i.name;return e.providerDataSource?e.providerDataSource.getProvider(r,qi.isp).then((function(n){var i=n.getPreferredLogoUrl(e.partner);return e.authenticatedProvider=new Qr(r,n.name,i,t),!0})).catch((function(){return e.authenticatedProvider=new Qr(r,r,null,t),!0})):(e.authenticatedProvider=new Qr(r,r,null,t),S.resolve(!0))}return!1}))},e.prototype.authenticate=function(){return S.resolve(!0)},e.prototype.deauthenticate=function(){return this.isAuthenticated=!1,this.authenticatedProvider=null,this.authenticatedIdentity=null,S.resolve(!0)},e.prototype.checkAuthorization=function(e){var t;if(-1===e.authenticationTypes.indexOf(Ir.isp)||!this.isAuthenticated)return S.resolve(new ta(!1,null));var n=((t={})[ea.CustomDataKey.token]="IA==",t[ea.CustomDataKey.tokenType]="DEVICE",t),i=new ea(Ir.isp,this.authenticatedProvider,this.authenticatedIdentity,n),r=new ta(!0,i);return S.resolve(r)},e.defaultConfiguration=ra,e}(),sa=function(e){function n(){return s(this,n),t(this,n,arguments)}return d(n,e),c(n,[{key:"configuration",get:function(){var e=Q.shared.getConfiguration("authorization",aa.defaultConfiguration);return P.debug("ISPAuthenticator.getConfiguration ".concat(JSON.stringify(e))),e},set:function(e){g(h(n.prototype),"configuration",e,this,!0)}}]),n}(aa),oa=function(e){function n(e,i){var r;s(this,n),(r=t(this,n)).partner=ie.partner,r.platform=ie.platform,r.apiKey=ie.apiKey,r.deviceId=ie.deviceId;var a=new rr(e),o={deviceId:r.deviceId,deviceType:ie.platform},c=new Yt(r.partner,r.platform,"ESPN",o,{production:"eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiIyZGJmZWM4My03OWE1LTQyNzEtYTVmZC04NTZjYTMxMjRjNjMiLCJuYmYiOjE1NDAyMTI3NjEsImlzcyI6ImF1dGguYWRvYmUuY29tIiwiaWF0IjoxNTQwMjEyNzYxfQ.yaK3r4AI2uLVvsyN1GLzqzgzRlxMPtasSaiYYBV0wIstqih5tvjTmeoLmi8Xy9Kp_U7Md-bOffwiyK3srHkpUkhhwXLH2x6RPjmS1tPmhaG7-3LBcHTf2ySPvXhVf7cN4ngldawK4tdtLtsw6rF_JoZE2yaC6XbS2F51nXSFEDDnOQWIHEQRG3aYAj-38P2CLGf7g-Yfhbp5cKXeksHHQ90u3eOO4WH0EAjc9oO47h33U8KMEXxJbvjV5J8Va2G2fQSgLDZ013NBI3kQnE313qgqQh2feQILkyCENpB7g-TVBreAjOaH1fU471htSoGGYepcAXv-UDtpgitDiLy7CQ",staging:"eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJhMmRjNjgyMC1kZGNkLTQ4NGEtOTdlNS0xZjJiZmQzOGI4YzgiLCJuYmYiOjE1NDAyMjIwNTksImlzcyI6ImF1dGguYWRvYmUuY29tIiwiaWF0IjoxNTQwMjIyMDU5fQ.YgX4ecGCgLCaZS7uwRQYZ8UR5EwT7GIl-glFbwU122bO1JYZSmbIX8YJSfmYth_scyeg-15BYWNftV9lOcmCe8VwIsQMJMIZKaF8qSIj5OfuTOBpNZNBpDAp5dC3zG7Zp1xLe3z-T0Y18-0BGj2yhGcJxBz4gtLXQ30Bw0LEIJ89nXCQaXFTq9N6zhDzMfkFJNnSNEvEmvcQqB4bFPIqn2is8427oQDU4D0XYvvTtx9eb5hmzKc9MbBG-8KRBA62BqdHomA5UA4kBYJKpe-8B2hO07Adi2bZoo5wP_VLNAnAxANWNXaGQYHMDjHDrHbbvuKHBudHgKxAuKpIdC7UrA"});c.providerDataSource=a;var u="web"===r.platform,l=u?mt.sessionStorage:mt.localStorage,d=new sa(r.partner,r.platform,l);d.providerDataSource=a;var h={apiKey:r.apiKey,serviceUrl:An.defaultServiceUrl},p=Q.shared.getConfiguration("shield",h),f=new An(p.apiKey),m=function(){var e={apiKey:r.apiKey,serviceUrl:An.defaultServiceUrl},t=Q.shared.getConfiguration("shield",e);f.apiKey=t.apiKey,f.serviceUrl=t.serviceUrl};m();var y=new Si,g=new ki(r.partner,r.platform,f,u);r.authenticators[we.mvpd]=c,r.authenticators[we.isp]=d,r.authenticators[we.open]=y,r.authenticators[we.direct]=g,r.authorizers[we.mvpd]=c,r.authorizers[we.isp]=d,r.authorizers[we.open]=y,r.authorizers[we.direct]=g,r.concurrencyMonitorBuilder=ar.getBuilder();var v=new kn(f);r.playbackSessionFactories[Ie.shield]=v;var b=new vn(r.partner,r.platform),_=new _n(b);r.playbackSessionFactories[Ie.startSession]=_;var w=new nn;return r.playbackSessionFactories[Ie.none]=w,r.drmSupport=i,Q.shared.on(Y,(function(){var e=Q.shared.getConfiguration("adobeCM");m();var t=new kn(f);r.playbackSessionFactories[Ie.shield]=t,r.concurrencyMonitorBuilder=r.concurrencyMonitorBuilder||ar.getBuilder(),r.concurrencyMonitorBuilder=r.concurrencyMonitorBuilder.withServiceUrl(e.serviceUrl)})),r}return d(n,e),c(n,[{key:"drmSupport",set:function(e){var t=this;Object.keys(this.playbackSessionFactories).map((function(e){return t.playbackSessionFactories[e]})).forEach((function(t){"drmSupport"in t&&(t.drmSupport=e)}))}},{key:"initPlaybackSession",value:function(e,t){var i=Ki.swid||Vi.swid;(arguments.length<=3?void 0:arguments[3])&&Object.keys(tn).map((function(e){return tn[e]})).indexOf(arguments.length<=3?void 0:arguments[3])&&(this.drmSupport=arguments.length<=3?void 0:arguments[3]);var r=new Ct;return r.swid=i,r.platform=this.platform,r.merge(t),m(h(n.prototype),"initPlaybackSession",this).call(this,e,r)}},{key:"advertisingId",get:function(){var e=localStorage.getItem("AuthenticationManager.advertisingId");return e||(e=dt&&dt.device.advertisingId,this.advertisingId=e),e},set:function(e){localStorage.setItem("AuthenticationManager.advertisingId",e)}}]),n}(En);!function(e){e[e.all=0]="all",e[e.linearPlayback=1]="linearPlayback"}(na||(na={}));var ca,ua=na;!function(e){e.linear="linear",e.event="event"}(ca||(ca={}));var la,da=ca;!function(e){e.stitchedPreroll="stitchedPreroll"}(la||(la={}));var ha,pa=la;!function(e){e.live="live",e.onDemand="onDemand"}(ha||(ha={}));var fa,ma=ha;!function(e){e.nielsen="nielsen",e.comscore="comscore",e.conviva="conviva",e.heartbeats="heartbeats"}(fa||(fa={}));var ya,ga=fa;!function(e){e.shortform="shortform",e.longform="longform"}(ya||(ya={}));var va,ba=ya;!function(e){e.audio="audio",e.video="video"}(va||(va={}));var _a,wa=va;!function(e){e.pluto="pluto",e.graphQL="graphQL",e.cfa="cfa",e.itemFeed="itemFeed"}(_a||(_a={}));var Pa,Ia=_a;!function(e){e.open="OPEN",e.direct="DIRECT",e.mvpd="MVPD",e.isp="ISP",e.none="NONE"}(Pa||(Pa={}));var Sa,Ta=Pa;!function(e){e.none="none",e.startSession="startSession",e.bam="bam",e.shield="shield",e.entitlement="entitlement"}(Sa||(Sa={}));var Aa=Sa,ka=function(){function e(e,t,n,i,r,a,s,o){this.url=e,this.type=t,this.hasEspnId3Heartbeats=n,this.hasNielsenWatermarks=i,this.hasPassThroughAds=r,this.commercialReplacement=a,this.startSessionUrl=s,this.variant=o}return e.fromObject=function(t){if(!t)return null;var n=t.url,i=t.type,r=t.hasEspnId3Heartbeats,a=t.hasNielsenWatermarks,s=t.hasPassThroughAds,o=t.commercialReplacement,c=t.startSessionUrl,u=t.variant;return new e(n,Aa[i],r,a,s,o,c,u)},e}(),Ea=function(){function e(e,t,n,i){this.id=e,this.type=t,this.name=n,this.resource=i}return e.fromObject=function(t){if(!t)return null;var n=da[t.type];return new e(t.id,n,t.name,t.resource)},e}(),Ca=function(){function e(e){this.url=e}return e.fromObject=function(t){return t&&t.url?new e(t.url):null},e}(),Ma=function(){function e(e){this.name=e}return Object.defineProperty(e.prototype,"logoUrl",{get:function(){return"https://secure.espncdn.com/watchespn/images/espnplus/packages/"+this.name+".png"},enumerable:!1,configurable:!0}),e.fromObject=function(t){return t?new e(t.name):null},e}(),Oa=function(){function e(e,t,n,i,r){this.id=e,this.title=t,this.duration=n,this.language=i||"en",this.source=r,this.description=null,this.authenticationTypes=[],this.mrss=null,this.seekInSeconds=null,this.tracking={},this.references={},this.network=null,this.streamType=null,this.supportedMediaCommands=ua.all,this.images=[],this.type=wa.video,this.packages=[],this.tier=null,this.entityType=null,this.isSyndicatable=null,this.brand=null,this.apiSource=null,this.adUnitId=null,this.cues=null,this.adTarget=null,this.show=null}return Object.defineProperty(e.prototype,"isLinear",{get:function(){return!!this.network&&this.network.type===da.linear},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLive",{get:function(){return this.streamType===ma.live},enumerable:!1,configurable:!0}),e.fromObject=function(t){var n=ka.fromObject(t.source),i=new e(t.id,t.title,t.duration,t.language,n);return i.airDate=t.airDate,i.apiSource=t.apiSource,i.authenticationTypes=t.authenticationTypes,i.description=t.description,i.images=(t.images||[]).map((function(e){return Ca.fromObject(e)})),i.mrss=t.mrss,i.network=Ea.fromObject(t.network),i.seekInSeconds=t.seekInSeconds,i.streamType=ma[t.streamType],i.supportedMediaCommands=t.supportedMediaCommands,i.tracking=t.tracking,i.references=t.references,i.packages=(t.packages||[]).map((function(e){return Ma.fromObject(e)})),i.tier=t.tier,i.type=wa[t.type],i.entityType=ba[t.entityType],i.isSyndicatable=t.isSyndicatable,i.brand=t.brand,i.adUnitId=t.adUnitId,i.cues=t.cues,i.show=t.show,i.adTarget=t.adTarget,i.availableDate=t.availableDate,i.episodeNumber=t.episodeNumber,i.locale=t.locale,i.seasonNumber=t.seasonNumber,i.tmsid=t.tmsid,i.videoShowGenre=t.videoShowGenre,i},e.prototype.toString=function(){return"<MediaItem id:"+this.id+", title:"+this.title+", streamType:"+this.streamType+">"},e}();var Da,Na=function(){function e(e){var t=function(e){var t=e.split("?")[1],n={};if(t)for(var i=t.split("&"),r=0;r<i.length;r+=1){var a=i[r].split("=");n[a[0]]=a[1]}return n}(e);if(this.original=e,this.id=t.videoID||t.playID||t.clip||t.externalId,e.match("sportscenter")){this.gameId=t.playGameID,this.channel=t.playChannel,this.simulcastAiringId=t.simulcastAiringId;var n=parseInt(t.resumeTime,10);isNaN(n)||(this.resumeTime=n),this.eventId=t.eventId}else e.match("abcnews")&&(this.channel=t.playChannel,this.id=t.videoID||t.id);this.source=t["x-source"],t.videoID?this.entityType=ba.shortform:this.entityType=ba.longform,this.type=wa.video}return e.prototype.toString=function(e){return e==Ia.graphQL?"<MediaItemIdentifier id:"+this.id+", gameId:"+this.gameId+", channel:"+this.channel+", source:"+this.source+">":"<MediaItemIdentifier id:"+this.id+", source:"+this.source+">"},e.identifierStringForNetwork=function(e,t){switch(t){case Ia.cfa:return"natgeo://playVideo?videoID="+e;case Ia.itemFeed:return"abcnews://playVideo?playChannel="+e;case Ia.graphQL:default:return"sportscenter://x-callback-url/showWatchStream?playChannel="+e}},e}();function La(e,t,n,i){if(!t)return{};var r,a,s,o=null;e===Da.natGeo?o=function(e){if(!e)return{};var t={},n=e.id,i=e.title,r=e.duration;return t.c_video_id_code=n,t.c_a_media_airdate="unknown",t.c_a_media_daypart="daytime",t.c_a_media_digitaldate="unknown",t.c_a_media_episode="none",t.c_a_media_feed="natgeo live",t.c_a_media_format="vod",t.c_a_media_genre="none",t.c_a_media_network="natgeo",t.c_a_media_originator="natgeo",t.c_a_media_pass_auth="none",t.c_a_media_pass_mvpd="none",t.c_a_media_rating="none",t.c_a_media_season="none",t.c_a_media_show=i,t.c_a_media_streamtype=va.video,t.c_a_media_length=r,t}(t):(r=function(e,t,n){if(!e)return{};var i=e.duration,r=e.id,a=e.league,s=e.name,o=e.network,c=e.program,u=e.sport,l=e.startDateTime,d=e.tracking,h="1";n&&!0===n.hasEspnId3Heartbeats&&!1===n.hasPassThroughAds&&"SHARED INV"!==n.commercialReplacement&&(h="2");var p={type:"content"};if(p.assetid=d&&d.trackingId||r,p.program=s,p.title=s,p.clientid="us-600140",t===ba.longform){if(p.length=""+i,p.segB=a&&a.name||"No League",p.segC=""+(c&&c.code||"")+(u&&u.code||""),l){var f=new Date(l);p.airdate=f.getUTCFullYear().toString()+("0"+f.getUTCMonth()).slice(-2)+("0"+f.getUTCDate()).slice(-2)+" "+("0"+f.getUTCHours()).slice(-2)+":"+("0"+f.getUTCMinutes()).slice(-2)+":"+("0"+f.getUTCSeconds()).slice(-2)}p.isfullepisode="y",p.crossId1=d&&d.nielsenCrossId1||"",p.crossId2=o&&o.name||"",p.adloadtype=h,p.hasAds="1",p.progen="SE",p.vcid="b01"}return t===ba.shortform&&(p.accmethod="1",p.length=""+i,p.segA=s,p.segB="No League",p.segC="VOD",p.isfullepisode="n",p.crossId1="",p.adloadtype="1",p.vcid="c17",p.adloadtype="2"),p}(t,n,i),a=function(e,t){if(!e)return{};var n=e.id,i=e.duration,r=e.name,a=e.league,s=e.startDateTime,o=e.network,c=e.sport,u=e.status,l=e.tracking,d={};if(t===ba.longform)d.ns_st_cl=0,d.ns_st_ct="vc",!u||"live"!==u.toLowerCase()&&"over"!==u.toLowerCase()?(d.ns_st_cl=i,d.ns_st_ct="vc12",d.ns_st_pr="VOD",d.ns_st_ep=r):(d.ns_st_cl=0,d.ns_st_ct="vc13",d.ns_st_pr=r,d.ns_st_ep="*null"),d.c3="WATCHESPNLIVE",d.c6=a&&a.name?a||"No league":c&&c.code||"No Sport";else{d.ns_st_cl=i,d.ns_st_ct="vc11",d.ns_st_pr="VOD",d.ns_st_ep=r;var h=l||{},p=h.sportName,f=h.leagueName;d.c3="vod",d.c6=""+(f&&"no league"!==f.toLowerCase()?f:p||"No Sport")}if(d.ns_st_ti="*null",d.ns_st_ia="*null",d.ns_st_ce="*null",d.ns_st_ci=n,s){var m=new Date(s);d.ns_st_ddt=m.toDateString(),d.ns_st_tdt=m.toDateString()}return d.ns_st_st=o?o.id:"*null",d.ns_st_en="*null",d.ns_st_cn="1",d.ns_st_pn="1",d.ns_st_tp="1",d.ns_st_pu="ESPN",d.ns_st_cu="none",d.ns_st_ad="0",d.ns_st_ge="Sports",d}(t,n),s=function(e,t,n){if(!e)return{};var i=e.name,r=e.id,a=e.airingId,s=e.eventId,o=e.duration,c=e.network,u=e.status,l=e.sport,d=e.league,h={};h.contentId=r,a&&(h.airingId=a),s&&(h.eventId=""+s,h.eventName=i),c&&(h.network=c.id),t===ba.shortform?h.assetType="clip":!u||"live"!==u.toLowerCase()&&"over"!==u.toLowerCase()?h.assetType="vod":h.assetType="live";var p=i+" - "+r;return c&&c.type===da.linear&&"live"===h.assetType&&(p=c.id),h.sport=l&&l.name||"Not Applicable",h.league=d&&d.name||"Not Applicable",h.appBrand=Da.espn,{assetName:p,duration:o,streamUrl:n&&n.url,custom:h}}(t,n,i),o=function(e,t){if(!e)return{};var n=e.duration,i=e.airingId,r=e.network,a=e.status,s=e.sport,o=e.league,c=e.name,u=e.program,l=e.startDateTime,d=e.tracking,h=e.originalPublishDate,p=e.expirationDate,f=e.lastModifiedDate,m=e.ad,y=e.coverageType,g=e.brands,v={};if(v.ContentDuration=n,t===ba.longform){if(v.CMSID=d&&d.name||c,v.isFullEpisode="y",i&&(v.AiringID=i),r&&(v.NetworkName=r.id,v.Channel=r.id),a&&(v.VideoType="REPLAY"===a?"replay":"live"),v.Sport=s&&s.name||"Not Applicable",v.SportCode=s&&s.code||"Not Applicable",v.League=o&&o.name||"Not Applicable",u&&u.code&&u.categoryCode?v.ProgramCode=u.categoryCode+u.code:v.ProgramCode="Not Applicable",v.IsStudio=u&&u.isStudio||"Not Applicable",l){var b=new Date(l);v.AirDate=b.toDateString(),v.AirTime=b.toTimeString()}if(Array.isArray(g)&&g.length){var _=g[0],w=_.id,P=_.name,I=_.type;v["a.media.asset"]=w,v["a.media.show"]=P,v["a.media.genre"]=I}}else if(t===ba.shortform){if(v.isFullEpisode="n",v.VideoType="vod",v.Sport=d&&d.sportName||"Not Applicable",v.League=d&&d.leagueName||"Not Applicable",v.ShowCode=m&&m.bundle||"Not Applicable",d&&d.name&&(v.CMSID=d.name),h){b=new Date(h);v.PublishDate=b.toISOString().substring(0,10),v.PublishTime=b.toISOString().substring(11)}if(p){b=new Date(p);v.ExpirationDate=b.toISOString()}if(f){b=new Date(f);v.DateLastModified=b.toISOString()}y&&(v.VideoTypeDetail=y)}return v}(t,n));var c={};return c[ga.nielsen]=r,c[ga.comscore]=a,c[ga.conviva]=s,c[ga.heartbeats]=o,c}function Ua(e,t,n){return e.sort((function(e,t){var n="PRIMARY"===e.tier?0:"SECONDARY"===e.tier?1:2,i="PRIMARY"===t.tier?0:"SECONDARY"===t.tier?1:2;return n<i?-1:n>i?1:0})).sort((function(e,n){var i=e.network&&e.network.id.toLowerCase()||"unknown",r=n.network&&n.network.id.toLowerCase()||"unknown",a=t.indexOf(i),s=t.indexOf(r);return-1===a&&(a=999),-1===s&&(s=999),a<s?-1:a>s?1:0})).sort((function(e,t){var i=e.language===n?0:1,r=t.language===n?0:1;return i<r?-1:i<r?1:0}))}!function(e){e.abc="abc",e.abcNews="abcnews",e.abcNewsLive="abcnewslive",e.abcOtv="abcotv",e.cricinfo="cricinfo",e.disney="dch",e.disneyJr="djr",e.disneyXD="dxd",e.disneyNow="dnow",e.espn="espn",e.espnFantasy="espnFantasy",e.fiveThirtyEight="fivethirtyeight",e.foxLatam="foxlatam",e.freeform="ff",e.fxNow="fxnow",e.fx="fx",e.fxm="fxm",e.fxx="fxx",e.oscar="oscar",e.marvel="marvel",e.natGeoTV="ngtv",e.natGeo="ngc",e.natGeoWild="ngw",e.natgeoBrasil="natgeobrasil",e.theUndefeated="theundefeated",e.unknown="000"}(Da||(Da={}));var ja=["espn_ppv","espn_dtc","espn1","espn2","espn3","espnu","sec","espnews","espndeportes","longhorn","goalline","buzzerbeater","secplus","acc","accextra","espn_free","bam_dtc"],Fa=function(e,t,n,i){e==Ia.graphQL?(this.serviceUrl=t||"https://watch.graph.api.espn.com/api",this.apiKey=n||"d15c5790-7cb0-4fe1-8782-25f4698d0739",this.networkSortOrder=i||ja):e==Ia.cfa?this.serviceUrl=t||"https://natgeo.entertainment.client.dtci.technology/v1/playback/video/id/mock":e===Ia.itemFeed&&(this.serviceUrl=t||"https://abcnews.go.com/video/itemfeed")},Ra=function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return M(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var r,a,s,o,c,u;return M(this,(function(l){switch(l.label){case 0:return r=t.map((function(e){return new Na(e)})),a=i.serviceUrl,s=i.apiKey,o=i.networkSortOrder,[4,S.all(r.map((function(t){return e.getPromiseMediaItems(t,a,s,n)})))];case 1:return c=l.sent(),(u=c.filter((function(e){return!(e instanceof Error)&&e instanceof Oa}))).length?[2,Ua(u,o,navigator.language)]:[2,null]}}))}))},e.getPromiseMediaItems=function(t,n,i,r){return C(this,void 0,void 0,(function(){var a,s,o,c,u,l,d,h,p,f,m,y;return M(this,(function(g){switch(g.label){case 0:a=function(e,t,n,i){var r="",a="",s="",o=i||"US";return e.entityType===ba.shortform?(r="VOD",s="{id name description authTypes language duration originalPublishDate expirationDate requiresLinearPlayback lastModifiedDate source { url authorizationType } image { url } tracking { name sportName leagueName } coverageType prerollSource:source(variant:PREROLL) { url authorizationType }ad { sport bundle } links { web } cerebroId syndicatable}",a='id:"'+e.id+'"'):(r="airing",s="{ id name description mrss:adobeRSS authTypes requiresLinearPlayback status:type startDateTime endDateTime duration source(authorization: SHIELD) { url authorizationType hasEspnId3Heartbeats hasNielsenWatermarks hasPassThroughAds commercialReplacement startSessionUrl } network { id type name adobeResource } image { url } sport { name code uid } league { name uid } program { code categoryCode isStudio } seekInSeconds simulcastAiringId airingId tracking { nielsenCrossId1 trackingId } eventId packages { name } language tier feedName brands { id name type } }",e.id?a='id:"'+e.id+'"':e.channel?(r="airings",a='networks:["'+e.channel+'"],type:LIVE'):e.gameId&&(r="airings",a='eventId:"'+(e.eventId||e.gameId)+'"')),t+"?apiKey="+n+"&query="+encodeURIComponent("{ "+r+"("+a+',countryCode:"'+o+'",deviceType:SETTOP,tz:"Z") '+s+" }")}(t,n,i,r.countryCode),g.label=1;case 1:return g.trys.push([1,4,,5]),[4,T(a)];case 2:return[4,g.sent().json()];case 3:if(s=g.sent(),o=s.data.airing,(c=s.data.airings)&&(u=t.simulcastAiringId?function(e){return e.simulcastAiringId===t.simulcastAiringId}:function(){return!0},o=c.filter(u)[0]),l=s.data.VOD,!(d=o||l))throw new Error("No results found.");if(h=function(e,t,n){var i=e.id,r=e.name,a=e.description,s=e.duration,o=e.image,c=e.eventId,u=e.requiresLinearPlayback,l=e.authTypes,d=e.source,h=e.prerollSource,p=e.packages,f=e.language,m=e.mrss,y=e.seekInSeconds,g=e.tracking,v=e.simulcastAiringId,b=e.network,_=e.status,w=e.cerebroId,P=e.syndicatable,I=_&&("LIVE"===_.toUpperCase()||"OVER"===_.toUpperCase())?ma.live:ma.onDemand,S=function(e){switch(e){case"NONE":return Aa.none;case"START_SESSION":return Aa.startSession;case"BAM":return Aa.bam;case"SHIELD":return Aa.shield}}(d.authorizationType),T=new ka(d.url,S,d.hasEspnId3Heartbeats,d.hasNielsenWatermarks,d.hasPassThroughAds,d.commercialReplacement,d.startSessionUrl);n&&n.sourceVariant===pa.stitchedPreroll&&h&&((T=new ka(h.url,Aa.none)).variant=pa.stitchedPreroll);var A=u?ua.linearPlayback:ua.all,k=g&&g.trackingId||i,E=new Oa(i,r,s,f,T);if(E.authenticationTypes=l.map((function(e){switch(e){case"DIRECT":return Ta.direct;case"OPEN":return Ta.open;case"MVPD":return Ta.mvpd;case"ISP":return Ta.isp;default:return Ta.none}})),E.description=a,E.isSyndicatable=P,o&&o.url&&E.images.push(new Ca(o.url)),E.mrss=m,b){var C="linear"===b.type?da.linear:da.event;E.network=new Ea(b.id,C,b.name,b.adobeResource)}return E.seekInSeconds=y,E.streamType=I,E.supportedMediaCommands=A,E.brand=E.brand?E.brand:"espn",E.tracking=La(E.brand,e,t,T),E.references={eventId:c,simulcastAiringId:v,trackingId:k,cerebroId:w},E.type=wa.video,E.entityType=t,E.apiSource=Ia.graphQL,E.packages=(p||[]).map((function(e){return new Ma(e.name)})),E}(d,t.entityType,r),t.resumeTime&&(h.seekInSeconds=t.resumeTime),!h.source.url){if(p="OVER"===d.status.toUpperCase(),f=d.network&&d.network.type===da.linear,m=d.network&&d.network.id,p&&f&&m)return[2,e.retryGetMediaItems(m,n,i,r)];throw new Error("No playable url")}return[2,h];case 4:return y=g.sent(),P.warn("Failed to retrieve MediaItem from GraphQL: "+y),[2,null];case 5:return[2]}}))}))},e.retryGetMediaItems=function(t,n,i,r){return C(this,void 0,void 0,(function(){var a,s,o,c;return M(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),a=Na.identifierStringForNetwork(t,Ia.graphQL),s=new Na(a),[4,e.getPromiseMediaItems(s,n,i,r)];case 1:if((o=u.sent())&&o instanceof Oa==!0)return[2,o];throw new Error("Retry fetchMediaItems failed with "+t);case 2:return c=u.sent(),P.warn("MediaItem is over and retry failed: "+c),[2,null];case 3:return[2]}}))}))},e.defaultConfiguration=new Fa(Ia.graphQL),e}();var xa=function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return M(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var n,r;return M(this,(function(a){switch(a.label){case 0:return n=t.map((function(e){return new Na(e)})),r=i.serviceUrl,[4,S.all(n.map((function(t){return e.getPromiseMediaItem(t,r)})))];case 1:return[2,a.sent().filter((function(e){return!(e instanceof Error)&&e instanceof Oa}))]}}))}))},e.getPromiseMediaItem=function(e,t){return C(this,void 0,void 0,(function(){var n,i,r;return M(this,(function(a){switch(a.label){case 0:n=t.replace("videoID",e.id),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,T(n)];case 2:return[4,a.sent().json()];case 3:return i=a.sent(),[2,function(e){var t=e.id,n=e.title,i=e.description,r=e.duration,a=e.source,s=e.type,o=e.entityType,c=e.streamType,u=e.authenticationTypes,l=e.language,d=e.network,h=e.brand,p=e.images,f=o,m=a.type,y=new ka(a.url,m),g=new Oa(t,n,r,l,y);return g.authenticationTypes=u.map((function(e){switch(e){case"DIRECT":return Ta.direct;case"OPEN":return Ta.open;case"MVPD":return Ta.mvpd;case"ISP":return Ta.isp;default:return Ta.none}})),g.description=i,d&&(g.network=new Ea(d.id,d.type,d.name,d.resource)),g.streamType=c,g.brand=h,g.tracking=La(g.brand,e,f,y),g.images=p,g.type=s,g.entityType=f,g.apiSource=Ia.cfa,g}(i)];case 4:return r=a.sent(),P.warn("Failed to retrieve MediaItem from CFA: "+r),[2,null];case 5:return[2]}}))}))},e.defaultConfiguration=new Fa(Ia.cfa),e}(),Ha=Object.freeze({}),Ba=Object.freeze({}),za=Ia.itemFeed,Va={lf:"longform",sf:"shortform",live:"longform"},Ka={"abcn:fivethirtyeight":"fivethirtyeight",abcn:"abcnews"},Ga={name:"abc_news_live",type:"linear"},qa=["HLS_ALL","PDL_MED","PDL_LOW"];function $a(e){var t,n,i,r=(e||Ha).channel||Ha,a=r.item||Ha,s=a["media-group"]||Ha,o=s["media-content"]||Ba,c=s["media-title"],u=(function(e){for(var t,n,i=qa.length,r=e.length,a=0;a<i;a++)for(var s=qa[a],o=0;o<r;o++){var c=e[o];if((null===(n=null===(t=null==c?void 0:c["media-category"])||void 0===t?void 0:t["@attributes"])||void 0===n?void 0:n.label)===s)return c}}(o)||Ha)["@attributes"]||Ha,l=(s["media-thumbnail"]||Ha)["@attributes"]||Ha,d=a.guid,h=a.title,p=a.temporalType,f=a.timestamp,m=a.link,y=u.duration,g=u.url,v=u.medium,b=(a.omniture||Ha).channel||"",_=O(String(b).split(":"),1)[0],w=Ka[b]||Ka[void 0===_?"abcn":_]||"abcnews",P="vod"===p,I="live"===p,S=Va[a.videoContentType]||(P?"shortform":"longform"),T=c||h,A=r.language||"en";try{n=(t=O(new Date(f).toISOString().split("T"),2))[0],i=t[1]}catch(e){console.warn(e)}var k="akamai live stream"!==a.mediatype||P?{}:E(E({},Ga),{id:d}),C={id:d,apiSource:za,seasonNumber:"none",eventId:"none",episodeNumber:"none",genre:"news",tvrating:"none",network:k,show:{title:T},title:T,duration:y,language:A,source:{url:g,type:"none"},description:a.description||s["media-description"],authenticationTypes:["NONE"],mrss:null,seekInSeconds:null,brand:w,type:"video"===v?"video":"audio",entityType:S,streamType:I?"live":"onDemand",images:l?[{url:l.url}]:null,airDate:a.timestamp,availableDate:a.pubDate,references:{itemfeed:d},tracking:{omniture:a.omniture,nielsen:{type:"content",assetid:d,program:T,title:T},conviva:{assetName:h,duration:y,streamURL:g,custom:{contentId:d,assetType:P?"clip":"live",sport:"none",league:"none",appBrand:a.category||"abcnews"}},heartbeats:{ContentDuration:y,isFullEpisode:"shortform"===S||I?"n":"y",VideoType:p,CMSID:T,PublishDate:n,PublishTime:i}},webHref:m};return Oa.fromObject(C)}var Wa,Ja=w((function(e,t){function n(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function i(e,t){return t.encode?t.strict?encodeURIComponent(e).replace(/[!'()*]/g,e=>"%"+e.charCodeAt(0).toString(16).toUpperCase()):encodeURIComponent(e):e}function r(e,t){return t.decode?Ze(e):e}function a(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function s(e){const t=(e=a(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function o(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function c(e,t){n((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const i=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,i)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===i[e]&&(i[e]={}),i[e][t[1]]=n):i[e]=n};case"bracket":return(e,n,i)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==i[e]?i[e]=[].concat(i[e],n):i[e]=[n]:i[e]=n};case"comma":case"separator":return(t,n,i)=>{const a="string"==typeof n&&n.includes(e.arrayFormatSeparator),s="string"==typeof n&&!a&&r(n,e).includes(e.arrayFormatSeparator);n=s?r(n,e):n;const o=a||s?n.split(e.arrayFormatSeparator).map(t=>r(t,e)):null===n?n:r(n,e);i[t]=o};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),a=Object.create(null);if("string"!=typeof e)return a;if(!(e=e.trim().replace(/^[?#&]/,"")))return a;for(const n of e.split("&")){if(""===n)continue;let[e,s]=et(t.decode?n.replace(/\+/g," "):n,"=");s=void 0===s?null:["comma","separator"].includes(t.arrayFormat)?s:r(s,t),i(r(e,t),s,a)}for(const e of Object.keys(a)){const n=a[e];if("object"==typeof n&&null!==n)for(const e of Object.keys(n))n[e]=o(n[e],t);else a[e]=o(n,t)}return!1===t.sort?a:(!0===t.sort?Object.keys(a).sort():Object.keys(a).sort(t.sort)).reduce((e,t)=>{const n=a[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((e,t)=>Number(e)-Number(t)).map(e=>t[e]):t}(n):e[t]=n,e},Object.create(null))}t.extract=s,t.parse=c,t.stringify=(e,t)=>{if(!e)return"";n((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const r=n=>t.skipNull&&null==e[n]||t.skipEmptyString&&""===e[n],a=function(e){switch(e.arrayFormat){case"index":return t=>(n,r)=>{const a=n.length;return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[i(t,e),"[",a,"]"].join("")]:[...n,[i(t,e),"[",i(a,e),"]=",i(r,e)].join("")]};case"bracket":return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[i(t,e),"[]"].join("")]:[...n,[i(t,e),"[]=",i(r,e)].join("")];case"comma":case"separator":return t=>(n,r)=>null==r||0===r.length?n:0===n.length?[[i(t,e),"=",i(r,e)].join("")]:[[n,i(r,e)].join(e.arrayFormatSeparator)];default:return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,i(t,e)]:[...n,[i(t,e),"=",i(r,e)].join("")]}}(t),s={};for(const t of Object.keys(e))r(t)||(s[t]=e[t]);const o=Object.keys(s);return!1!==t.sort&&o.sort(t.sort),o.map(n=>{const r=e[n];return void 0===r?"":null===r?i(n,t):Array.isArray(r)?r.reduce(a(n),[]).join("&"):i(n,t)+"="+i(r,t)}).filter(e=>e.length>0).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[n,i]=et(e,"#");return Object.assign({url:n.split("?")[0]||"",query:c(s(e),t)},t&&t.parseFragmentIdentifier&&i?{fragmentIdentifier:r(i,t)}:{})},t.stringifyUrl=(e,n)=>{n=Object.assign({encode:!0,strict:!0},n);const r=a(e.url).split("?")[0]||"",s=t.extract(e.url),o=t.parse(s,{sort:!1}),c=Object.assign(o,e.query);let u=t.stringify(c,n);u&&(u="?"+u);let l=function(e){let t="";const n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);return e.fragmentIdentifier&&(l="#"+i(e.fragmentIdentifier,n)),`${r}${u}${l}`},t.pick=(e,n,i)=>{i=Object.assign({parseFragmentIdentifier:!0},i);const{url:r,query:a,fragmentIdentifier:s}=t.parseUrl(e,i);return t.stringifyUrl({url:r,query:tt(a,n),fragmentIdentifier:s},i)},t.exclude=(e,n,i)=>{const r=Array.isArray(n)?e=>!n.includes(e):(e,t)=>!n(e,t);return t.pick(e,r,i)}})),Ya=(Ja.extract,Ja.parse,Ja.stringify,Ja.parseUrl,Ja.stringifyUrl,Ja.pick,Ja.exclude,function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return M(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var n,r;return M(this,(function(a){switch(a.label){case 0:return n=t.map((function(e){return new Na(e)})),r=i.serviceUrl,[4,S.all(n.map((function(t){return e.getPromiseMediaItem(t,r)})))];case 1:return[2,a.sent().filter((function(e){return!(e instanceof Error)&&e instanceof Oa}))]}}))}))},e.getPromiseMediaItem=function(e,t){return C(this,void 0,void 0,(function(){var n,i,r;return M(this,(function(a){switch(a.label){case 0:n=Ja.stringify({id:e.id||e.channel}),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,T(t+"?"+n+"&requester=guardians")];case 2:return[4,a.sent().json()];case 3:return i=a.sent(),[2,$a(i)];case 4:return r=a.sent(),P.warn("Failed to retrieve MediaItem from ItemFeed endpoint: "+r),[2,null];case 5:return[2]}}))}))},e.defaultConfiguration=new Fa(Ia.itemFeed),e}()),Qa=function(){function e(){}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(e,t){return C(this,void 0,void 0,(function(){var n,i=this;return M(this,(function(r){switch(r.label){case 0:return n=t||{sourceVariant:null},[4,S.all(e.map((function(e){return C(i,void 0,void 0,(function(){var t,i,r,a;return M(this,(function(s){switch(s.label){case 0:t=e.match("natgeo")?xa:e.match("abcnews")?Ya:Ra,(r=new t).configuration=this.configuration||r.configuration,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,r.getMediaItems([e],n)];case 2:return a=s.sent(),i=null==a?void 0:a[0],[3,4];case 3:return s.sent(),[3,4];case 4:return[2,i]}}))}))})))];case 1:return[2,r.sent()]}}))}))},e}(),Xa=function(){function e(e,t){this.mediaItem=e,this.mediaItemDataSource=t}return e.prototype.start=function(){var e=this;this.mediaItem.isLinear&&this.mediaItem.isLive&&(this.intervalId=setInterval((function(){e.checkProgramChange()}),6e4))},e.prototype.stop=function(){this.intervalId&&clearInterval(this.intervalId)},e.prototype.checkProgramChange=function(){var e=this;if(this.mediaItem&&this.mediaItemDataSource){var t=this.mediaItem.network&&this.mediaItem.network.id;if(t){var n=this.mediaItem.apiSource?this.mediaItem.apiSource==Ia.graphQL?Ia.graphQL:Ia.cfa:Ia.graphQL,i=Na.identifierStringForNetwork(t,n);this.mediaItemDataSource.getMediaItems([i],{}).then((function(t){var n=Array.isArray(t)&&t[0];n&&(e.mediaItem.id!==n.id&&e.mediaItem.references.simulcastAiringId!==n.references.simulcastAiringId&&(e.mediaItem=n,e.onProgramChange(n)))}))}}},e.prototype.onProgramChange=function(e){},e}();!function(e){e.willStartPlaying="atv.player.willStartPlaying",e.didStopPlaying="atv.player.didStopPlaying",e.onTimedMetadataChanged="atv.player.onTimedMetadataChanged",e.playerStateChanged="atv.player.playerStateChanged",e.playerTimeDidChange="atv.player.playerTimeDidChange"}(Wa||(Wa={}));var Za,es,ts=Wa;!function(e){e.priv="PRIV",e.txxx="TXXX"}(Za||(Za={})),function(e){e.program="PROGRAM",e.commercial="COMMERCIAL",e.slate="SLATE"}(es||(es={}));var ns,is=function(e,t,n){void 0===e&&(e="com.espn.authnet.heartbeat"),void 0===t&&(t="com.espn.authnet.transition"),void 0===n&&(n="www.nielsen.com"),this.heartbeat=e,this.transition=t,this.nielsenWatermark=n},rs=function(e,t,n){this.tag=e,this.owner=t,this.dataValue=n};!function(e){e.start="start",e.playing="playing",e.pause="pause",e.seeking="seeking",e.stalled="stalled",e.stop="stop",e.timedMetadata="timedMetadata",e.currentTime="currentTime",e.loadedMetadata="loadedMetadata"}(ns||(ns={}));var as,ss=ns,os=function(){function e(e,t){this.certificateUrl=t,this.requests=[],this.bindSecureKeyDelivery(e||atv.secureKeyDelivery||{})}return e.prototype.bindSecureKeyDelivery=function(e){e.fetchCertificate=this.fetchCertificate.bind(this),e.fetchAssetID=this.fetchAssetID.bind(this),e.fetchKeys=this.fetchKeys.bind(this),e.cancelAllRequests=this.cancelAllRequests.bind(this)},e.prototype.fetchCertificate=function(e,t){var n=this;P.debug("AtvlVdmsSecureKeyDelivery.fetchCertificate",e);var i=this.certificateUrl;if(i){var r=new XMLHttpRequest;r.open("GET",i),r.onreadystatechange=function(){if(4===r.readyState){if(200===r.status){var e=r.responseDataAsBase64;P.debug("AtvlVdmsSecureKeyDelivery.fetchCertificate responseDataAsBase64:",e),t.success(e)}else t.failure(r.status);n.requests.splice(n.requests.indexOf(r),1)}},this.requests.push(r),r.send(null)}else t.failure("invalid certificate url")},e.prototype.fetchAssetID=function(e,t){var n=/[?&]c=([^&]+)&*/.exec(e);if(!n||n.length<2)t.failure("Error parsing assetId "+e);else{var i=n[1];P.debug("AtvlVdmsSecureKeyDelivery.fetchAssetID",e,i),t.success(i,!1)}},e.prototype.fetchKeys=function(e,t,n){var i=this,r=e.replace("skd://","https://"),a=JSON.stringify({spc:t});P.debug("AtvlVdmsSecureKeyDelivery.fetchKeys",r);var s=new XMLHttpRequest;s.open("POST",r),s.setRequestHeader("Content-Type","application/json"),s.onreadystatechange=function(){if(4===s.readyState){if(200===s.status)try{var e=JSON.parse(s.responseText).ckc;n.success(e)}catch(e){n.failure("invalid JSON")}else n.failure(s.status);i.requests.splice(i.requests.indexOf(s),1)}},this.requests.push(s),s.send(a)},e.prototype.cancelAllRequests=function(){P.debug("AtvlVdmsSecureKeyDelivery.cancelAllRequests",this.requests.length),this.requests.forEach((function(e){e.abort&&e.abort()})),this.requests=[]},e}();(function(e){function t(t,n,i){var r=e.call(this)||this;if(!n)throw new Error("bus must be supplied");return r.bus=n,r.secureKeyDelivery=new os(i),r.bindEventListeners(),r}k(t,e),t.prototype.bindEventListeners=function(){var e=this;this.bus.on(ts.willStartPlaying,(function(){atv.player.observeTimedMetadataKeys(),e.emit(ss.start)})),this.bus.on(ts.playerStateChanged,(function(t,n){switch(P.debug("AtvlPlayerAdaptor AtvlPlayerEvent.playerStateChanged",t,n),t){case atv.player.states.FastForwarding:e.emit(ss.seeking,n);break;case atv.player.states.Loading:e.emit(ss.stalled,n);break;case atv.player.states.Paused:e.emit(ss.pause,n);break;case atv.player.states.Playing:e.emit(ss.playing,n);break;case atv.player.states.Rewinding:e.emit(ss.seeking,n)}})),this.bus.on(ts.onTimedMetadataChanged,(function(t){var n=t.key,i=t.extraAttributes.info,r=t.dataValue,a=r&&U.stringify(L.parse(r))||"";a.replace("\0",""),e.emit(ss.timedMetadata,new rs(n,i,a))})),this.bus.on(ts.didStopPlaying,(function(){e.emit(ss.stop),e.cleanup()})),this.bus.on(ts.playerTimeDidChange,(function(t){e.emit(ss.currentTime,t)}))},Object.defineProperty(t.prototype,"playbackConfig",{set:function(e){if(e){var t=e.licenseUrl;P.debug("AtvlPlayerAdaptor setPlaybackConfig",t,e.protectionSystem),t&&(this.secureKeyDelivery.certificateUrl=t)}},enumerable:!1,configurable:!0}),t.prototype.stop=function(e){var t=e.message;atv.player.stopWithReason("Video Playback Has Stopped",t)},t.prototype.cleanup=function(){this.bus.off(ts.willStartPlaying),this.bus.off(ts.onTimedMetadataChanged),this.bus.off(ts.didStopPlaying)}})($),function(e){function t(t,n){var i=e.call(this)||this;return t?(i.nativePlayer=t,i.bus=t.getEventBus(),i.constants=n,i.id3MetadataOwner=new is,i.unsubscribers=[],i.bindEventListeners(),i):i}k(t,e),t.prototype.bindEventListeners=function(){var e=this;this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.ID3,this,(function(t){void 0===t&&(t={});var n=t.sample?t.sample.data:t,i=n instanceof Uint8Array?String.fromCharCode.apply(String,D(n)):n,r=["PRIV","TXXX"].find((function(e){return i.includes(e)}))||null,a=Object.keys(e.id3MetadataOwner).map((function(t){return e.id3MetadataOwner[t]})).find((function(e){return i.includes(e)}))||null,s=a?i.substring(i.lastIndexOf(a)+a.length).trim().replace(/\0/g,""):null,o=new rs(r,a,s);e.emit(ss.timedMetadata,o)}))),this.alreadyStarted=!1,this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.PLAYING,this,(function(){P.trace("BAMTizenPlayerAdaptor Events.Player.PLAYING"),e.alreadyStarted?e.emit(ss.playing):(e.emit(ss.start),e.emit(ss.playing),e.alreadyStarted=!0)}))),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.TIME_UPDATE,this,(function(t){var n=t/1e3;e.emit(ss.currentTime,n)}))),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.PAUSE,this,(function(){P.trace("BAMTizenPlayerAdaptor Events.Player.PAUSE"),e.emit(ss.pause)}))),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.SEEKING,this,(function(){P.trace("BAMTizenPlayerAdaptor Events.Player.SEEKING"),e.emit(ss.seeking)}))),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.BUFFERING_START,this,(function(){P.trace("BAMTizenPlayerAdaptor Events.Player.BUFFERING_START"),e.emit(ss.stalled)}))),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.BUFFERING_END,this,(function(){P.trace("BAMTizenPlayerAdaptor Events.Player.BUFFERING_END"),e.emit(ss.playing)}))),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.COMPLETE,this,(function(){P.trace("BAMTizenPlayerAdaptor Events.Player.COMPLETE"),e.emit(ss.stop),e.cleanup()})))},t.prototype.stop=function(e){e&&P.warn("BAMTizenPlayerAdaptor.stop",e.message),this.nativePlayer.stop(),this.cleanup()},t.prototype.cleanup=function(){this.alreadyStarted=!1,this.unsubscribers.forEach((function(e){return"function"==typeof e&&e()})),this.unsubscribers=[]}}($),function(e){function t(t){var n=e.call(this)||this;return t?(n.nativePlayer=t,n.id3MetadataOwner=new is,n.bindEventListeners(),n):n}k(t,e),t.prototype.bindEventListeners=function(){this.loadCompleteHandler=this.loadCompleteHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.PLAYER_LOAD_COMPLETE,this.loadCompleteHandler),this.id3Handler=this.id3Handler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.ID3,this.id3Handler),this.mediaFinishedHandler=this.mediaFinishedHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.MEDIA_FINISHED,this.mediaFinishedHandler),this.timeUpdateHandler=this.timeUpdateHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.TIME_UPDATE,this.timeUpdateHandler),this.playingHandler=this.playingHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.PLAYING,this.playingHandler),this.pauseHandler=this.pauseHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.PAUSE,this.pauseHandler),this.stop=this.stop.bind(this)},t.prototype.loadCompleteHandler=function(e){P.debug("ChromecastPlayerAdaptor: PLAYER_LOAD_COMPLETE",e),this.emit(ss.start)},t.prototype.id3Handler=function(e){var t=this;if(P.debug("ChromecastPlayerAdaptor._id3Handler",e),e.detail&&(e.segmentData=e.detail),e.segmentData){var n=String.fromCharCode.apply(String,D(e.segmentData));P.trace("ChromecastPlayerAdaptor._id3Handler",n);var i=["PRIV","TXXX"].find((function(e){return n.includes(e)}))||null,r=Object.keys(this.id3MetadataOwner).map((function(e){return t.id3MetadataOwner[e]})).find((function(e){return n.includes(e)}))||null,a=r?n.substring(n.lastIndexOf(r)+r.length).trim().replace(/\0/g,""):null,s=new rs(i,r,a);P.trace("ChromecastPlayerAdaptor._id3Handler","tag:",i,"owner:",r,"dataValue:",a),this.emit(ss.timedMetadata,s)}},t.prototype.timeUpdateHandler=function(e){var t=e.currentMediaTime;this.emit(ss.currentTime,t)},t.prototype.playingHandler=function(e){var t=e.currentMediaTime;this.emit(ss.playing,t)},t.prototype.pauseHandler=function(e){var t=e.currentMediaTime;this.emit(ss.pause,t)},t.prototype.mediaFinishedHandler=function(e){P.debug("ChromecastPlayerAdaptor: MEDIA_FINISHED",e),this.emit(ss.stop),this.cleanup()},t.prototype.stop=function(e){e&&P.warn("ChromecastPlayerAdaptor.stop",e.message)},t.prototype.cleanup=function(){this.nativePlayer&&(this.nativePlayer.removeEventListener(cast.framework.events.EventType.PLAYER_LOAD_COMPLETE,this.loadCompleteHandler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.ID3,this.id3Handler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.MEDIA_FINISHED,this.mediaFinishedHandler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.TIME_UPDATE,this.timeUpdateHandler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.PAUSE,this.pauseHandler))}}($),function(e){function t(t){var n=e.call(this)||this;return n.nativePlayer=t,n.bindEventListeners(),n}k(t,e),t.prototype.bindEventListeners=function(){var e=this;this.nativePlayer?(this.onPlay=this.onPlay.bind(this),this.onPause=this.onPause.bind(this),this.onSeek=this.onSeek.bind(this),this.onCurrentTime=this.onCurrentTime.bind(this),this.onStalled=this.onStalled.bind(this),this.stop=this.stop.bind(this),this.onError=this.onError.bind(this),this.onLoadedMetadata=this.onLoadedMetadata.bind(this),this.cleanup=this.cleanup.bind(this),this.nativePlayer.addEventListener("play",this.onPlay),this.nativePlayer.addEventListener("pause",this.onPause),this.nativePlayer.addEventListener("seeking",this.onSeek),this.nativePlayer.addEventListener("ended",this.stop),this.nativePlayer.addEventListener("error",this.onError),this.nativePlayer.addEventListener("timeupdate",this.onCurrentTime),this.nativePlayer.addEventListener("stalled",this.onStalled),this.nativePlayer.addEventListener("loadedmetadata",this.onLoadedMetadata),this.nativePlayer.textTracks.onaddtrack=function(t){var n=t.track;n&&"metadata"===n.kind&&n.addEventListener("cuechange",(function(t){var n=t.target;if(n&&"metadata"===n.kind){for(var i=[],r=0;r<n.activeCues.length;r++){var a=n.activeCues[r];i.push(a.value)}i.map((function(t){var n=t.key,i=t.info,r=t.data;r instanceof ArrayBuffer&&(r=String.fromCharCode.apply(null,new Uint8Array(r)));var a=new rs(n,i,r);P.trace("HTML5PlayerAdaptor timedMetadata",a),e.emit(ss.timedMetadata,a)}))}}))}):P.error("Native Player wasn't passed to HTML5PlayerAdaptor")},t.prototype.onPlay=function(e){this.emit(ss.start,e.timeStamp)},t.prototype.onPause=function(e){this.emit(ss.pause,e.timeStamp)},t.prototype.onSeek=function(e){this.emit(ss.seeking,e.timeStamp)},t.prototype.onError=function(){this.emit(ss.stop),this.cleanup()},t.prototype.onCurrentTime=function(e){this.emit(ss.currentTime,e.timeStamp)},t.prototype.onStalled=function(e){this.emit(ss.stalled,e.timeStamp)},t.prototype.onLoadedMetadata=function(){var e=this.nativePlayer;this.emit(ss.loadedMetadata,{duration:e.duration,videoWidth:e.videoWidth,videoHeight:e.videoHeight})},t.prototype.stop=function(){this.nativePlayer.pause(),this.nativePlayer.setAttribute("src",""),this.nativePlayer.removeAttribute("src"),this.nativePlayer.currentTime=0,this.emit(ss.stop),this.cleanup()},t.prototype.cleanup=function(){this.nativePlayer.removeEventListener("play",this.onPlay),this.nativePlayer.removeEventListener("pause",this.onPause),this.nativePlayer.removeEventListener("error",this.onError),this.nativePlayer.removeEventListener("seeking",this.onSeek),this.nativePlayer.removeEventListener("stalled",this.onStalled),this.nativePlayer.removeEventListener("timeupdate",this.onCurrentTime),this.nativePlayer.removeEventListener("ended",this.stop),this.nativePlayer.removeEventListener("loadedmetadata",this.onLoadedMetadata)}}($);!function(e){e.opened="opened",e.playing="playing",e.ended="ended",e.timedMetadata="timedMetadata",e.error="error",e.timeUpdate="timeUpdate",e.stalled="stalled",e.paused="paused",e.seeking="seeking"}(as||(as={}));var cs,us,ls=as,ds=(function(e){function t(t,n){var i=e.call(this)||this;if(!t)throw new Error("nativePlayer must be supplied");return i.nativePlayer=t,i.bus=n,i.bindEventListeners(),i}k(t,e),t.prototype.bindEventListeners=function(){this.onSeeking=this.onSeeking.bind(this),this.onStalled=this.onStalled.bind(this),this.onTimeUpdate=this.onTimeUpdate.bind(this),this.onPlaying=this.onPlaying.bind(this),this.onPaused=this.onPaused.bind(this),this.onError=this.onError.bind(this),this.onEnded=this.onEnded.bind(this),this.onTimedMetadata=this.onTimedMetadata.bind(this),this.onOpened=this.onOpened.bind(this),this.bus?(this.bus.on(ls.opened,this.onOpened),this.bus.on(ls.playing,this.onPlaying),this.bus.on(ls.paused,this.onPaused),this.bus.on(ls.timedMetadata,this.onTimedMetadata),this.bus.on(ls.ended,this.onEnded),this.bus.on(ls.error,this.onError),this.bus.on(ls.timeUpdate,this.onTimeUpdate),this.bus.on(ls.stalled,this.onStalled),this.bus.on(ls.seeking,this.onSeeking)):(this.nativePlayer.onOpened=this.onOpened,this.nativePlayer.onPlaying=this.onPlaying,this.nativePlayer.onTimedMetadata=this.onTimedMetadata,this.nativePlayer.onEnded=this.onEnded,this.nativePlayer.onError=this.onError,this.nativePlayer.onTimeUpdate=this.onTimeUpdate,this.nativePlayer.onStalled=this.onStalled,this.nativePlayer.onSeeking=this.onSeeking)},t.prototype.onSeeking=function(){var e=this.nativePlayer.currentTime;P.debug("TrilithiumPlayerAdaptor.onSeeking",e),this.emit(ss.seeking,e)},t.prototype.onStalled=function(){var e=this.nativePlayer.currentTime;P.debug("TrilithiumPlayerAdaptor.onStalled",e),this.emit(ss.stalled,e)},t.prototype.onTimeUpdate=function(){var e=this.nativePlayer.currentTime;P.debug("TrilithiumPlayerAdaptor.onTimeUpdate",e),this.emit(ss.currentTime,e)},t.prototype.onError=function(e){P.debug("TrilithiumPlayerAdaptor.onError",e),this.emit(ss.stop),this.cleanup()},t.prototype.onEnded=function(){this.emit(ss.stop),this.cleanup()},t.prototype.onTimedMetadata=function(e,t,n){var i=t,r=n.toString(),a=U.stringify(L.parse(n.toString("base64"))),s=r?a.substring(a.lastIndexOf(r)+r.length).trim().replace(/\0/g,""):a;P.debug("TrilithiumPlayerAdaptor.onTimedMetadata "+i+" "+r+" "+s);var o=new rs(i,r,s);this.emit(ss.timedMetadata,o)},t.prototype.onOpened=function(e){e&&(P.debug("TrilithiumPlayerAdaptor.onOpened"),this.emit(ss.start))},t.prototype.onPlaying=function(){var e=this.nativePlayer.currentTime;P.debug("TrilithiumPlayerAdaptor.onPlaying",e),this.emit(ss.playing,e)},t.prototype.onPaused=function(){var e=this.nativePlayer.currentTime;P.debug("TrilithiumPlayerAdaptor.onPaused",e),this.emit(ss.pause,e)},t.prototype.stop=function(e){e&&P.warn("TrilithiumPlayerAdaptor.stop",e.message)},t.prototype.cleanup=function(){this.bus&&(this.bus.off(ls.opened),this.bus.off(ls.playing),this.bus.off(ls.timedMetadata),this.bus.off(ls.ended),this.bus.off(ls.error),this.bus.off(ls.timeUpdate),this.bus.off(ls.stalled))}}($),6),hs=7,ps=11,fs=12,ms=(function(e){function t(t){var n=e.call(this)||this;return n.nativePlayer=t,n.id3MetadataOwner=new is,n}k(t,e),t.prototype.onTimedMetaData=function(e){var t=this,n=e.data,i=String.fromCharCode.apply(null,n),r=["PRIV","TXXX"].find((function(e){return i.includes(e)}))||null,a=Object.keys(this.id3MetadataOwner).map((function(e){return t.id3MetadataOwner[e]})).find((function(e){return i.includes(e)}))||null,s=a?i.substring(i.lastIndexOf(a)+a.length).trim().replace(/\0/g,""):null,o=new rs(r,a,s);P.trace("AampUvePlayerAdapter timedMetadata",o),this.emit(ss.timedMetadata,o)},t.prototype.onPlaybackStateChanged=function(e){switch(e.state){case ds:this.emit(ss.pause);break;case hs:this.emit(ss.seeking);break;case fs:case ps:this.emit(ss.stop),this.cleanup()}},t.prototype.onPlay=function(){this.emit(ss.start)},t.prototype.onCurrentTime=function(e){this.emit(ss.currentTime,e.positionMiliseconds)},t.prototype.onError=function(){this.emit(ss.stop),this.cleanup()},t.prototype.stop=function(){this.emit(ss.stop),this.cleanup()},t.prototype.cleanup=function(){}}($),function(){function e(e,t,n){var i=this;this.adobeConcurrencyBuilder=n,this.session=e,this.playerAdaptor=t,this.adobeConcurrencyBuilder&&this.initConcurrencyMonitor(),this.initProgramChangeMonitor(),this.playerAdaptor.on(ss.start,(function(){P.debug("PlaybackManager.start"),i.programChangeMonitor.start()})),this.playerAdaptor.on(ss.stop,(function(){P.debug("PlaybackManager.stop"),i.cleanup()}))}return e.prototype.initConcurrencyMonitor=function(){var e=this,t=this.session,n=t.concurrencyMonitorSessionId,i=this.adobeConcurrencyBuilder.withSession(t).build();i&&(t.concurrencyMonitorSessionId&&i.startWithSession(n),i.onError=function(t,n){e.playerAdaptor.stop(t),e.onStop(t),n&&e.onDeauthenticate(Ta.mvpd)},this.adobeConcurrencyMonitor=i)},e.prototype.initProgramChangeMonitor=function(){var e=this,t=new Qa,n=new Xa(this.session.mediaItem,t);n.onProgramChange=function(t){var n=e.session.token,i=t.mrss;if(n){var r=e.shield;r?r.getAsset(t.id,n,"GATEKEEPER",i,{}).then((function(n){n&&(e.session.mediaItem=t,e.session.token=n.gatekeeperToken,e.nielsenTrackingManager&&(e.nielsenTrackingManager.mediaItem=t),e.onUpdatedMediaItem(t))})).catch((function(t){e.playerAdaptor.stop(t),e.onStop(t)})):P.warn("shield support not configured")}else P.warn("token missing. skipping program change re-auth.")},this.programChangeMonitor=n},e.prototype.cleanup=function(){P.debug("PlaybackManager.cleanup"),this.playerAdaptor.off(ss.start),this.playerAdaptor.off(ss.stop),this.adobeConcurrencyMonitor&&this.adobeConcurrencyMonitor.stop(),this.programChangeMonitor&&this.programChangeMonitor.stop(),this.nielsenTrackingManager&&this.nielsenTrackingManager.stop()},e.prototype.onDeauthenticate=function(e){},e.prototype.onUpdatedMediaItem=function(e){},e.prototype.onStop=function(e){},e}()),ys=function(e){function n(e,i,r,a){var o;s(this,n);var c=ie.apiKey;(o=t(this,n,[e,i,r])).nielsenTrackingManager=a;var u=new An,l=function(){var e={apiKey:c,serviceUrl:An.defaultServiceUrl},t=Q.shared.getConfiguration("shield",e);u.apiKey=t.apiKey,u.serviceUrl=t.serviceUrl};return l(),Q.shared.on(Y,l),o.shield=u,o}return d(n,e),c(n)}(ms),gs=w((function(e,t){var n;e.exports=(n=n||function(e,t){var n=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),i={},r=i.lib={},a=r.Base={extend:function(e){var t=n(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=r.WordArray=a.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,n=e.words,i=this.sigBytes,r=e.sigBytes;if(this.clamp(),i%4)for(var a=0;a<r;a++){var s=n[a>>>2]>>>24-a%4*8&255;t[i+a>>>2]|=s<<24-(i+a)%4*8}else for(a=0;a<r;a+=4)t[i+a>>>2]=n[a>>>2];return this.sigBytes+=r,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=a.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n,i=[],r=function(t){t=t;var n=987654321,i=4294967295;return function(){var r=((n=36969*(65535&n)+(n>>16)&i)<<16)+(t=18e3*(65535&t)+(t>>16)&i)&i;return r/=4294967296,(r+=.5)*(e.random()>.5?1:-1)}},a=0;a<t;a+=4){var o=r(4294967296*(n||e.random()));n=987654071*o(),i.push(4294967296*o()|0)}return new s.init(i,t)}}),o=i.enc={},c=o.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],r=0;r<n;r++){var a=t[r>>>2]>>>24-r%4*8&255;i.push((a>>>4).toString(16)),i.push((15&a).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i+=2)n[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new s.init(n,t/2)}},u=o.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],r=0;r<n;r++){var a=t[r>>>2]>>>24-r%4*8&255;i.push(String.fromCharCode(a))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i++)n[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new s.init(n,t)}},l=o.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},d=r.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,i=n.words,r=n.sigBytes,a=this.blockSize,o=r/(4*a),c=(o=t?e.ceil(o):e.max((0|o)-this._minBufferSize,0))*a,u=e.min(4*c,r);if(c){for(var l=0;l<c;l+=a)this._doProcessBlock(i,l);var d=i.splice(0,c);n.sigBytes-=u}return new s.init(d,u)},clone:function(){var e=a.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),h=(r.Hasher=d.extend({cfg:a.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new h.HMAC.init(e,n).finalize(t)}}}),i.algo={});return i}(Math),n)}));w((function(e,t){var n,i,r,a,s,o,c,u;e.exports=(i=(n=u=gs).lib,r=i.WordArray,a=i.Hasher,s=n.algo,o=[],c=s.SHA1=a.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,i=n[0],r=n[1],a=n[2],s=n[3],c=n[4],u=0;u<80;u++){if(u<16)o[u]=0|e[t+u];else{var l=o[u-3]^o[u-8]^o[u-14]^o[u-16];o[u]=l<<1|l>>>31}var d=(i<<5|i>>>27)+c+o[u];d+=u<20?1518500249+(r&a|~r&s):u<40?1859775393+(r^a^s):u<60?(r&a|r&s|a&s)-1894007588:(r^a^s)-899497514,c=s,s=a,a=r<<30|r>>>2,r=i,i=d}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+a|0,n[3]=n[3]+s|0,n[4]=n[4]+c|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;return t[i>>>5]|=128<<24-i%32,t[14+(i+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(i+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}}),n.SHA1=a._createHelper(c),n.HmacSHA1=a._createHmacHelper(c),u.SHA1)})),w((function(e,t){var n,i,r;e.exports=(i=(n=gs).lib.Base,r=n.enc.Utf8,void(n.algo.HMAC=i.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=r.parse(t));var n=e.blockSize,i=4*n;t.sigBytes>i&&(t=e.finalize(t)),t.clamp();for(var a=this._oKey=t.clone(),s=this._iKey=t.clone(),o=a.words,c=s.words,u=0;u<n;u++)o[u]^=1549556828,c[u]^=909522486;a.sigBytes=s.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})))})),w((function(e,t){e.exports=gs.HmacSHA1})),w((function(e,t){var n,i,r;e.exports=(i=(n=r=gs).lib.WordArray,n.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,i=this._map;e.clamp();for(var r=[],a=0;a<n;a+=3)for(var s=(t[a>>>2]>>>24-a%4*8&255)<<16|(t[a+1>>>2]>>>24-(a+1)%4*8&255)<<8|t[a+2>>>2]>>>24-(a+2)%4*8&255,o=0;o<4&&a+.75*o<n;o++)r.push(i.charAt(s>>>6*(3-o)&63));var c=i.charAt(64);if(c)for(;r.length%4;)r.push(c);return r.join("")},parse:function(e){var t=e.length,n=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var a=0;a<n.length;a++)r[n.charCodeAt(a)]=a}var s=n.charAt(64);if(s){var o=e.indexOf(s);-1!==o&&(t=o)}return function(e,t,n){for(var r=[],a=0,s=0;s<t;s++)if(s%4){var o=n[e.charCodeAt(s-1)]<<s%4*2,c=n[e.charCodeAt(s)]>>>6-s%4*2;r[a>>>2]|=(o|c)<<24-a%4*8,a++}return i.create(r,a)}(e,t,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},r.enc.Base64)}));!function(e){e.abc="abc",e.abcNews="abcnews",e.abcNewsLive="abcnewslive",e.abcOtv="abcotv",e.cricinfo="cricinfo",e.disney="dch",e.disneyJr="djr",e.disneyXD="dxd",e.disneyNow="dnow",e.espn="espn",e.espnFantasy="espnFantasy",e.fiveThirtyEight="fivethirtyeight",e.foxLatam="foxlatam",e.freeform="ff",e.fxNow="fxnow",e.fx="fx",e.fxm="fxm",e.fxx="fxx",e.oscar="oscar",e.marvel="marvel",e.natGeoTV="ngtv",e.natGeo="ngc",e.natGeoWild="ngw",e.natgeoBrasil="natgeobrasil",e.theUndefeated="theundefeated",e.fast="fast",e.unknown="000"}(cs||(cs={})),function(e){e.mvpd="mvpd",e.isp="isp",e.tve="tve"}(us||(us={}));var vs=us;const bs={};bs[vs.mvpd]="adobeId",bs[vs.isp]="ispId",bs[vs.tve]="id";const _s=["ADOBEPASS","AUTHTOKEN","GATEKEEPER","JWT","SESSIONTOKEN"],ws=e=>(e=>_s.includes(e))(e)?we.mvpd:"DEVICE"===e?we.isp:"BAM"===e?we.direct:null;var Ps;!function(e){e.willStartPlaying="atv.player.willStartPlaying",e.didStopPlaying="atv.player.didStopPlaying",e.onTimedMetadataChanged="atv.player.onTimedMetadataChanged",e.playerStateChanged="atv.player.playerStateChanged",e.playerTimeDidChange="atv.player.playerTimeDidChange"}(Ps||(Ps={}));var Is,Ss,Ts,As=Ps;!function(e){e.priv="PRIV",e.txxx="TXXX"}(Is||(Is={})),function(e){e.program="PROGRAM",e.commercial="COMMERCIAL",e.slate="SLATE"}(Ss||(Ss={}));class ks{constructor(e="com.espn.authnet.heartbeat",t="com.espn.authnet.transition",n="www.nielsen.com"){this.heartbeat=e,this.transition=t,this.nielsenWatermark=n}}class Es{constructor(e,t){this.type=e,this.id=t}isContent(){return this.type!==Ss.slate&&this.type!==Ss.commercial}}class Cs{constructor(e,t,n){this.tag=e,this.owner=t,this.dataValue=n}}!function(e){e.start="start",e.playing="playing",e.pause="pause",e.seeking="seeking",e.seeked="seeked",e.stalled="stalled",e.stop="stop",e.timedMetadata="timedMetadata",e.currentTime="currentTime",e.loadedMetadata="loadedMetadata"}(Ts||(Ts={}));var Ms,Os=Ts;class Ds{constructor(e,t){this.certificateUrl=t,this.requests=[],this.bindSecureKeyDelivery(e||atv.secureKeyDelivery||{})}bindSecureKeyDelivery(e){e.fetchCertificate=this.fetchCertificate.bind(this),e.fetchAssetID=this.fetchAssetID.bind(this),e.fetchKeys=this.fetchKeys.bind(this),e.cancelAllRequests=this.cancelAllRequests.bind(this)}fetchCertificate(e,t){P.debug("AtvlVdmsSecureKeyDelivery.fetchCertificate",e);const n=this.certificateUrl;if(!n)return void t.failure("invalid certificate url");const i=new XMLHttpRequest;i.open("GET",n),i.onreadystatechange=()=>{if(4===i.readyState){if(200===i.status){const e=i.responseDataAsBase64;P.debug("AtvlVdmsSecureKeyDelivery.fetchCertificate responseDataAsBase64:",e),t.success(e)}else t.failure(i.status);this.requests.splice(this.requests.indexOf(i),1)}},this.requests.push(i),i.send(null)}fetchAssetID(e,t){const n=/[?&]c=([^&]+)&*/.exec(e);if(!n||n.length<2)return void t.failure("Error parsing assetId "+e);const i=n[1];P.debug("AtvlVdmsSecureKeyDelivery.fetchAssetID",e,i),t.success(i,!1)}fetchKeys(e,t,n){const i=e.replace("skd://","https://"),r=JSON.stringify({spc:t});P.debug("AtvlVdmsSecureKeyDelivery.fetchKeys",i);const a=new XMLHttpRequest;a.open("POST",i),a.setRequestHeader("Content-Type","application/json"),a.onreadystatechange=()=>{if(4===a.readyState){if(200===a.status)try{const e=JSON.parse(a.responseText),{ckc:t}=e;n.success(t)}catch(e){n.failure("invalid JSON")}else n.failure(a.status);this.requests.splice(this.requests.indexOf(a),1)}},this.requests.push(a),a.send(r)}cancelAllRequests(){P.debug("AtvlVdmsSecureKeyDelivery.cancelAllRequests",this.requests.length),this.requests.forEach(e=>{e.abort&&e.abort()}),this.requests=[]}}!function(e){e.opened="opened",e.playing="playing",e.ended="ended",e.timedMetadata="timedMetadata",e.error="error",e.timeUpdate="timeUpdate",e.stalled="stalled",e.paused="paused",e.seeking="seeking"}(Ms||(Ms={}));var Ns,Ls=Ms;!function(e){e.localStorage="LOCAL_STORAGE",e.sessionStorage="SESSION_STORAGE"}(Ns||(Ns={}));var Us,js=function(){function e(e,t,n,i){this.id=e,this.name=t,this.logoUrl=n,this.websiteUrl=i}return e.prototype.toString=function(){return"<AuthenticatedProvider id:"+this.id+", name:"+this.name+", logoUrl:"+this.logoUrl+", websiteUrl:"+this.websiteUrl+">"},e.fromObject=function(t){return new e(t.id,t.name,t.logoUrl,t.websiteUrl)},e}();!function(e){e.token="token",e.tokenType="tokenType",e.resource="resource",e.requestor="requestor",e.fullToken="fullToken",e.zipcode="zipcode",e.mvpd="mvpd"}(Us||(Us={}));var Fs,Rs,xs=function(){function e(e,t,n,i){void 0===i&&(i={}),this.authenticationType=e,this.authenticatedProvider=t,this.authenticatedIdentity=n,this.customData=i}return e.CustomDataKey=Us,e}(),Hs=function(e,t){this.success=e,this.payload=t};!function(e){e.standard="default",e.googleAdManager="gam"}(Fs||(Fs={})),function(e){e.standard="default",e.prod="prod",e.development="dev"}(Rs||(Rs={}));Object.freeze({}),Object.freeze("");var Bs,zs=new function(e,t){void 0===t&&(t="entitlements"),this.serviceUrl=e,this.entitlementsPath=t}("https://tve.dtci.technology","entitlements");!function(e){e.badToken="badToken",e.other="other"}(Bs||(Bs={}));var Vs,Ks=function(){function e(e,t){void 0===t&&(t="entitlements"),this.serviceUrl=e,this.entitlementsPath=t}return e.prototype.getEntitlements=function(e){return C(this,void 0,void 0,(function(){var t,n,i,r,a;return M(this,(function(s){switch(s.label){case 0:t=this.serviceUrl+"/"+this.entitlementsPath,n={user_token:e},i=Object.keys(n).map((function(e){return e+"="+encodeURIComponent(n[e])})).join("&"),r={method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:i},s.label=1;case 1:return s.trys.push([1,4,,5]),[4,T(t,r)];case 2:return[4,s.sent().json()];case 3:return[2,s.sent()];case 4:return a=s.sent(),console.error("Error retrieving Entitlements from DTCITVEntitlementAPI: "+a),[3,5];case 5:return[2]}}))}))},e.prototype.logout=function(e,t,n){return C(this,void 0,void 0,(function(){var i,r,a,s,o;return M(this,(function(c){switch(c.label){case 0:i=this.serviceUrl+"/affiliates/"+e+"/logout",r={user_token:t},n&&(r.redirect_uri=n),a=Object.keys(r).map((function(e){return e+"="+encodeURIComponent(r[e])})).join("&"),s={method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:a},c.label=1;case 1:return c.trys.push([1,3,,4]),[4,T(i,s)];case 2:return c.sent(),[2,!0];case 3:return o=c.sent(),console.error("Error logging out of affiliate account DTCITVEntitlementAPI: "+o),[2,!1];case 4:return[2]}}))}))},e.prototype.tokenIsValid=function(e){try{var t=function(e){var t=e.split("."),n=U.stringify(L.parse(t[1]));return JSON.parse(n)}(e);if(!t.exp)return!0;var n=new Date;return!(new Date(1e3*t.exp)<n)}catch(e){return!1}},e}();!function(e){e[e.all=0]="all",e[e.linearPlayback=1]="linearPlayback"}(Vs||(Vs={}));var Gs,qs=Vs;!function(e){e.linear="linear",e.event="event"}(Gs||(Gs={}));var $s,Ws=Gs;!function(e){e.stitchedPreroll="stitchedPreroll"}($s||($s={}));var Js,Ys=$s;!function(e){e.live="live",e.onDemand="onDemand"}(Js||(Js={}));var Qs,Xs=Js;!function(e){e.nielsen="nielsen",e.comscore="comscore",e.conviva="conviva",e.heartbeats="heartbeats"}(Qs||(Qs={}));var Zs,eo=Qs;!function(e){e.shortform="shortform",e.longform="longform"}(Zs||(Zs={}));var to,no=Zs;!function(e){e.audio="audio",e.video="video"}(to||(to={}));var io,ro=to;!function(e){e.pluto="pluto",e.graphQL="graphQL",e.cfa="cfa",e.itemFeed="itemFeed"}(io||(io={}));var ao,so=io;!function(e){e.open="OPEN",e.direct="DIRECT",e.mvpd="MVPD",e.isp="ISP",e.none="NONE"}(ao||(ao={}));var oo,co=ao;!function(e){e.none="none",e.startSession="startSession",e.bam="bam",e.shield="shield",e.entitlement="entitlement"}(oo||(oo={}));var uo=oo,lo=function(){function e(e,t,n,i,r,a,s,o){this.url=e,this.type=t,this.hasEspnId3Heartbeats=n,this.hasNielsenWatermarks=i,this.hasPassThroughAds=r,this.commercialReplacement=a,this.startSessionUrl=s,this.variant=o}return e.fromObject=function(t){if(!t)return null;var n=t.url,i=t.type,r=t.hasEspnId3Heartbeats,a=t.hasNielsenWatermarks,s=t.hasPassThroughAds,o=t.commercialReplacement,c=t.startSessionUrl,u=t.variant;return new e(n,uo[i],r,a,s,o,c,u)},e}(),ho=function(){function e(e,t,n,i){this.id=e,this.type=t,this.name=n,this.resource=i}return e.fromObject=function(t){if(!t)return null;var n=Ws[t.type];return new e(t.id,n,t.name,t.resource)},e}(),po=function(){function e(e){this.url=e}return e.fromObject=function(t){return t&&t.url?new e(t.url):null},e}(),fo=function(){function e(e){this.name=e}return Object.defineProperty(e.prototype,"logoUrl",{get:function(){return"https://secure.espncdn.com/watchespn/images/espnplus/packages/"+this.name+".png"},enumerable:!1,configurable:!0}),e.fromObject=function(t){return t?new e(t.name):null},e}(),mo=function(){function e(e,t,n,i,r){this.id=e,this.title=t,this.duration=n,this.language=i||"en",this.source=r,this.description=null,this.authenticationTypes=[],this.mrss=null,this.seekInSeconds=null,this.tracking={},this.references={},this.network=null,this.streamType=null,this.supportedMediaCommands=qs.all,this.images=[],this.type=ro.video,this.packages=[],this.tier=null,this.entityType=null,this.isSyndicatable=null,this.brand=null,this.apiSource=null,this.adUnitId=null,this.cues=null,this.adTarget=null,this.show=null}return Object.defineProperty(e.prototype,"isLinear",{get:function(){return!!this.network&&this.network.type===Ws.linear},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLive",{get:function(){return this.streamType===Xs.live},enumerable:!1,configurable:!0}),e.fromObject=function(t){var n=lo.fromObject(t.source),i=new e(t.id,t.title,t.duration,t.language,n);return i.airDate=t.airDate,i.apiSource=t.apiSource,i.authenticationTypes=t.authenticationTypes,i.description=t.description,i.images=(t.images||[]).map((function(e){return po.fromObject(e)})),i.mrss=t.mrss,i.network=ho.fromObject(t.network),i.seekInSeconds=t.seekInSeconds,i.streamType=Xs[t.streamType],i.supportedMediaCommands=t.supportedMediaCommands,i.tracking=t.tracking,i.references=t.references,i.packages=(t.packages||[]).map((function(e){return fo.fromObject(e)})),i.tier=t.tier,i.type=ro[t.type],i.entityType=no[t.entityType],i.isSyndicatable=t.isSyndicatable,i.brand=t.brand,i.adUnitId=t.adUnitId,i.cues=t.cues,i.show=t.show,i.adTarget=t.adTarget,i.availableDate=t.availableDate,i.episodeNumber=t.episodeNumber,i.locale=t.locale,i.seasonNumber=t.seasonNumber,i.tmsid=t.tmsid,i.videoShowGenre=t.videoShowGenre,i},e.prototype.toString=function(){return"<MediaItem id:"+this.id+", title:"+this.title+", streamType:"+this.streamType+">"},e}();var yo,go=function(){function e(e){var t=function(e){var t=e.split("?")[1],n={};if(t)for(var i=t.split("&"),r=0;r<i.length;r+=1){var a=i[r].split("=");n[a[0]]=a[1]}return n}(e);if(this.original=e,this.id=t.videoID||t.playID||t.clip||t.externalId,e.match("sportscenter")){this.gameId=t.playGameID,this.channel=t.playChannel,this.simulcastAiringId=t.simulcastAiringId;var n=parseInt(t.resumeTime,10);isNaN(n)||(this.resumeTime=n),this.eventId=t.eventId}else e.match("abcnews")&&(this.channel=t.playChannel,this.id=t.videoID||t.id);this.source=t["x-source"],t.videoID?this.entityType=no.shortform:this.entityType=no.longform,this.type=ro.video}return e.prototype.toString=function(e){return e==so.graphQL?"<MediaItemIdentifier id:"+this.id+", gameId:"+this.gameId+", channel:"+this.channel+", source:"+this.source+">":"<MediaItemIdentifier id:"+this.id+", source:"+this.source+">"},e.identifierStringForNetwork=function(e,t){switch(t){case so.cfa:return"natgeo://playVideo?videoID="+e;case so.itemFeed:return"abcnews://playVideo?playChannel="+e;case so.graphQL:default:return"sportscenter://x-callback-url/showWatchStream?playChannel="+e}},e}();function vo(e,t,n,i){if(!t)return{};var r,a,s,o=null;e===yo.natGeo?o=function(e){if(!e)return{};var t={},n=e.id,i=e.title,r=e.duration;return t.c_video_id_code=n,t.c_a_media_airdate="unknown",t.c_a_media_daypart="daytime",t.c_a_media_digitaldate="unknown",t.c_a_media_episode="none",t.c_a_media_feed="natgeo live",t.c_a_media_format="vod",t.c_a_media_genre="none",t.c_a_media_network="natgeo",t.c_a_media_originator="natgeo",t.c_a_media_pass_auth="none",t.c_a_media_pass_mvpd="none",t.c_a_media_rating="none",t.c_a_media_season="none",t.c_a_media_show=i,t.c_a_media_streamtype=to.video,t.c_a_media_length=r,t}(t):(r=function(e,t,n){if(!e)return{};var i=e.duration,r=e.id,a=e.league,s=e.name,o=e.network,c=e.program,u=e.sport,l=e.startDateTime,d=e.tracking,h="1";n&&!0===n.hasEspnId3Heartbeats&&!1===n.hasPassThroughAds&&"SHARED INV"!==n.commercialReplacement&&(h="2");var p={type:"content"};if(p.assetid=d&&d.trackingId||r,p.program=s,p.title=s,p.clientid="us-600140",t===no.longform){if(p.length=""+i,p.segB=a&&a.name||"No League",p.segC=""+(c&&c.code||"")+(u&&u.code||""),l){var f=new Date(l);p.airdate=f.getUTCFullYear().toString()+("0"+f.getUTCMonth()).slice(-2)+("0"+f.getUTCDate()).slice(-2)+" "+("0"+f.getUTCHours()).slice(-2)+":"+("0"+f.getUTCMinutes()).slice(-2)+":"+("0"+f.getUTCSeconds()).slice(-2)}p.isfullepisode="y",p.crossId1=d&&d.nielsenCrossId1||"",p.crossId2=o&&o.name||"",p.adloadtype=h,p.hasAds="1",p.progen="SE",p.vcid="b01"}return t===no.shortform&&(p.accmethod="1",p.length=""+i,p.segA=s,p.segB="No League",p.segC="VOD",p.isfullepisode="n",p.crossId1="",p.adloadtype="1",p.vcid="c17",p.adloadtype="2"),p}(t,n,i),a=function(e,t){if(!e)return{};var n=e.id,i=e.duration,r=e.name,a=e.league,s=e.startDateTime,o=e.network,c=e.sport,u=e.status,l=e.tracking,d={};if(t===no.longform)d.ns_st_cl=0,d.ns_st_ct="vc",!u||"live"!==u.toLowerCase()&&"over"!==u.toLowerCase()?(d.ns_st_cl=i,d.ns_st_ct="vc12",d.ns_st_pr="VOD",d.ns_st_ep=r):(d.ns_st_cl=0,d.ns_st_ct="vc13",d.ns_st_pr=r,d.ns_st_ep="*null"),d.c3="WATCHESPNLIVE",d.c6=a&&a.name?a||"No league":c&&c.code||"No Sport";else{d.ns_st_cl=i,d.ns_st_ct="vc11",d.ns_st_pr="VOD",d.ns_st_ep=r;var h=l||{},p=h.sportName,f=h.leagueName;d.c3="vod",d.c6=""+(f&&"no league"!==f.toLowerCase()?f:p||"No Sport")}if(d.ns_st_ti="*null",d.ns_st_ia="*null",d.ns_st_ce="*null",d.ns_st_ci=n,s){var m=new Date(s);d.ns_st_ddt=m.toDateString(),d.ns_st_tdt=m.toDateString()}return d.ns_st_st=o?o.id:"*null",d.ns_st_en="*null",d.ns_st_cn="1",d.ns_st_pn="1",d.ns_st_tp="1",d.ns_st_pu="ESPN",d.ns_st_cu="none",d.ns_st_ad="0",d.ns_st_ge="Sports",d}(t,n),s=function(e,t,n){if(!e)return{};var i=e.name,r=e.id,a=e.airingId,s=e.eventId,o=e.duration,c=e.network,u=e.status,l=e.sport,d=e.league,h={};h.contentId=r,a&&(h.airingId=a),s&&(h.eventId=""+s,h.eventName=i),c&&(h.network=c.id),t===no.shortform?h.assetType="clip":!u||"live"!==u.toLowerCase()&&"over"!==u.toLowerCase()?h.assetType="vod":h.assetType="live";var p=i+" - "+r;return c&&c.type===Ws.linear&&"live"===h.assetType&&(p=c.id),h.sport=l&&l.name||"Not Applicable",h.league=d&&d.name||"Not Applicable",h.appBrand=yo.espn,{assetName:p,duration:o,streamUrl:n&&n.url,custom:h}}(t,n,i),o=function(e,t){if(!e)return{};var n=e.duration,i=e.airingId,r=e.network,a=e.status,s=e.sport,o=e.league,c=e.name,u=e.program,l=e.startDateTime,d=e.tracking,h=e.originalPublishDate,p=e.expirationDate,f=e.lastModifiedDate,m=e.ad,y=e.coverageType,g=e.brands,v={};if(v.ContentDuration=n,t===no.longform){if(v.CMSID=d&&d.name||c,v.isFullEpisode="y",i&&(v.AiringID=i),r&&(v.NetworkName=r.id,v.Channel=r.id),a&&(v.VideoType="REPLAY"===a?"replay":"live"),v.Sport=s&&s.name||"Not Applicable",v.SportCode=s&&s.code||"Not Applicable",v.League=o&&o.name||"Not Applicable",u&&u.code&&u.categoryCode?v.ProgramCode=u.categoryCode+u.code:v.ProgramCode="Not Applicable",v.IsStudio=u&&u.isStudio||"Not Applicable",l){var b=new Date(l);v.AirDate=b.toDateString(),v.AirTime=b.toTimeString()}if(Array.isArray(g)&&g.length){var _=g[0],w=_.id,P=_.name,I=_.type;v["a.media.asset"]=w,v["a.media.show"]=P,v["a.media.genre"]=I}}else if(t===no.shortform){if(v.isFullEpisode="n",v.VideoType="vod",v.Sport=d&&d.sportName||"Not Applicable",v.League=d&&d.leagueName||"Not Applicable",v.ShowCode=m&&m.bundle||"Not Applicable",d&&d.name&&(v.CMSID=d.name),h){b=new Date(h);v.PublishDate=b.toISOString().substring(0,10),v.PublishTime=b.toISOString().substring(11)}if(p){b=new Date(p);v.ExpirationDate=b.toISOString()}if(f){b=new Date(f);v.DateLastModified=b.toISOString()}y&&(v.VideoTypeDetail=y)}return v}(t,n));var c={};return c[eo.nielsen]=r,c[eo.comscore]=a,c[eo.conviva]=s,c[eo.heartbeats]=o,c}function bo(e,t,n){return e.sort((function(e,t){var n="PRIMARY"===e.tier?0:"SECONDARY"===e.tier?1:2,i="PRIMARY"===t.tier?0:"SECONDARY"===t.tier?1:2;return n<i?-1:n>i?1:0})).sort((function(e,n){var i=e.network&&e.network.id.toLowerCase()||"unknown",r=n.network&&n.network.id.toLowerCase()||"unknown",a=t.indexOf(i),s=t.indexOf(r);return-1===a&&(a=999),-1===s&&(s=999),a<s?-1:a>s?1:0})).sort((function(e,t){var i=e.language===n?0:1,r=t.language===n?0:1;return i<r?-1:i<r?1:0}))}!function(e){e.abc="abc",e.abcNews="abcnews",e.abcNewsLive="abcnewslive",e.abcOtv="abcotv",e.cricinfo="cricinfo",e.disney="dch",e.disneyJr="djr",e.disneyXD="dxd",e.disneyNow="dnow",e.espn="espn",e.espnFantasy="espnFantasy",e.fiveThirtyEight="fivethirtyeight",e.foxLatam="foxlatam",e.freeform="ff",e.fxNow="fxnow",e.fx="fx",e.fxm="fxm",e.fxx="fxx",e.oscar="oscar",e.marvel="marvel",e.natGeoTV="ngtv",e.natGeo="ngc",e.natGeoWild="ngw",e.natgeoBrasil="natgeobrasil",e.theUndefeated="theundefeated",e.unknown="000"}(yo||(yo={}));var _o=["espn_ppv","espn_dtc","espn1","espn2","espn3","espnu","sec","espnews","espndeportes","longhorn","goalline","buzzerbeater","secplus","acc","accextra","espn_free","bam_dtc"],wo=function(e,t,n,i){e==so.graphQL?(this.serviceUrl=t||"https://watch.graph.api.espn.com/api",this.apiKey=n||"d15c5790-7cb0-4fe1-8782-25f4698d0739",this.networkSortOrder=i||_o):e==so.cfa?this.serviceUrl=t||"https://natgeo.entertainment.client.dtci.technology/v1/playback/video/id/mock":e===so.itemFeed&&(this.serviceUrl=t||"https://abcnews.go.com/video/itemfeed")},Po=function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return M(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var r,a,s,o,c,u;return M(this,(function(l){switch(l.label){case 0:return r=t.map((function(e){return new go(e)})),a=i.serviceUrl,s=i.apiKey,o=i.networkSortOrder,[4,S.all(r.map((function(t){return e.getPromiseMediaItems(t,a,s,n)})))];case 1:return c=l.sent(),(u=c.filter((function(e){return!(e instanceof Error)&&e instanceof mo}))).length?[2,bo(u,o,navigator.language)]:[2,null]}}))}))},e.getPromiseMediaItems=function(t,n,i,r){return C(this,void 0,void 0,(function(){var a,s,o,c,u,l,d,h,p,f,m,y;return M(this,(function(g){switch(g.label){case 0:a=function(e,t,n,i){var r="",a="",s="",o=i||"US";return e.entityType===no.shortform?(r="VOD",s="{id name description authTypes language duration originalPublishDate expirationDate requiresLinearPlayback lastModifiedDate source { url authorizationType } image { url } tracking { name sportName leagueName } coverageType prerollSource:source(variant:PREROLL) { url authorizationType }ad { sport bundle } links { web } cerebroId syndicatable}",a='id:"'+e.id+'"'):(r="airing",s="{ id name description mrss:adobeRSS authTypes requiresLinearPlayback status:type startDateTime endDateTime duration source(authorization: SHIELD) { url authorizationType hasEspnId3Heartbeats hasNielsenWatermarks hasPassThroughAds commercialReplacement startSessionUrl } network { id type name adobeResource } image { url } sport { name code uid } league { name uid } program { code categoryCode isStudio } seekInSeconds simulcastAiringId airingId tracking { nielsenCrossId1 trackingId } eventId packages { name } language tier feedName brands { id name type } }",e.id?a='id:"'+e.id+'"':e.channel?(r="airings",a='networks:["'+e.channel+'"],type:LIVE'):e.gameId&&(r="airings",a='eventId:"'+(e.eventId||e.gameId)+'"')),t+"?apiKey="+n+"&query="+encodeURIComponent("{ "+r+"("+a+',countryCode:"'+o+'",deviceType:SETTOP,tz:"Z") '+s+" }")}(t,n,i,r.countryCode),g.label=1;case 1:return g.trys.push([1,4,,5]),[4,T(a)];case 2:return[4,g.sent().json()];case 3:if(s=g.sent(),o=s.data.airing,(c=s.data.airings)&&(u=t.simulcastAiringId?function(e){return e.simulcastAiringId===t.simulcastAiringId}:function(){return!0},o=c.filter(u)[0]),l=s.data.VOD,!(d=o||l))throw new Error("No results found.");if(h=function(e,t,n){var i=e.id,r=e.name,a=e.description,s=e.duration,o=e.image,c=e.eventId,u=e.requiresLinearPlayback,l=e.authTypes,d=e.source,h=e.prerollSource,p=e.packages,f=e.language,m=e.mrss,y=e.seekInSeconds,g=e.tracking,v=e.simulcastAiringId,b=e.network,_=e.status,w=e.cerebroId,P=e.syndicatable,I=_&&("LIVE"===_.toUpperCase()||"OVER"===_.toUpperCase())?Xs.live:Xs.onDemand,S=function(e){switch(e){case"NONE":return uo.none;case"START_SESSION":return uo.startSession;case"BAM":return uo.bam;case"SHIELD":return uo.shield}}(d.authorizationType),T=new lo(d.url,S,d.hasEspnId3Heartbeats,d.hasNielsenWatermarks,d.hasPassThroughAds,d.commercialReplacement,d.startSessionUrl);n&&n.sourceVariant===Ys.stitchedPreroll&&h&&((T=new lo(h.url,uo.none)).variant=Ys.stitchedPreroll);var A=u?qs.linearPlayback:qs.all,k=g&&g.trackingId||i,E=new mo(i,r,s,f,T);if(E.authenticationTypes=l.map((function(e){switch(e){case"DIRECT":return co.direct;case"OPEN":return co.open;case"MVPD":return co.mvpd;case"ISP":return co.isp;default:return co.none}})),E.description=a,E.isSyndicatable=P,o&&o.url&&E.images.push(new po(o.url)),E.mrss=m,b){var C="linear"===b.type?Ws.linear:Ws.event;E.network=new ho(b.id,C,b.name,b.adobeResource)}return E.seekInSeconds=y,E.streamType=I,E.supportedMediaCommands=A,E.brand=E.brand?E.brand:"espn",E.tracking=vo(E.brand,e,t,T),E.references={eventId:c,simulcastAiringId:v,trackingId:k,cerebroId:w},E.type=ro.video,E.entityType=t,E.apiSource=so.graphQL,E.packages=(p||[]).map((function(e){return new fo(e.name)})),E}(d,t.entityType,r),t.resumeTime&&(h.seekInSeconds=t.resumeTime),!h.source.url){if(p="OVER"===d.status.toUpperCase(),f=d.network&&d.network.type===Ws.linear,m=d.network&&d.network.id,p&&f&&m)return[2,e.retryGetMediaItems(m,n,i,r)];throw new Error("No playable url")}return[2,h];case 4:return y=g.sent(),P.warn("Failed to retrieve MediaItem from GraphQL: "+y),[2,null];case 5:return[2]}}))}))},e.retryGetMediaItems=function(t,n,i,r){return C(this,void 0,void 0,(function(){var a,s,o,c;return M(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),a=go.identifierStringForNetwork(t,so.graphQL),s=new go(a),[4,e.getPromiseMediaItems(s,n,i,r)];case 1:if((o=u.sent())&&o instanceof mo==!0)return[2,o];throw new Error("Retry fetchMediaItems failed with "+t);case 2:return c=u.sent(),P.warn("MediaItem is over and retry failed: "+c),[2,null];case 3:return[2]}}))}))},e.defaultConfiguration=new wo(so.graphQL),e}();var Io=function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return M(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var n,r;return M(this,(function(a){switch(a.label){case 0:return n=t.map((function(e){return new go(e)})),r=i.serviceUrl,[4,S.all(n.map((function(t){return e.getPromiseMediaItem(t,r)})))];case 1:return[2,a.sent().filter((function(e){return!(e instanceof Error)&&e instanceof mo}))]}}))}))},e.getPromiseMediaItem=function(e,t){return C(this,void 0,void 0,(function(){var n,i,r;return M(this,(function(a){switch(a.label){case 0:n=t.replace("videoID",e.id),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,T(n)];case 2:return[4,a.sent().json()];case 3:return i=a.sent(),[2,function(e){var t=e.id,n=e.title,i=e.description,r=e.duration,a=e.source,s=e.type,o=e.entityType,c=e.streamType,u=e.authenticationTypes,l=e.language,d=e.network,h=e.brand,p=e.images,f=o,m=a.type,y=new lo(a.url,m),g=new mo(t,n,r,l,y);return g.authenticationTypes=u.map((function(e){switch(e){case"DIRECT":return co.direct;case"OPEN":return co.open;case"MVPD":return co.mvpd;case"ISP":return co.isp;default:return co.none}})),g.description=i,d&&(g.network=new ho(d.id,d.type,d.name,d.resource)),g.streamType=c,g.brand=h,g.tracking=vo(g.brand,e,f,y),g.images=p,g.type=s,g.entityType=f,g.apiSource=so.cfa,g}(i)];case 4:return r=a.sent(),P.warn("Failed to retrieve MediaItem from CFA: "+r),[2,null];case 5:return[2]}}))}))},e.defaultConfiguration=new wo(so.cfa),e}(),So=Object.freeze({}),To=Object.freeze({}),Ao=so.itemFeed,ko={lf:"longform",sf:"shortform",live:"longform"},Eo={"abcn:fivethirtyeight":"fivethirtyeight",abcn:"abcnews"},Co={name:"abc_news_live",type:"linear"},Mo=["HLS_ALL","PDL_MED","PDL_LOW"];function Oo(e){var t,n,i,r=(e||So).channel||So,a=r.item||So,s=a["media-group"]||So,o=s["media-content"]||To,c=s["media-title"],u=(function(e){for(var t,n,i=Mo.length,r=e.length,a=0;a<i;a++)for(var s=Mo[a],o=0;o<r;o++){var c=e[o];if((null===(n=null===(t=null==c?void 0:c["media-category"])||void 0===t?void 0:t["@attributes"])||void 0===n?void 0:n.label)===s)return c}}(o)||So)["@attributes"]||So,l=(s["media-thumbnail"]||So)["@attributes"]||So,d=a.guid,h=a.title,p=a.temporalType,f=a.timestamp,m=a.link,y=u.duration,g=u.url,v=u.medium,b=(a.omniture||So).channel||"",_=O(String(b).split(":"),1)[0],w=Eo[b]||Eo[void 0===_?"abcn":_]||"abcnews",P="vod"===p,I="live"===p,S=ko[a.videoContentType]||(P?"shortform":"longform"),T=c||h,A=r.language||"en";try{n=(t=O(new Date(f).toISOString().split("T"),2))[0],i=t[1]}catch(e){console.warn(e)}var k="akamai live stream"!==a.mediatype||P?{}:E(E({},Co),{id:d}),C={id:d,apiSource:Ao,seasonNumber:"none",eventId:"none",episodeNumber:"none",genre:"news",tvrating:"none",network:k,show:{title:T},title:T,duration:y,language:A,source:{url:g,type:"none"},description:a.description||s["media-description"],authenticationTypes:["NONE"],mrss:null,seekInSeconds:null,brand:w,type:"video"===v?"video":"audio",entityType:S,streamType:I?"live":"onDemand",images:l?[{url:l.url}]:null,airDate:a.timestamp,availableDate:a.pubDate,references:{itemfeed:d},tracking:{omniture:a.omniture,nielsen:{type:"content",assetid:d,program:T,title:T},conviva:{assetName:h,duration:y,streamURL:g,custom:{contentId:d,assetType:P?"clip":"live",sport:"none",league:"none",appBrand:a.category||"abcnews"}},heartbeats:{ContentDuration:y,isFullEpisode:"shortform"===S||I?"n":"y",VideoType:p,CMSID:T,PublishDate:n,PublishTime:i}},webHref:m};return mo.fromObject(C)}var Do=w((function(e,t){function n(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function i(e,t){return t.encode?t.strict?encodeURIComponent(e).replace(/[!'()*]/g,e=>"%"+e.charCodeAt(0).toString(16).toUpperCase()):encodeURIComponent(e):e}function r(e,t){return t.decode?Ze(e):e}function a(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function s(e){const t=(e=a(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function o(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function c(e,t){n((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const i=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,i)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===i[e]&&(i[e]={}),i[e][t[1]]=n):i[e]=n};case"bracket":return(e,n,i)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==i[e]?i[e]=[].concat(i[e],n):i[e]=[n]:i[e]=n};case"comma":case"separator":return(t,n,i)=>{const a="string"==typeof n&&n.includes(e.arrayFormatSeparator),s="string"==typeof n&&!a&&r(n,e).includes(e.arrayFormatSeparator);n=s?r(n,e):n;const o=a||s?n.split(e.arrayFormatSeparator).map(t=>r(t,e)):null===n?n:r(n,e);i[t]=o};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),a=Object.create(null);if("string"!=typeof e)return a;if(!(e=e.trim().replace(/^[?#&]/,"")))return a;for(const n of e.split("&")){if(""===n)continue;let[e,s]=et(t.decode?n.replace(/\+/g," "):n,"=");s=void 0===s?null:["comma","separator"].includes(t.arrayFormat)?s:r(s,t),i(r(e,t),s,a)}for(const e of Object.keys(a)){const n=a[e];if("object"==typeof n&&null!==n)for(const e of Object.keys(n))n[e]=o(n[e],t);else a[e]=o(n,t)}return!1===t.sort?a:(!0===t.sort?Object.keys(a).sort():Object.keys(a).sort(t.sort)).reduce((e,t)=>{const n=a[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((e,t)=>Number(e)-Number(t)).map(e=>t[e]):t}(n):e[t]=n,e},Object.create(null))}t.extract=s,t.parse=c,t.stringify=(e,t)=>{if(!e)return"";n((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const r=n=>t.skipNull&&null==e[n]||t.skipEmptyString&&""===e[n],a=function(e){switch(e.arrayFormat){case"index":return t=>(n,r)=>{const a=n.length;return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[i(t,e),"[",a,"]"].join("")]:[...n,[i(t,e),"[",i(a,e),"]=",i(r,e)].join("")]};case"bracket":return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[i(t,e),"[]"].join("")]:[...n,[i(t,e),"[]=",i(r,e)].join("")];case"comma":case"separator":return t=>(n,r)=>null==r||0===r.length?n:0===n.length?[[i(t,e),"=",i(r,e)].join("")]:[[n,i(r,e)].join(e.arrayFormatSeparator)];default:return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,i(t,e)]:[...n,[i(t,e),"=",i(r,e)].join("")]}}(t),s={};for(const t of Object.keys(e))r(t)||(s[t]=e[t]);const o=Object.keys(s);return!1!==t.sort&&o.sort(t.sort),o.map(n=>{const r=e[n];return void 0===r?"":null===r?i(n,t):Array.isArray(r)?r.reduce(a(n),[]).join("&"):i(n,t)+"="+i(r,t)}).filter(e=>e.length>0).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[n,i]=et(e,"#");return Object.assign({url:n.split("?")[0]||"",query:c(s(e),t)},t&&t.parseFragmentIdentifier&&i?{fragmentIdentifier:r(i,t)}:{})},t.stringifyUrl=(e,n)=>{n=Object.assign({encode:!0,strict:!0},n);const r=a(e.url).split("?")[0]||"",s=t.extract(e.url),o=t.parse(s,{sort:!1}),c=Object.assign(o,e.query);let u=t.stringify(c,n);u&&(u="?"+u);let l=function(e){let t="";const n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);return e.fragmentIdentifier&&(l="#"+i(e.fragmentIdentifier,n)),`${r}${u}${l}`},t.pick=(e,n,i)=>{i=Object.assign({parseFragmentIdentifier:!0},i);const{url:r,query:a,fragmentIdentifier:s}=t.parseUrl(e,i);return t.stringifyUrl({url:r,query:tt(a,n),fragmentIdentifier:s},i)},t.exclude=(e,n,i)=>{const r=Array.isArray(n)?e=>!n.includes(e):(e,t)=>!n(e,t);return t.pick(e,r,i)}})),No=(Do.extract,Do.parse,Do.stringify,Do.parseUrl,Do.stringifyUrl,Do.pick,Do.exclude,function(){function e(){this.configuration_=e.defaultConfiguration}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(t,n){return C(this,void 0,void 0,(function(){return M(this,(function(i){switch(i.label){case 0:return[4,e.fetchMediaItems(t,n,this.configuration)];case 1:return[2,i.sent()]}}))}))},e.fetchMediaItems=function(t,n,i){return C(this,void 0,void 0,(function(){var n,r;return M(this,(function(a){switch(a.label){case 0:return n=t.map((function(e){return new go(e)})),r=i.serviceUrl,[4,S.all(n.map((function(t){return e.getPromiseMediaItem(t,r)})))];case 1:return[2,a.sent().filter((function(e){return!(e instanceof Error)&&e instanceof mo}))]}}))}))},e.getPromiseMediaItem=function(e,t){return C(this,void 0,void 0,(function(){var n,i,r;return M(this,(function(a){switch(a.label){case 0:n=Do.stringify({id:e.id||e.channel}),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,T(t+"?"+n+"&requester=guardians")];case 2:return[4,a.sent().json()];case 3:return i=a.sent(),[2,Oo(i)];case 4:return r=a.sent(),P.warn("Failed to retrieve MediaItem from ItemFeed endpoint: "+r),[2,null];case 5:return[2]}}))}))},e.defaultConfiguration=new wo(so.itemFeed),e}()),Lo=(function(){function e(){}Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!1,configurable:!0}),e.prototype.getMediaItems=function(e,t){return C(this,void 0,void 0,(function(){var n,i=this;return M(this,(function(r){switch(r.label){case 0:return n=t||{sourceVariant:null},[4,S.all(e.map((function(e){return C(i,void 0,void 0,(function(){var t,i,r,a;return M(this,(function(s){switch(s.label){case 0:t=e.match("natgeo")?Io:e.match("abcnews")?No:Po,(r=new t).configuration=this.configuration||r.configuration,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,r.getMediaItems([e],n)];case 2:return a=s.sent(),i=null==a?void 0:a[0],[3,4];case 3:return s.sent(),[3,4];case 4:return[2,i]}}))}))})))];case 1:return[2,r.sent()]}}))}))}}(),function(e,t){t.setItem("watchsdk.tve_authenticator.state",JSON.stringify(e))}),Uo=function(e){function n(e,i){var r;return s(this,n),(r=t(this,n,[e,i])).providerDataSource=new rr(i),r}return d(n,e),c(n)}(function(){function e(e,t){this.identityTokenProvider=e,this.locationProvider=t,this.authenticationUrl="https://www.espn.com/watch/auth",this.edition="espn-nl-nl",this.storage=localStorage,this.tveAPI=new Ks(zs.serviceUrl,zs.entitlementsPath),this.delegate=null,this.providerDataSource=null,window.displayProviderDialog=this.displayProviderDialog.bind(this);try{var n=this.storage.getItem("watchsdk.tve_authenticator.state"),i=JSON.parse(n);this.state_=i||{}}catch(e){}}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.configuration_},set:function(e){this.configuration_=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAuthenticated",{get:function(){return this.state_.isAuthenticated},set:function(e){this.state_.isAuthenticated=e,Lo(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"authenticatedIdentity",{get:function(){var e,t;return null===(t=null===(e=this.state_.entitlements)||void 0===e?void 0:e.accounts[0])||void 0===t?void 0:t.id},set:function(e){this.state_.authenticatedIdentity=e,Lo(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"authenticatedProvider",{get:function(){return this.state_.authenticatedProvider},set:function(e){if(!e)return delete this.state_.authenticatedProvider,void Lo(this.state_,this.storage);this.state_.authenticatedProvider=e,Lo(this.state_,this.storage)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"entitlements",{get:function(){return this.state_.entitlements},set:function(e){if(!e)return delete this.state_.entitlements,void Lo(this.state_,this.storage);this.state_.entitlements=e,Lo(this.state_,this.storage)},enumerable:!0,configurable:!0}),e.prototype.checkAuthentication=function(){return C(this,void 0,void 0,(function(){var e,t,n,i=this;return M(this,(function(r){switch(r.label){case 0:return P.debug("TVEAuthenticator.checkAuthentication"),(e=this.identityTokenProvider.getIdentityToken())?(t=this,[4,this.tveAPI.getEntitlements(e)]):[2,S.reject(new Error("TVEAuthenticator.IdentityRequired"))];case 1:return t.entitlements=r.sent(),this.entitlements?(n=this.entitlements.accounts[0])?(this.isAuthenticated=!(!e||!n),this.authenticatedProvider=new js(n.affiliate.id,n.affiliate.name,null,null),this.providerDataSource?[2,this.providerDataSource.getProvider(n.affiliate.id,qi.mvpd).then((function(e){var t=e&&e.images||[],r=t.filter((function(e){return"COLOR_NEGATIVE"===e.type})).map((function(e){return e.href}))[0],a=t.filter((function(e){return"BW_NEGATIVE"===e.type})).map((function(e){return e.href}))[0]||r||t.map((function(e){return e.href}))[0];return i.authenticatedProvider=new js(e.adobeId||n.affiliate.id,n.affiliate.name,a,e.websiteUrl),i.isAuthenticated})).catch((function(){return i.isAuthenticated}))]:[2,S.resolve(this.isAuthenticated)]):(this.isAuthenticated=!1,[2,S.resolve(this.isAuthenticated)]):(this.isAuthenticated=!1,[2,S.reject(new Error("TVEAuthenticator.NotEntitled"))])}}))}))},e.prototype.authenticate=function(e){var t=this,n=this.providerId,i=this.accessType,r=this.edition,a=e&&e.redirectUrl||window.location.href,s=this.identityTokenProvider.getIdentityToken();return new S((function(e){var o;if(t.resolveAuthenticate_=function(t){e(t)},!n)return t.redirectUrl=a,t.displayProviderDialog(),S.resolve(!1);var c=null===(o=t.locationProvider.getCountryCode())||void 0===o?void 0:o.toLowerCase(),u={mvpd:n,redirectUrl:a,country:c};r&&(u["edition-view"]=r),i&&(u.accessType=i);var l=Object.keys(u).map((function(e){return e+"="+encodeURIComponent(u[e])})).join("&"),d=-1===t.authenticationUrl.indexOf("?")?"?":"&",h=""+t.authenticationUrl+d+l;s&&(h=h+"#oneIdToken="+s),window.location.href=h}))},e.prototype.deauthenticate=function(){var e=this.entitlements.accounts[0].affiliate.id,t=this.identityTokenProvider.getIdentityToken();return this.isAuthenticated=!1,this.authenticatedProvider=null,this.authenticatedIdentity=null,this.entitlements=null,t?this.tveAPI.logout(e,t,null).catch((function(){return!0})):S.resolve(!0)},e.prototype.checkAuthorization=function(){return C(this,void 0,void 0,(function(){var e,t,n,i,r,a;return M(this,(function(s){switch(s.label){case 0:return(e=this.identityTokenProvider.getIdentityToken())?this.isAuthenticated?this.entitlements&&this.tveAPI.tokenIsValid(this.entitlements.token)?[3,2]:(t=this,[4,this.tveAPI.getEntitlements(e)]):[2,S.reject(new Error("TVEAuthenticator.AuthenticationRequired"))]:[2,S.reject(new Error("TVEAuthenticator.IdentityRequired"))];case 1:t.entitlements=s.sent(),s.label=2;case 2:return this.entitlements&&this.tveAPI.tokenIsValid(this.entitlements.token)?((a={})[xs.CustomDataKey.token]=this.entitlements.token,a[xs.CustomDataKey.tokenType]="JWT",n=a,i=new xs(co.mvpd,this.authenticatedProvider,this.authenticatedIdentity,n),r=new Hs(!0,i),[2,S.resolve(r)]):[2,S.reject(new Error("TVEAuthenticator.NotEntitled"))]}}))}))},e.prototype.displayProviderDialog=function(){var e=this;P.debug("TVEAuthenticator.displayProviderDialog"),this.providerDataSource&&this.providerDataSource.getProviders().then((function(t){e.delegate&&e.delegate.selectProvider&&e.delegate.selectProvider(t)}))},e.prototype.setProvider=function(e,t){var n=this;P.debug("TVEAuthenticator.setProvider"),this.providerId=e,this.accessType=t,this.authenticate({redirectUrl:this.redirectUrl}).then((function(){n.resolveAuthenticate_&&(n.resolveAuthenticate_(n.isAuthenticated),n.resolveAuthenticate_=null)}))},e.defaultConfiguration=zs,e}()),jo=function(e){function n(){return s(this,n),t(this,n)}return d(n,e),c(n)}(q),Fo=function(){function e(t,n){s(this,e),this.playerAdaptor=t,this.mediaItem=n,this.id3MetadataOwner=new ks,this._currentContentType=null,this._currentAdId=null,this._lastHeartbeatTime=null,this._initialHeartbeatTimer=null,this._heartbeatTimer=null,this._currentPlayerTime=0,this._initialPlayerTime=null,this._isPlaying=!1,this._handleStart=this._handleStart.bind(this),this.playerAdaptor.on(Os.start,this._handleStart),this._handlePlaying=this._handlePlaying.bind(this),this.playerAdaptor.on(Os.playing,this._handlePlaying),this._handlePaused=this._handlePaused.bind(this),this.playerAdaptor.on(Os.pause,this._handlePaused),this.playerAdaptor.on(Os.stalled,this._handlePaused),this.playerAdaptor.on(Os.seeking,this._handlePaused),this._handlePlayerCurrentTime=this._handlePlayerCurrentTime.bind(this),this.playerAdaptor.on(Os.currentTime,this._handlePlayerCurrentTime),this._handleTimedMetadata=this._handleTimedMetadata.bind(this),this.playerAdaptor.on(Os.timedMetadata,this._handleTimedMetadata),this._handleStop=this._handleStop.bind(this),this.playerAdaptor.on(Os.stop,this._handleStop)}return c(e,[{key:"currentContentType",get:function(){return this._currentContentType},set:function(e){if(this._currentContentType!==e){var t=this._currentContentType;this._currentContentType=e;var n=this._currentPlayerTime;t||(n=this._initialPlayerTime||0),this.onContentTypeChanged&&this.onContentTypeChanged(e,t,n,this._currentAdId)}}},{key:"onContentTypeChanged",value:function(e,t,n,i){}},{key:"stop",value:function(){this.playerAdaptor.off(Os.start),this.playerAdaptor.off(Os.playing),this.playerAdaptor.off(Os.pause),this.playerAdaptor.off(Os.stalled),this.playerAdaptor.off(Os.seeking),this.playerAdaptor.off(Os.timedMetadata),this.playerAdaptor.off(Os.currentTime),this.playerAdaptor.off(Os.stop)}},{key:"_handleStart",value:function(){if(P.debug("AdBreakMonitor._handleStart"),!0!==this.mediaItem.source.hasEspnId3Heartbeats)return P.debug("AdBreakMonitor._handleStart hasEspnId3Heartbeats !== true, setting currentContentType to content.",this._currentPlayerTime,this._initialPlayerTime,this.mediaItem.source.hasEspnId3Heartbeats),void(this.currentContentType=e.ContentType.content);this._scheduleInitialHeartbeatTimer()}},{key:"_handlePlaying",value:function(){this._isPlaying=!0}},{key:"_handlePaused",value:function(){this._isPlaying=!1}},{key:"_handleTimedMetadata",value:function(e){if(!0===this.mediaItem.source.hasEspnId3Heartbeats&&e.tag===Is.priv&&e.owner===this.id3MetadataOwner.heartbeat){P.debug("AdBreakMonitor._handleTimedMetadata",JSON.stringify(e));var t=function(e){var t;try{t=JSON.parse(e.dataValue)}catch(e){return null}return t.length?t.map((function(e){return new Es(e.type,e.id)})):null}(e);t&&this._handleHeartbeats(t)}}},{key:"_handlePlayerCurrentTime",value:function(e){var t=Math.floor(e);null===this._initialPlayerTime&&(this._initialPlayerTime=t),this._currentPlayerTime=t}},{key:"_handleStop",value:function(){this._invalidateInitialHeartbeatTimer(),this._invalidateHeartbeatTimer()}},{key:"_handleHeartbeats",value:function(t){P.debug("AdBreakMonitor._handleHeartbeats",JSON.stringify(t)),this._invalidateInitialHeartbeatTimer(),this._lastHeartbeatTime=Date.now();var n=t.every((function(e){return e.isContent()}))?e.ContentType.content:e.ContentType.ad;n===e.ContentType.ad&&(this._currentAdId=function(e){return e.find((function(e){return e.type===Ss.commercial&&null!==e.id}))||null}(t)),this.currentContentType=n,this._scheduleHeartbeatTimer()}},{key:"_scheduleInitialHeartbeatTimer",value:function(){var e=this;P.debug("AdBreakMonitor._scheduleInitialHeartbeatTimer"),this._invalidateInitialHeartbeatTimer(),this._initialHeartbeatTimer=setInterval((function(){e._handleInitialHeartbeatTimer()}),15e3)}},{key:"_invalidateInitialHeartbeatTimer",value:function(){this._initialHeartbeatTimer&&(clearInterval(this._initialHeartbeatTimer),this._initialHeartbeatTimer=null)}},{key:"_handleInitialHeartbeatTimer",value:function(){if(P.debug("AdBreakMonitor._handleInitialHeartbeatTimer"),this._invalidateInitialHeartbeatTimer(),!1!==this._isPlaying){if(!this.currentContentType){var t=e.ContentType.ad;this._currentAdId="1",this.currentContentType=t}}else this._scheduleInitialHeartbeatTimer()}},{key:"_scheduleHeartbeatTimer",value:function(){var e=this;this._invalidateHeartbeatTimer(),this._heartbeatTimer=setInterval((function(){e._handleHeartbeatTimer()}),1e4)}},{key:"_invalidateHeartbeatTimer",value:function(){this._heartbeatTimer&&(clearInterval(this._heartbeatTimer),this._heartbeatTimer=null)}},{key:"_handleHeartbeatTimer",value:function(){var t=Date.now();if(P.debug("AdBreakMonitor._handleHeartbeatTimer"),!1!==this._isPlaying){if(this._lastHeartbeatTime&&t-this._lastHeartbeatTime>2e4){P.debug("AdBreakMonitor._handleHeartbeatTimer [now - this._lastHeartbeatTime]: ",t-this._lastHeartbeatTime);var n=e.ContentType.ad;this._currentAdId="1",this.currentContentType=n}this._scheduleHeartbeatTimer()}else this._scheduleHeartbeatTimer()}}]),e}();Fo.ContentType={ad:"ad",content:"content"};var Ro={production:"PROD",testing:"TESTING"},xo={};xo[Ro.production]="https://cloudapi.imrworldwide.com/nmapi/v2",xo[Ro.testing]="https://sandbox-cloudapi.imrworldwide.com/nmapi/v2";var Ho=function(){function e(t,n,i,r,a){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Ro.production,c=arguments.length>6&&void 0!==arguments[6]&&arguments[6];s(this,e);var u=t instanceof e.Configuration||t===Object(t)?t:new e.Configuration(t,n,i,r,a,o,c);P.debug("NielsenCloudAPIClient.constructor",JSON.stringify(u)),this.configuration=u,this.sessionId=K()}return c(e,[{key:"configuration",get:function(){return this._configuration},set:function(e){e&&(this.appId=e.appId,this.devInfo={devId:!1===e.isOptOut?e.deviceId:"",apn:e.appName,apv:"".concat(e.appVersion),uoo:"".concat(e.isOptOut)},this.env=e.environment,this._configuration=e)}},{key:"isTizenApp",get:function(){var e;return"ESPN SamsungTV"===(null===(e=this.configuration)||void 0===e?void 0:e.appName)}},{key:"isBBDApp",get:function(){var e;return null===(e=this.configuration)||void 0===e?void 0:e.isBBDApp}},{key:"primaryLinearNetworks",get:function(){return new Set(["ESPN","ESPN2"])}},{key:"sendEvent",value:function(e,t,n,i,r){var a,s={devInfo:this.devInfo,metadata:{},event:e,position:isNaN(t)||null===t?"".concat(t):"".concat(Math.floor(t)),type:n,utc:"".concat(Date.now())},o=(null==i?void 0:i.tracking[pe.nielsen])||{},c=null==i||null===(a=i.network)||void 0===a?void 0:a.name,u=null==i?void 0:i.streamType,l=null==i?void 0:i.entityType;if(this.isBBDApp){var d="2";this.shouldSetAdLoadTypeToOne(u,c,l)&&(d="1"),o.adloadtype=d,o.vcid&&delete o.vcid,o.admodel&&delete o.admodel}this.isTizenApp&&u===de.onDemand&&(o.subbrand="c17"),!this.isTizenApp&&this.isBBDApp&&this.shouldUpldateSubbrand(u,c)&&(o.subbrand="b01"),i&&(s.metadata.content=o),n===Fo.ContentType.ad&&(s.metadata.ad=r);var h="".concat(xo[this.env],"/").concat(this.appId,"/").concat(this.sessionId,"/a?b=").concat(encodeURIComponent(JSON.stringify(s)));P.debug("NielsenCloudAPIClient.sendEvent url:",h),P.debug("NielsenCloudAPIClient.sendEvent payload:",JSON.stringify(s)),T(h).then((function(e){P.debug("NielsenCloudAPIClient.sendEvent response.status: ".concat(e.status))})).catch((function(e){P.warn("NielsenCloudAPIClient.sendEvent response.error: ".concat(e&&e.message))}))}},{key:"shouldSetAdLoadTypeToOne",value:function(e,t,n){return e===de.live&&(this.primaryLinearNetworks.has(t)||this.isEspnPlus(t))||e===de.onDemand&&n===me.longform&&!this.isEspnPlus(t)}},{key:"shouldUpldateSubbrand",value:function(e,t){return e===de.live&&this.isNotPrimaryLinearNetworksOrEspnPlus(t)}},{key:"isNotPrimaryLinearNetworksOrEspnPlus",value:function(e){return"ESPN"!==e&&"ESPN2"!==e&&"ESPN+"!==e}},{key:"isEspnPlus",value:function(e){return"ESPN+"===e}},{key:"closeSession",value:function(){this.sendEvent(e.EventType.delete,"","",null,null)}}]),e}();Ho.AssetType={content:"content",ad:"ad"},Ho.EventType={playhead:"playhead",complete:"complete",delete:"delete"},Ho.Environment=Ro,Ho.Configuration=c((function e(t,n,i,r,a,o){var c=arguments.length>6&&void 0!==arguments[6]&&arguments[6];s(this,e),this.appId=t,this.appName=n,this.appVersion=i,this.deviceId=r,this.isOptOut=a,this.environment=o,this.isBBDApp=c}));var Bo,zo=function(){function e(t,n,i){var r=this;s(this,e),this.cloudAPIClient=t,this.playerAdaptor=n;var a=ut.fromObject(i)||i;if(a.entityType===me.longform||this.cloudAPIClient.isBBDApp){this.mediaItem=a,this.currentPlayerTime=null,this.lastContentBeaconTime=null,this._isPlayerPlaying=!1,this.playerAdaptor.on(Os.playing,(function(e){if(P.debug("NielsenTrackingManager PlayerAdaptorEvent.playing currentTime = ".concat(e,", this.currentPlayerTime = ").concat(r.currentPlayerTime)),e){var t=Math.floor(e);r.currentPlayerTime=t}r.isPlayerPlaying=!0})),this.playerAdaptor.on(Os.seeking,(function(e){P.debug("NielsenTrackingManager PlayerAdaptorEvent.seeking currentTime = ".concat(e,", this.currentPlayerTime = ").concat(r.currentPlayerTime)),r.isPlayerPlaying=!1,r._massageAndReportTime(e)})),this.playerAdaptor.on(Os.seeked,(function(e){P.debug("NielsenTrackingManager PlayerAdaptorEvent.seeked currentTime = ".concat(e,", this.currentPlayerTime = ").concat(r.currentPlayerTime)),r.isPlayerPlaying=!0,r.lastContentBeaconTime=Math.floor(e),r._massageAndReportTime(e)})),this.playerAdaptor.on(Os.pause,(function(e){P.debug("NielsenTrackingManager PlayerAdaptorEvent.pause currentTime = ".concat(e,", this.currentPlayerTime = ").concat(r.currentPlayerTime)),r.isPlayerPlaying=!1,r._massageAndReportTime(e)})),this.playerAdaptor.on(Os.currentTime,(function(e){var t=Math.floor(e);r.currentPlayerTime=t;var n=r.currentContentType;if(n&&r.isPlayerPlaying){var i=t-r.currentContentStartTime;0!==i&&i%10==0&&t!==r.lastContentBeaconTime&&t>r.lastContentBeaconTime&&(r.lastContentBeaconTime=t,P.debug("NielsenTrackingManager PlayerAdaptorEvent.currentTime sending playhead 10 second beacon ",t),r._sendPlayheadEvent(n,t))}})),this.playerAdaptor.on(Os.stop,(function(){P.debug("NielsenTrackingManager PlayerAdaptorEvent.stop, this.currentPlayerTime",r.currentPlayerTime),r.isPlayerPlaying=!1,r._massageAndReportTime(r.currentPlayerTime),r.stop()})),this.currentContentType=null,this.currentContentStartTime=0,this.totalAdTime=0,this.currentAdInfo=null;var o=new Fo(n,i);o.onContentTypeChanged=function(e,t,n){if(P.debug("NielsenTrackingManager adBreakMonitor.onContentTypeChanged from",t,"to",e),t){P.debug("NielsenTrackingManager adBreakMonitor.onContentTypeChanged sending playhead before contentType change");var i=r._getPlayheadPosition(t,n,!0);r.cloudAPIClient.sendEvent(Ho.EventType.playhead,i,t,r.mediaItem,r.currentAdInfo)}P.debug("NielsenTrackingManager adBreakMonitor.onContentTypeChanged sending playhead after contentType change");var a=t&&!r.mediaItem.isLive?0:r._getPlayheadPosition(e,n),s={assetid:"1",type:0===a?"preroll":"midroll"},o=e===Fo.ContentType.ad?s:null;r.cloudAPIClient.sendEvent(Ho.EventType.playhead,a,e,r.mediaItem,o),r.currentContentType=e,r.currentContentStartTime=n,r.currentAdInfo=o,r.lastContentBeaconTime=n},this.adBreakMonitor=o}}return c(e,[{key:"mediaItem",get:function(){return this._mediaItem},set:function(e){if(this._mediaItem){this._sendPlayheadEventForCurrentPlayerTimeAndContentType();var t=this._getPlayheadPosition(Fo.ContentType.content,this.currentPlayerTime);P.debug("NielsenTrackingManager setMediaItem sending complete"),this.cloudAPIClient.sendEvent(Ho.EventType.complete,t,Ho.AssetType.content,this._mediaItem)}this._mediaItem=e,this.adBreakMonitor&&(this.adBreakMonitor.mediaItem=e)}},{key:"isPlayerPlaying",get:function(){return this._isPlayerPlaying},set:function(e){e!==this._isPlayerPlaying&&(this._isPlayerPlaying=e,this._sendPlayheadEventForCurrentPlayerTimeAndContentType())}},{key:"stop",value:function(){this.playerAdaptor.off(Os.currentTime),this.playerAdaptor.off(Os.stop),this.adBreakMonitor&&this.adBreakMonitor.stop(),this.mediaItem=null}},{key:"_massageAndReportTime",value:function(e){if(e){var t=Math.floor(e);this.currentPlayerTime=t,this._sendPlayheadEvent(this.currentContentType,t)}}},{key:"_getPlayheadPosition",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.mediaItem&&this.mediaItem.isLive)return Math.floor(Date.now()/1e3);if(e===Fo.ContentType.ad){if(n){var i=t-this.currentContentStartTime;return this.totalAdTime+=i,i}return 0}return t-this.totalAdTime}},{key:"_sendPlayheadEventForCurrentPlayerTimeAndContentType",value:function(){var e=this.currentPlayerTime,t=this.currentContentType;t&&e!==this.lastContentBeaconTime&&e>this.lastContentBeaconTime&&(this.lastContentBeaconTime=e,P.debug("NielsenTrackingManager _sendPlayheadEventForCurrentPlayerTimeAndContentType sending playhead beacon",e),this._sendPlayheadEvent(t,e))}},{key:"_sendPlayheadEvent",value:function(e,t){var n=t-this.currentContentStartTime,i=e!==Fo.ContentType.ad||this.mediaItem.isLive?this._getPlayheadPosition(e,t):n,r=e===Fo.ContentType.ad?this.currentAdInfo:null;this.cloudAPIClient.sendEvent(Ho.EventType.playhead,i,e,this.mediaItem,r)}}]),e}(),Vo=function(){function e(e,t){this.delegate=e,this.config=t,this.didFirstPlay=!1,this.didFirstPlayOfContent=!1}return e.prototype.setMediaItem=function(e){this.mediaItem=e,this.didFirstPlayOfContent=!1},e.prototype.firstPlay=function(e){this.didFirstPlay=!0},e.prototype.firstPlayOfContent=function(e){this.didFirstPlayOfContent=!0},e.prototype.play=function(e){this.didFirstPlay||this.firstPlay(e),this.didFirstPlayOfContent||this.firstPlayOfContent(e)},e.prototype.loadedMetadata=function(e){},e.prototype.pause=function(e){},e.prototype.complete=function(e){},e.prototype.seek=function(e){},e.prototype.release=function(e){},e.prototype.progressChange=function(e){},e.prototype.buffer=function(e){},e.prototype.error=function(e){},e.prototype.adBreakStart=function(e){},e.prototype.adBreakEnd=function(e){},e.prototype.dispose=function(){this.delegate=null,this.config=null,this.mediaItem=null},e}();!function(e){e.willStartPlaying="atv.player.willStartPlaying",e.didStopPlaying="atv.player.didStopPlaying",e.onTimedMetadataChanged="atv.player.onTimedMetadataChanged",e.playerStateChanged="atv.player.playerStateChanged",e.playerTimeDidChange="atv.player.playerTimeDidChange"}(Bo||(Bo={}));var Ko,Go,qo=Bo;!function(e){e.priv="PRIV",e.txxx="TXXX"}(Ko||(Ko={})),function(e){e.program="PROGRAM",e.commercial="COMMERCIAL",e.slate="SLATE"}(Go||(Go={}));var $o,Wo=function(e,t,n){void 0===e&&(e="com.espn.authnet.heartbeat"),void 0===t&&(t="com.espn.authnet.transition"),void 0===n&&(n="www.nielsen.com"),this.heartbeat=e,this.transition=t,this.nielsenWatermark=n},Jo=function(e,t,n){this.tag=e,this.owner=t,this.dataValue=n};!function(e){e.start="start",e.playing="playing",e.pause="pause",e.seeking="seeking",e.stalled="stalled",e.stop="stop",e.timedMetadata="timedMetadata",e.currentTime="currentTime",e.loadedMetadata="loadedMetadata"}($o||($o={}));var Yo,Qo=$o,Xo=function(){function e(e,t){this.certificateUrl=t,this.requests=[],this.bindSecureKeyDelivery(e||atv.secureKeyDelivery||{})}return e.prototype.bindSecureKeyDelivery=function(e){e.fetchCertificate=this.fetchCertificate.bind(this),e.fetchAssetID=this.fetchAssetID.bind(this),e.fetchKeys=this.fetchKeys.bind(this),e.cancelAllRequests=this.cancelAllRequests.bind(this)},e.prototype.fetchCertificate=function(e,t){var n=this;P.debug("AtvlVdmsSecureKeyDelivery.fetchCertificate",e);var i=this.certificateUrl;if(i){var r=new XMLHttpRequest;r.open("GET",i),r.onreadystatechange=function(){if(4===r.readyState){if(200===r.status){var e=r.responseDataAsBase64;P.debug("AtvlVdmsSecureKeyDelivery.fetchCertificate responseDataAsBase64:",e),t.success(e)}else t.failure(r.status);n.requests.splice(n.requests.indexOf(r),1)}},this.requests.push(r),r.send(null)}else t.failure("invalid certificate url")},e.prototype.fetchAssetID=function(e,t){var n=/[?&]c=([^&]+)&*/.exec(e);if(!n||n.length<2)t.failure("Error parsing assetId "+e);else{var i=n[1];P.debug("AtvlVdmsSecureKeyDelivery.fetchAssetID",e,i),t.success(i,!1)}},e.prototype.fetchKeys=function(e,t,n){var i=this,r=e.replace("skd://","https://"),a=JSON.stringify({spc:t});P.debug("AtvlVdmsSecureKeyDelivery.fetchKeys",r);var s=new XMLHttpRequest;s.open("POST",r),s.setRequestHeader("Content-Type","application/json"),s.onreadystatechange=function(){if(4===s.readyState){if(200===s.status)try{var e=JSON.parse(s.responseText).ckc;n.success(e)}catch(e){n.failure("invalid JSON")}else n.failure(s.status);i.requests.splice(i.requests.indexOf(s),1)}},this.requests.push(s),s.send(a)},e.prototype.cancelAllRequests=function(){P.debug("AtvlVdmsSecureKeyDelivery.cancelAllRequests",this.requests.length),this.requests.forEach((function(e){e.abort&&e.abort()})),this.requests=[]},e}();(function(e){function t(t,n,i){var r=e.call(this)||this;if(!n)throw new Error("bus must be supplied");return r.bus=n,r.secureKeyDelivery=new Xo(i),r.bindEventListeners(),r}k(t,e),t.prototype.bindEventListeners=function(){var e=this;this.bus.on(qo.willStartPlaying,(function(){atv.player.observeTimedMetadataKeys(),e.emit(Qo.start)})),this.bus.on(qo.playerStateChanged,(function(t,n){switch(P.debug("AtvlPlayerAdaptor AtvlPlayerEvent.playerStateChanged",t,n),t){case atv.player.states.FastForwarding:e.emit(Qo.seeking,n);break;case atv.player.states.Loading:e.emit(Qo.stalled,n);break;case atv.player.states.Paused:e.emit(Qo.pause,n);break;case atv.player.states.Playing:e.emit(Qo.playing,n);break;case atv.player.states.Rewinding:e.emit(Qo.seeking,n)}})),this.bus.on(qo.onTimedMetadataChanged,(function(t){var n=t.key,i=t.extraAttributes.info,r=t.dataValue,a=r&&U.stringify(L.parse(r))||"";a.replace("\0",""),e.emit(Qo.timedMetadata,new Jo(n,i,a))})),this.bus.on(qo.didStopPlaying,(function(){e.emit(Qo.stop),e.cleanup()})),this.bus.on(qo.playerTimeDidChange,(function(t){e.emit(Qo.currentTime,t)}))},Object.defineProperty(t.prototype,"playbackConfig",{set:function(e){if(e){var t=e.licenseUrl;P.debug("AtvlPlayerAdaptor setPlaybackConfig",t,e.protectionSystem),t&&(this.secureKeyDelivery.certificateUrl=t)}},enumerable:!1,configurable:!0}),t.prototype.stop=function(e){var t=e.message;atv.player.stopWithReason("Video Playback Has Stopped",t)},t.prototype.cleanup=function(){this.bus.off(qo.willStartPlaying),this.bus.off(qo.onTimedMetadataChanged),this.bus.off(qo.didStopPlaying)}})($),function(e){function t(t,n){var i=e.call(this)||this;return t?(i.nativePlayer=t,i.bus=t.getEventBus(),i.constants=n,i.id3MetadataOwner=new Wo,i.unsubscribers=[],i.bindEventListeners(),i):i}k(t,e),t.prototype.bindEventListeners=function(){var e=this;this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.ID3,this,(function(t){void 0===t&&(t={});var n=t.sample?t.sample.data:t,i=n instanceof Uint8Array?String.fromCharCode.apply(String,D(n)):n,r=["PRIV","TXXX"].find((function(e){return i.includes(e)}))||null,a=Object.keys(e.id3MetadataOwner).map((function(t){return e.id3MetadataOwner[t]})).find((function(e){return i.includes(e)}))||null,s=a?i.substring(i.lastIndexOf(a)+a.length).trim().replace(/\0/g,""):null,o=new Jo(r,a,s);e.emit(Qo.timedMetadata,o)}))),this.alreadyStarted=!1,this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.PLAYING,this,(function(){P.trace("BAMTizenPlayerAdaptor Events.Player.PLAYING"),e.alreadyStarted?e.emit(Qo.playing):(e.emit(Qo.start),e.emit(Qo.playing),e.alreadyStarted=!0)}))),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.TIME_UPDATE,this,(function(t){var n=t/1e3;e.emit(Qo.currentTime,n)}))),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.PAUSE,this,(function(){P.trace("BAMTizenPlayerAdaptor Events.Player.PAUSE"),e.emit(Qo.pause)}))),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.SEEKING,this,(function(){P.trace("BAMTizenPlayerAdaptor Events.Player.SEEKING"),e.emit(Qo.seeking)}))),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.BUFFERING_START,this,(function(){P.trace("BAMTizenPlayerAdaptor Events.Player.BUFFERING_START"),e.emit(Qo.stalled)}))),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.BUFFERING_END,this,(function(){P.trace("BAMTizenPlayerAdaptor Events.Player.BUFFERING_END"),e.emit(Qo.playing)}))),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.COMPLETE,this,(function(){P.trace("BAMTizenPlayerAdaptor Events.Player.COMPLETE"),e.emit(Qo.stop),e.cleanup()})))},t.prototype.stop=function(e){e&&P.warn("BAMTizenPlayerAdaptor.stop",e.message),this.nativePlayer.stop(),this.cleanup()},t.prototype.cleanup=function(){this.alreadyStarted=!1,this.unsubscribers.forEach((function(e){return"function"==typeof e&&e()})),this.unsubscribers=[]}}($),function(e){function t(t){var n=e.call(this)||this;return t?(n.nativePlayer=t,n.id3MetadataOwner=new Wo,n.bindEventListeners(),n):n}k(t,e),t.prototype.bindEventListeners=function(){this.loadCompleteHandler=this.loadCompleteHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.PLAYER_LOAD_COMPLETE,this.loadCompleteHandler),this.id3Handler=this.id3Handler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.ID3,this.id3Handler),this.mediaFinishedHandler=this.mediaFinishedHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.MEDIA_FINISHED,this.mediaFinishedHandler),this.timeUpdateHandler=this.timeUpdateHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.TIME_UPDATE,this.timeUpdateHandler),this.playingHandler=this.playingHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.PLAYING,this.playingHandler),this.pauseHandler=this.pauseHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.PAUSE,this.pauseHandler),this.stop=this.stop.bind(this)},t.prototype.loadCompleteHandler=function(e){P.debug("ChromecastPlayerAdaptor: PLAYER_LOAD_COMPLETE",e),this.emit(Qo.start)},t.prototype.id3Handler=function(e){var t=this;if(P.debug("ChromecastPlayerAdaptor._id3Handler",e),e.detail&&(e.segmentData=e.detail),e.segmentData){var n=String.fromCharCode.apply(String,D(e.segmentData));P.trace("ChromecastPlayerAdaptor._id3Handler",n);var i=["PRIV","TXXX"].find((function(e){return n.includes(e)}))||null,r=Object.keys(this.id3MetadataOwner).map((function(e){return t.id3MetadataOwner[e]})).find((function(e){return n.includes(e)}))||null,a=r?n.substring(n.lastIndexOf(r)+r.length).trim().replace(/\0/g,""):null,s=new Jo(i,r,a);P.trace("ChromecastPlayerAdaptor._id3Handler","tag:",i,"owner:",r,"dataValue:",a),this.emit(Qo.timedMetadata,s)}},t.prototype.timeUpdateHandler=function(e){var t=e.currentMediaTime;this.emit(Qo.currentTime,t)},t.prototype.playingHandler=function(e){var t=e.currentMediaTime;this.emit(Qo.playing,t)},t.prototype.pauseHandler=function(e){var t=e.currentMediaTime;this.emit(Qo.pause,t)},t.prototype.mediaFinishedHandler=function(e){P.debug("ChromecastPlayerAdaptor: MEDIA_FINISHED",e),this.emit(Qo.stop),this.cleanup()},t.prototype.stop=function(e){e&&P.warn("ChromecastPlayerAdaptor.stop",e.message)},t.prototype.cleanup=function(){this.nativePlayer&&(this.nativePlayer.removeEventListener(cast.framework.events.EventType.PLAYER_LOAD_COMPLETE,this.loadCompleteHandler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.ID3,this.id3Handler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.MEDIA_FINISHED,this.mediaFinishedHandler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.TIME_UPDATE,this.timeUpdateHandler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.PAUSE,this.pauseHandler))}}($),function(e){function t(t){var n=e.call(this)||this;return n.nativePlayer=t,n.bindEventListeners(),n}k(t,e),t.prototype.bindEventListeners=function(){var e=this;this.nativePlayer?(this.onPlay=this.onPlay.bind(this),this.onPause=this.onPause.bind(this),this.onSeek=this.onSeek.bind(this),this.onCurrentTime=this.onCurrentTime.bind(this),this.onStalled=this.onStalled.bind(this),this.stop=this.stop.bind(this),this.onError=this.onError.bind(this),this.onLoadedMetadata=this.onLoadedMetadata.bind(this),this.cleanup=this.cleanup.bind(this),this.nativePlayer.addEventListener("play",this.onPlay),this.nativePlayer.addEventListener("pause",this.onPause),this.nativePlayer.addEventListener("seeking",this.onSeek),this.nativePlayer.addEventListener("ended",this.stop),this.nativePlayer.addEventListener("error",this.onError),this.nativePlayer.addEventListener("timeupdate",this.onCurrentTime),this.nativePlayer.addEventListener("stalled",this.onStalled),this.nativePlayer.addEventListener("loadedmetadata",this.onLoadedMetadata),this.nativePlayer.textTracks.onaddtrack=function(t){var n=t.track;n&&"metadata"===n.kind&&n.addEventListener("cuechange",(function(t){var n=t.target;if(n&&"metadata"===n.kind){for(var i=[],r=0;r<n.activeCues.length;r++){var a=n.activeCues[r];i.push(a.value)}i.map((function(t){var n=t.key,i=t.info,r=t.data;r instanceof ArrayBuffer&&(r=String.fromCharCode.apply(null,new Uint8Array(r)));var a=new Jo(n,i,r);P.trace("HTML5PlayerAdaptor timedMetadata",a),e.emit(Qo.timedMetadata,a)}))}}))}):P.error("Native Player wasn't passed to HTML5PlayerAdaptor")},t.prototype.onPlay=function(e){this.emit(Qo.start,e.timeStamp)},t.prototype.onPause=function(e){this.emit(Qo.pause,e.timeStamp)},t.prototype.onSeek=function(e){this.emit(Qo.seeking,e.timeStamp)},t.prototype.onError=function(){this.emit(Qo.stop),this.cleanup()},t.prototype.onCurrentTime=function(e){this.emit(Qo.currentTime,e.timeStamp)},t.prototype.onStalled=function(e){this.emit(Qo.stalled,e.timeStamp)},t.prototype.onLoadedMetadata=function(){var e=this.nativePlayer;this.emit(Qo.loadedMetadata,{duration:e.duration,videoWidth:e.videoWidth,videoHeight:e.videoHeight})},t.prototype.stop=function(){this.nativePlayer.pause(),this.nativePlayer.setAttribute("src",""),this.nativePlayer.removeAttribute("src"),this.nativePlayer.currentTime=0,this.emit(Qo.stop),this.cleanup()},t.prototype.cleanup=function(){this.nativePlayer.removeEventListener("play",this.onPlay),this.nativePlayer.removeEventListener("pause",this.onPause),this.nativePlayer.removeEventListener("error",this.onError),this.nativePlayer.removeEventListener("seeking",this.onSeek),this.nativePlayer.removeEventListener("stalled",this.onStalled),this.nativePlayer.removeEventListener("timeupdate",this.onCurrentTime),this.nativePlayer.removeEventListener("ended",this.stop),this.nativePlayer.removeEventListener("loadedmetadata",this.onLoadedMetadata)}}($);!function(e){e.opened="opened",e.playing="playing",e.ended="ended",e.timedMetadata="timedMetadata",e.error="error",e.timeUpdate="timeUpdate",e.stalled="stalled",e.paused="paused",e.seeking="seeking"}(Yo||(Yo={}));var Zo=Yo,ec=(function(e){function t(t,n){var i=e.call(this)||this;if(!t)throw new Error("nativePlayer must be supplied");return i.nativePlayer=t,i.bus=n,i.bindEventListeners(),i}k(t,e),t.prototype.bindEventListeners=function(){this.onSeeking=this.onSeeking.bind(this),this.onStalled=this.onStalled.bind(this),this.onTimeUpdate=this.onTimeUpdate.bind(this),this.onPlaying=this.onPlaying.bind(this),this.onPaused=this.onPaused.bind(this),this.onError=this.onError.bind(this),this.onEnded=this.onEnded.bind(this),this.onTimedMetadata=this.onTimedMetadata.bind(this),this.onOpened=this.onOpened.bind(this),this.bus?(this.bus.on(Zo.opened,this.onOpened),this.bus.on(Zo.playing,this.onPlaying),this.bus.on(Zo.paused,this.onPaused),this.bus.on(Zo.timedMetadata,this.onTimedMetadata),this.bus.on(Zo.ended,this.onEnded),this.bus.on(Zo.error,this.onError),this.bus.on(Zo.timeUpdate,this.onTimeUpdate),this.bus.on(Zo.stalled,this.onStalled),this.bus.on(Zo.seeking,this.onSeeking)):(this.nativePlayer.onOpened=this.onOpened,this.nativePlayer.onPlaying=this.onPlaying,this.nativePlayer.onTimedMetadata=this.onTimedMetadata,this.nativePlayer.onEnded=this.onEnded,this.nativePlayer.onError=this.onError,this.nativePlayer.onTimeUpdate=this.onTimeUpdate,this.nativePlayer.onStalled=this.onStalled,this.nativePlayer.onSeeking=this.onSeeking)},t.prototype.onSeeking=function(){var e=this.nativePlayer.currentTime;P.debug("TrilithiumPlayerAdaptor.onSeeking",e),this.emit(Qo.seeking,e)},t.prototype.onStalled=function(){var e=this.nativePlayer.currentTime;P.debug("TrilithiumPlayerAdaptor.onStalled",e),this.emit(Qo.stalled,e)},t.prototype.onTimeUpdate=function(){var e=this.nativePlayer.currentTime;P.debug("TrilithiumPlayerAdaptor.onTimeUpdate",e),this.emit(Qo.currentTime,e)},t.prototype.onError=function(e){P.debug("TrilithiumPlayerAdaptor.onError",e),this.emit(Qo.stop),this.cleanup()},t.prototype.onEnded=function(){this.emit(Qo.stop),this.cleanup()},t.prototype.onTimedMetadata=function(e,t,n){var i=t,r=n.toString(),a=U.stringify(L.parse(n.toString("base64"))),s=r?a.substring(a.lastIndexOf(r)+r.length).trim().replace(/\0/g,""):a;P.debug("TrilithiumPlayerAdaptor.onTimedMetadata "+i+" "+r+" "+s);var o=new Jo(i,r,s);this.emit(Qo.timedMetadata,o)},t.prototype.onOpened=function(e){e&&(P.debug("TrilithiumPlayerAdaptor.onOpened"),this.emit(Qo.start))},t.prototype.onPlaying=function(){var e=this.nativePlayer.currentTime;P.debug("TrilithiumPlayerAdaptor.onPlaying",e),this.emit(Qo.playing,e)},t.prototype.onPaused=function(){var e=this.nativePlayer.currentTime;P.debug("TrilithiumPlayerAdaptor.onPaused",e),this.emit(Qo.pause,e)},t.prototype.stop=function(e){e&&P.warn("TrilithiumPlayerAdaptor.stop",e.message)},t.prototype.cleanup=function(){this.bus&&(this.bus.off(Zo.opened),this.bus.off(Zo.playing),this.bus.off(Zo.timedMetadata),this.bus.off(Zo.ended),this.bus.off(Zo.error),this.bus.off(Zo.timeUpdate),this.bus.off(Zo.stalled))}}($),6),tc=7,nc=11,ic=12,rc=(function(e){function t(t){var n=e.call(this)||this;return n.nativePlayer=t,n.id3MetadataOwner=new Wo,n}k(t,e),t.prototype.onTimedMetaData=function(e){var t=this,n=e.data,i=String.fromCharCode.apply(null,n),r=["PRIV","TXXX"].find((function(e){return i.includes(e)}))||null,a=Object.keys(this.id3MetadataOwner).map((function(e){return t.id3MetadataOwner[e]})).find((function(e){return i.includes(e)}))||null,s=a?i.substring(i.lastIndexOf(a)+a.length).trim().replace(/\0/g,""):null,o=new Jo(r,a,s);P.trace("AampUvePlayerAdapter timedMetadata",o),this.emit(Qo.timedMetadata,o)},t.prototype.onPlaybackStateChanged=function(e){switch(e.state){case ec:this.emit(Qo.pause);break;case tc:this.emit(Qo.seeking);break;case ic:case nc:this.emit(Qo.stop),this.cleanup()}},t.prototype.onPlay=function(){this.emit(Qo.start)},t.prototype.onCurrentTime=function(e){this.emit(Qo.currentTime,e.positionMiliseconds)},t.prototype.onError=function(){this.emit(Qo.stop),this.cleanup()},t.prototype.stop=function(){this.emit(Qo.stop),this.cleanup()},t.prototype.cleanup=function(){}}($),{PLAY:Qo.start,PLAYING:Qo.playing,PAUSE:Qo.pause,COMPLETE:"complete",LOADED_METADATA:"loadedMetadata",SEEK:"seeked",RELEASE:"dispose",PROGRESS_CHANGE:Qo.currentTime,BUFFER:"buffer",ERROR:"error",AD_BREAK_START:"adBreakStart",AD_BREAK_END:"adBreakEnd"});function ac(e){return e&&"object"==typeof e&&"timeStamp"in e?e.timeStamp:parseInt(e,10)}var sc=function(){function e(e,t,n){this.playerAdaptor=e,this.plugins=[],this.config=n,this.play=this.play.bind(this),this.playing=this.playing.bind(this),this.loadedMetadata=this.loadedMetadata.bind(this),this.pause=this.pause.bind(this),this.complete=this.complete.bind(this),this.seek=this.seek.bind(this),this.release=this.release.bind(this),this.progressChange=this.progressChange.bind(this),this.buffer=this.buffer.bind(this),this.error=this.error.bind(this),this.adBreakStart=this.adBreakStart.bind(this),this.adBreakEnd=this.adBreakEnd.bind(this),this.addPlugins(t),this.bindEventListeners()}return e.prototype.setMediaItem=function(e){this.callOnPlugins("setMediaItem",e)},e.prototype.addPlugins=function(e){var t=this;e&&e.length&&e.forEach((function(e){return t.addPlugin(e)}))},e.prototype.addPlugin=function(e){var t;t=e instanceof Vo||e.delegate?e:new e(this.playerAdaptor,this.config),this.plugins.push(t)},e.prototype.play=function(e){this.callOnPlugins("play",ac(e))},e.prototype.playing=function(e){this.callOnPlugins("playing",ac(e))},e.prototype.pause=function(e){this.callOnPlugins("pause",ac(e))},e.prototype.complete=function(e){this.callOnPlugins("complete",ac(e))},e.prototype.loadedMetadata=function(e){this.callOnPlugins("loadedMetadata",e)},e.prototype.seek=function(e){this.callOnPlugins("seek",ac(e))},e.prototype.release=function(e){this.callOnPlugins("release",ac(e))},e.prototype.progressChange=function(e){this.callOnPlugins("progressChange",ac(e))},e.prototype.buffer=function(e){this.callOnPlugins("buffer",ac(e))},e.prototype.error=function(e){this.callOnPlugins("error",ac(e))},e.prototype.adBreakStart=function(e){this.callOnPlugins("adBreakStart",ac(e))},e.prototype.adBreakEnd=function(e){this.callOnPlugins("adBreakEnd",ac(e))},e.prototype.bindEventListeners=function(){this.playerAdaptor.on(rc.PLAY,this.play),this.playerAdaptor.on(rc.PLAYING,this.playing),this.playerAdaptor.on(rc.PAUSE,this.pause),this.playerAdaptor.on(rc.COMPLETE,this.complete),this.playerAdaptor.on(rc.LOADED_METADATA,this.loadedMetadata),this.playerAdaptor.on(rc.SEEK,this.seek),this.playerAdaptor.on(rc.RELEASE,this.release),this.playerAdaptor.on(rc.PROGRESS_CHANGE,this.progressChange),this.playerAdaptor.on(rc.BUFFER,this.buffer),this.playerAdaptor.on(rc.ERROR,this.error),this.playerAdaptor.on(rc.AD_BREAK_START,this.adBreakStart),this.playerAdaptor.on(rc.AD_BREAK_END,this.adBreakEnd)},e.prototype.unbindEventListeners=function(){this.playerAdaptor.off(rc.PLAY,this.play),this.playerAdaptor.off(rc.PLAYING,this.playing),this.playerAdaptor.off(rc.PAUSE,this.pause),this.playerAdaptor.off(rc.COMPLETE,this.complete),this.playerAdaptor.off(rc.LOADED_METADATA,this.loadedMetadata),this.playerAdaptor.off(rc.SEEK,this.seek),this.playerAdaptor.off(rc.RELEASE,this.release),this.playerAdaptor.off(rc.PROGRESS_CHANGE,this.progressChange),this.playerAdaptor.off(rc.BUFFER,this.buffer),this.playerAdaptor.off(rc.ERROR,this.error),this.playerAdaptor.off(rc.AD_BREAK_START,this.adBreakStart),this.playerAdaptor.off(rc.AD_BREAK_END,this.adBreakEnd)},e.prototype.callOnPlugins=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.plugins.forEach((function(n){if("function"==typeof n[e])try{n[e].apply(n,t)}catch(e){P.error(e)}}))},e.prototype.dispose=function(){this.unbindEventListeners(),this.plugins.forEach((function(e){return e.dispose()})),this.plugins=null,this.playerAdaptor=null,this.config=null},e}();const oc={callback:(...e)=>{P.trace(e)}};var cc;(cc=e.QueueMode||(e.QueueMode={})).first="first",cc.last="last",cc.all="all";const uc={maxAttempts:3,persistSession:!0,retryTimeout:6e4,SESSION_KEY_PREFIX:"ResilientRemoteStorage",queueMode:e.QueueMode.all};const lc={Accept:"application/json","Cache-Control":"no-cache","Content-Type":"application/json",Pragma:"no-cache"},dc={swid:null,bu:null,contentSource:null,s2:null,source:null,endpointTemplate:"https://fan.core.api.espn.com/apis/v2/progress/{{SWID}}/{{BUSINESS_UNIT}}/{{CONTENT_SOURCE}}/{{CONTENT_ID}}",completePercentThreshold:97,fetchCredentials:"include"},hc={espn:0,marvel:2},pc={espn:{longform:0}};var fc,mc,yc,gc;!function(e){e.willStartPlaying="atv.player.willStartPlaying",e.didStopPlaying="atv.player.didStopPlaying",e.onTimedMetadataChanged="atv.player.onTimedMetadataChanged",e.playerStateChanged="atv.player.playerStateChanged",e.playerTimeDidChange="atv.player.playerTimeDidChange"}(fc||(fc={})),function(e){e.priv="PRIV",e.txxx="TXXX"}(mc||(mc={})),function(e){e.program="PROGRAM",e.commercial="COMMERCIAL",e.slate="SLATE"}(yc||(yc={})),function(e){e.start="start",e.playing="playing",e.pause="pause",e.seeking="seeking",e.seeked="seeked",e.stalled="stalled",e.stop="stop",e.timedMetadata="timedMetadata",e.currentTime="currentTime",e.loadedMetadata="loadedMetadata"}(gc||(gc={}));var vc,bc=gc;!function(e){e.opened="opened",e.playing="playing",e.ended="ended",e.timedMetadata="timedMetadata",e.error="error",e.timeUpdate="timeUpdate",e.stalled="stalled",e.paused="paused",e.seeking="seeking"}(vc||(vc={}));bc.start,bc.playing,bc.pause,bc.currentTime;const _c={interval:15e3,debounce:250,minimumProgressBeforeTrack:30},wc=()=>{};e.AdobeConcurrencyMonitorBuilder=gn,e.AdvertisingInfo=Ct,e.AtvlPlayerAdaptor=class extends ${constructor(e,t,n){if(super(),!t)throw new Error("bus must be supplied");this.bus=t,this.secureKeyDelivery=new Ds(n),this.bindEventListeners()}bindEventListeners(){this.bus.on(As.willStartPlaying,()=>{atv.player.observeTimedMetadataKeys(),this.emit(Os.start)}),this.bus.on(As.playerStateChanged,(e,t)=>{switch(P.debug("AtvlPlayerAdaptor AtvlPlayerEvent.playerStateChanged",e,t),e){case atv.player.states.FastForwarding:this.emit(Os.seeking,t);break;case atv.player.states.Loading:this.emit(Os.stalled,t);break;case atv.player.states.Paused:this.emit(Os.pause,t);break;case atv.player.states.Playing:this.emit(Os.playing,t);break;case atv.player.states.Rewinding:this.emit(Os.seeking,t)}}),this.bus.on(As.onTimedMetadataChanged,e=>{const t=e.key,n=e.extraAttributes.info,{dataValue:i}=e,r=i&&U.stringify(L.parse(i))||"";r.replace("\0",""),this.emit(Os.timedMetadata,new Cs(t,n,r))}),this.bus.on(As.didStopPlaying,()=>{this.emit(Os.stop),this.cleanup()}),this.bus.on(As.playerTimeDidChange,e=>{this.emit(Os.currentTime,e)})}set playbackConfig(e){if(!e)return;const{licenseUrl:t}=e;P.debug("AtvlPlayerAdaptor setPlaybackConfig",t,e.protectionSystem),t&&(this.secureKeyDelivery.certificateUrl=t)}stop(e){const{message:t}=e;atv.player.stopWithReason("Video Playback Has Stopped",t)}cleanup(){this.bus.off(As.willStartPlaying),this.bus.off(As.onTimedMetadataChanged),this.bus.off(As.didStopPlaying)}},e.AtvlPlayerEvent=As,e.AtvlPlayerEventBus=jo,e.AuthenticationManager=oa,e.AuthenticationType=we,e.BAMTizenPlayerAdaptor=class extends ${constructor(e,t){super(),e&&(this.nativePlayer=e,this.bus=e.getEventBus(),this.constants=t,this.id3MetadataOwner=new ks,this.unsubscribers=[],this.bindEventListeners())}bindEventListeners(){this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.ID3,this,(e={})=>{const t=e.sample?e.sample.data:e,n=t instanceof Uint8Array?String.fromCharCode(...t):t,i=["PRIV","TXXX"].find(e=>n.includes(e))||null,r=Object.keys(this.id3MetadataOwner).map(e=>this.id3MetadataOwner[e]).find(e=>n.includes(e))||null,a=r?n.substring(n.lastIndexOf(r)+r.length).trim().replace(/\0/g,""):null,s=new Cs(i,r,a);this.emit(Os.timedMetadata,s)})),this.alreadyStarted=!1,this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.PLAYING,this,()=>{P.trace("BAMTizenPlayerAdaptor Events.Player.PLAYING"),this.alreadyStarted?this.emit(Os.playing):(this.emit(Os.start),this.emit(Os.playing),this.alreadyStarted=!0)})),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.TIME_UPDATE,this,e=>{const t=e/1e3;this.emit(Os.currentTime,t)})),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.PAUSED,this,()=>{P.trace("BAMTizenPlayerAdaptor Events.Player.PAUSED");const e=this.getCurrentTime();this.emit(Os.pause,e)})),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.SEEKING,this,()=>{P.trace("BAMTizenPlayerAdaptor Events.Player.SEEKING");const e=this.getCurrentTime();this.emit(Os.seeking,e)})),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.SEEKED,this,()=>{P.trace("BAMTizenPlayerAdaptor Events.Player.SEEKED");const e=this.getCurrentTime();this.emit(Os.seeked,e)})),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.BUFFERING_START,this,()=>{P.trace("BAMTizenPlayerAdaptor Events.Player.BUFFERING_START"),this.emit(Os.stalled)})),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.BUFFERING_END,this,()=>{P.trace("BAMTizenPlayerAdaptor Events.Player.BUFFERING_END"),this.emit(Os.playing)})),this.unsubscribers.push(this.bus.subscribe(this.constants.Events.Player.COMPLETE,this,()=>{P.trace("BAMTizenPlayerAdaptor Events.Player.COMPLETE"),this.emit(Os.stop),this.cleanup()}))}getCurrentTime(){let e=null;const t=this.nativePlayer&&this.nativePlayer.getCurrentPlayer?this.nativePlayer.getCurrentPlayer():null;return e=t&&t.getCurrentTime?t.getCurrentTime():null,e=isNaN(e)?null:e/1e3,e}stop(e){e&&P.warn("BAMTizenPlayerAdaptor.stop",e.message),this.nativePlayer.stop(),this.cleanup()}cleanup(){this.alreadyStarted=!1,this.unsubscribers.forEach(e=>"function"==typeof e&&e()),this.unsubscribers=[]}},e.BootstrappedESPNAffiliateAPI=rr,e.CallbackStorage=class{constructor(e){this.config=Object.assign(Object.assign({},oc),e)}setMediaItem(e){this.mediaItem=e,this.videoId=String(e.id),this.sourceId=this.config.sourceId}saveProgress(e,t){const{config:{callback:n},videoId:i,sourceId:r,mediaItem:a}=this;return S.resolve().then(()=>n(i,e,r,t,a))}dispose(){this.config=null,this.mediaItem=null}},e.ChromecastPlayerAdaptor=class extends ${constructor(e){super(),e&&(this.nativePlayer=e,this.id3MetadataOwner=new ks,this.bindEventListeners())}bindEventListeners(){this.loadCompleteHandler=this.loadCompleteHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.PLAYER_LOAD_COMPLETE,this.loadCompleteHandler),this.id3Handler=this.id3Handler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.ID3,this.id3Handler),this.mediaFinishedHandler=this.mediaFinishedHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.MEDIA_FINISHED,this.mediaFinishedHandler),this.timeUpdateHandler=this.timeUpdateHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.TIME_UPDATE,this.timeUpdateHandler),this.playingHandler=this.playingHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.PLAYING,this.playingHandler),this.pauseHandler=this.pauseHandler.bind(this),this.nativePlayer.addEventListener(cast.framework.events.EventType.PAUSE,this.pauseHandler),this.stop=this.stop.bind(this)}loadCompleteHandler(e){P.debug("ChromecastPlayerAdaptor: PLAYER_LOAD_COMPLETE",e),this.emit(Os.start)}id3Handler(e){if(P.debug("ChromecastPlayerAdaptor._id3Handler",e),e.detail&&(e.segmentData=e.detail),!e.segmentData)return;const t=String.fromCharCode(...e.segmentData);P.trace("ChromecastPlayerAdaptor._id3Handler",t);const n=["PRIV","TXXX"].find(e=>t.includes(e))||null,i=Object.keys(this.id3MetadataOwner).map(e=>this.id3MetadataOwner[e]).find(e=>t.includes(e))||null,r=i?t.substring(t.lastIndexOf(i)+i.length).trim().replace(/\0/g,""):null,a=new Cs(n,i,r);P.trace("ChromecastPlayerAdaptor._id3Handler","tag:",n,"owner:",i,"dataValue:",r),this.emit(Os.timedMetadata,a)}timeUpdateHandler(e){const t=e.currentMediaTime;this.emit(Os.currentTime,t)}playingHandler(e){const t=e.currentMediaTime;this.emit(Os.playing,t)}pauseHandler(e){const t=e.currentMediaTime;this.emit(Os.pause,t)}mediaFinishedHandler(e){P.debug("ChromecastPlayerAdaptor: MEDIA_FINISHED",e),this.emit(Os.stop),this.cleanup()}stop(e){e&&P.warn("ChromecastPlayerAdaptor.stop",e.message)}cleanup(){this.nativePlayer&&(this.nativePlayer.removeEventListener(cast.framework.events.EventType.PLAYER_LOAD_COMPLETE,this.loadCompleteHandler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.ID3,this.id3Handler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.MEDIA_FINISHED,this.mediaFinishedHandler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.TIME_UPDATE,this.timeUpdateHandler),this.nativePlayer.removeEventListener(cast.framework.events.EventType.PAUSE,this.pauseHandler))}},e.Client=ie,e.DRMKeySystem=en,e.DRMSupport=tn,e.DTCITVEntitlementAPI=Ks,e.DomesticLocationProvider=ir,e.DrmSupport=tn,e.FanManager=Ki,e.FuseStorage=class extends class{constructor(e){var t;this.failedAttempts=0,this.maxAttempts=NaN,this.paused=!1,this.queuedFetchArgs=[],this.waitForResume_=null,this.resumeTimeout_=null,this.retryTimestamp_=NaN,this.config=Object.assign(Object.assign({},uc),e);const{config:{maxAttempts:n,persistSession:i,SESSION_KEY_PREFIX:r,queueMode:a}}=this,s=null===(t=null==this?void 0:this.constructor)||void 0===t?void 0:t.name;this.queueMode=a,this.maxAttempts=n,this.storageKey=`${r}${s?"-"+s:""}`,i&&this.persistSession()}persistSession(){let e;try{const t=sessionStorage.getItem(this.storageKey);e=JSON.parse(t)}catch(e){}if(e){const{failedAttempts:t,retryTimestamp_:n,queuedFetchArgs:i}=e;if(this.queuedFetchArgs=i,this.failedAttempts=t,this.failedAttempts>=this.maxAttempts&&n>0){const e=Math.max(n-+new Date,0);this.pauseFetching(e),i&&i.length&&this.drainQueueWhenResumed()}}try{this.saveSession=this.saveSession.bind(this),window.addEventListener("beforeunload",this.saveSession)}catch(e){}}clearSession(){try{sessionStorage.setItem(this.storageKey,"")}catch(e){}}pauseFetching(e){const t=e||this.config.retryTimeout;this.waitForResume_||(this.retryTimestamp_=+new Date+t,this.waitForResume_=new S(e=>{this.resumeTimeout_=setTimeout(()=>{this.waitForResume_=null,this.failedAttempts=0,this.retryTimestamp_=NaN,e(!0)},t)}))}drainQueueWhenResumed(){return this.waitForResume_.then(()=>{const{queuedFetchArgs:e}=this;return this.queuedFetchArgs=[],S.all(e.map(({url:e,params:t},n)=>new S(i=>{setTimeout(()=>{this.resilientFetch(e,t).then(i).catch(i)},10*n)})))})}resilientFetch(t,n){return new S(i=>{if(this.waitForResume_){const r={url:t,params:n};return this.queueMode===e.QueueMode.all?this.queuedFetchArgs.push(r):(this.queueMode===e.QueueMode.first&&!this.queuedFetchArgs.length||this.queueMode===e.QueueMode.last)&&(this.queuedFetchArgs[0]=r),this.drainQueueWhenResumed().then(i)}T(t,n).then(e=>e&&"ok"in e&&!e.ok?S.reject(new Error("Endpoint failed to save progress")):(this.failedAttempts=0,e)).then(i).catch(e=>(this.failedAttempts+=1,this.failedAttempts>=this.maxAttempts&&this.pauseFetching(),P.error(e),this.resilientFetch(t,n).then(i)))})}saveSession(){if(this.config.persistSession)try{sessionStorage.setItem(this.storageKey,JSON.stringify({queuedFetchArgs:this.queuedFetchArgs||[],retryTimestamp_:this.retryTimestamp_||NaN,failedAttempts:this.failedAttempts}))}catch(e){}}dispose(){this.config.persistSession&&this.saveSession(),clearTimeout(this.resumeTimeout_),this.config=null}}{constructor(e,t){super(Object.assign(Object.assign({},dc),e)),this.fan=t,this.handleFuseResponse=this.handleFuseResponse.bind(this)}setMediaItem(e){var t;const{config:{contentSource:n,bu:i,s2:r,swid:a,source:s,fetchCredentials:o,customHeaders:c},fan:u}=this,{id:l,brand:d,entityType:h}=e;this.mediaItem=e,this.contentId=String(l),this.businessUnit=null!==i?i:hc[d],this.contentSource=null!==n?n:null===(t=null==pc?void 0:pc[d])||void 0===t?void 0:t[h],this.swid=null!==a?a:null==u?void 0:u.id,this.s2=r,this.source=s,this.fetchCredentials=o,this.customHeaders=c,this.updateApiEndpoint_()}updateApiEndpoint_(){const{config:{endpointTemplate:e},swid:t,businessUnit:n,contentSource:i,contentId:r}=this;let a=e;t&&"{"===t[0]&&(a=a.replace("{{SWID}}",encodeURIComponent(t))),null!==n&&(a=a.replace("{{BUSINESS_UNIT}}",n)),null!==i&&(a=a.replace("{{CONTENT_SOURCE}}",i)),r&&(a=a.replace("{{CONTENT_ID}}",r)),this.apiEndpoint=a}computeCompleted(e,t,n){const{config:{completePercentThreshold:i}}=this;return t>=i}hideProgress(e,t){return this.updateProgress(e,t,!0)}saveProgress(e,t){return this.updateProgress(e,t,!1)}updateProgress(e,t,n){var i,r;const{apiEndpoint:a,businessUnit:s,contentId:o,contentSource:c,mediaItem:u,s2:l,source:d,swid:h}=this,p=null===(r=null===(i=null==u?void 0:u.tracking)||void 0===i?void 0:i.heartbeats)||void 0===r?void 0:r["a.media.asset"],f=[];-1!==String(a).indexOf("{{")&&f.push("Missing required metadata, cannot determine endpoint");const m={id:h,bu:s,contentId:o,contentSource:c,complete:this.computeCompleted(e,t,u),progress:e,seriesId:p,source:d,hidden:n};for(const e in m){const t=m[e];null==t&&f.push(`Required payload param '${e}' not set`)}if(f.length)return S.reject(new Error(f.map(e=>e).join("\n")));let y=lc,{fetchCredentials:g}=this;const{customHeaders:v}=this;return l&&(y=Object.assign(Object.assign({},y),{Cookie:"espn_s2="+l}),g="omit"),v&&(y=Object.assign(Object.assign({},y),v)),this.fetch(a,{method:"PUT",mode:"cors",cache:"no-cache",credentials:g,headers:y,body:JSON.stringify(m)}).then(e=>(null==e?void 0:e.json)&&e.json()).then(this.handleFuseResponse)}fetch(e,t){return this.resilientFetch(e,t)}handleFuseResponse(e){return e}dispose(){this.config=null,this.mediaItem=null}},e.HTML5PlayerAdaptor=class extends ${constructor(e){super(),this.nativePlayer=e,this.bindEventListeners()}bindEventListeners(){this.nativePlayer?(this.onPlay=this.onPlay.bind(this),this.onPause=this.onPause.bind(this),this.onSeeking=this.onSeeking.bind(this),this.onSeeked=this.onSeeked.bind(this),this.onCurrentTime=this.onCurrentTime.bind(this),this.onStalled=this.onStalled.bind(this),this.stop=this.stop.bind(this),this.onError=this.onError.bind(this),this.onLoadedMetadata=this.onLoadedMetadata.bind(this),this.cleanup=this.cleanup.bind(this),this.nativePlayer.addEventListener("play",this.onPlay),this.nativePlayer.addEventListener("pause",this.onPause),this.nativePlayer.addEventListener("seeking",this.onSeeking),this.nativePlayer.addEventListener("seeked",this.onSeeked),this.nativePlayer.addEventListener("ended",this.stop),this.nativePlayer.addEventListener("error",this.onError),this.nativePlayer.addEventListener("timeupdate",this.onCurrentTime),this.nativePlayer.addEventListener("stalled",this.onStalled),this.nativePlayer.addEventListener("loadedmetadata",this.onLoadedMetadata),this.nativePlayer.textTracks.onaddtrack=e=>{const t=e.track;t&&"metadata"===t.kind&&t.addEventListener("cuechange",e=>{const t=e.target;if(!t||"metadata"!==t.kind)return;const n=[];for(let e=0;e<t.activeCues.length;e++){const i=t.activeCues[e];n.push(i.value)}n.map(e=>{const t=e.key,n=e.info;let i=e.data;i instanceof ArrayBuffer&&(i=String.fromCharCode.apply(null,new Uint8Array(i)));const r=new Cs(t,n,i);P.trace("HTML5PlayerAdaptor timedMetadata",r),this.emit(Os.timedMetadata,r)})})}):P.error("Native Player wasn't passed to HTML5PlayerAdaptor")}onPlay(e){this.emit(Os.start,e.timeStamp)}onPause(e){this.emit(Os.pause,e.timeStamp)}onSeeking(e){this.emit(Os.seeking,e.timeStamp)}onSeeked(e){this.emit(Os.seeked,e.timeStamp)}onError(){this.emit(Os.stop),this.cleanup()}onCurrentTime(e){this.emit(Os.currentTime,e.timeStamp)}onStalled(e){this.emit(Os.stalled,e.timeStamp)}onLoadedMetadata(){const e=this.nativePlayer;this.emit(Os.loadedMetadata,{duration:e.duration,videoWidth:e.videoWidth,videoHeight:e.videoHeight})}stop(){this.nativePlayer.pause(),this.nativePlayer.setAttribute("src",""),this.nativePlayer.removeAttribute("src"),this.nativePlayer.currentTime=0,this.emit(Os.stop),this.cleanup()}cleanup(){this.nativePlayer.removeEventListener("play",this.onPlay),this.nativePlayer.removeEventListener("pause",this.onPause),this.nativePlayer.removeEventListener("error",this.onError),this.nativePlayer.removeEventListener("seeking",this.onSeeking),this.nativePlayer.removeEventListener("seeked",this.onSeeked),this.nativePlayer.removeEventListener("stalled",this.onStalled),this.nativePlayer.removeEventListener("timeupdate",this.onCurrentTime),this.nativePlayer.removeEventListener("ended",this.stop),this.nativePlayer.removeEventListener("loadedmetadata",this.onLoadedMetadata)}},e.LocationProvider=nr,e.MediaItemAPI=lt,e.MediaItemAuthenticationType=we,e.MediaItemSourceType=Ie,e.MediaItemTrackingType=pe,e.NielsenCloudAPIClient=Ho,e.NielsenTrackingManager=zo,e.PlaybackConfig=Qt,e.PlaybackCoordinator=ms,e.PlaybackManager=ys,e.PlayerEventBus=jo,e.PlayerPlugin=Vo,e.PlayerPluginManager=sc,e.ProgressTracker=class extends class{constructor(e,t){this.delegate=e,this.config=t,this.didFirstPlay=!1,this.didFirstPlayOfContent=!1}setMediaItem(e){this.mediaItem=e,this.didFirstPlayOfContent=!1}firstPlay(e){this.didFirstPlay=!0}firstPlayOfContent(e){this.didFirstPlayOfContent=!0}play(e){this.didFirstPlay||this.firstPlay(e),this.didFirstPlayOfContent||this.firstPlayOfContent(e)}loadedMetadata(e){}pause(e){}complete(e){}seek(e){}release(e){}progressChange(e){}buffer(e){}error(e){}adBreakStart(e){}adBreakEnd(e){}dispose(){this.delegate=null,this.config=null,this.mediaItem=null}}{constructor(e,t){super(e,Object.assign(Object.assign({},_c),t)),this.debouncedSaveProgress_=wc,this.throttledSaveProgress_=wc,this.contentDuration=NaN,this.storages=[],this.activeStorages=[],this.doDebouncedSaveProgress_=function(e,t,n,i){let r;return function(...a){const s=n&&!r;clearTimeout(r),r=setTimeout(()=>{r=null,n||e.apply(i,a)},t),s&&e.apply(i,a)}}(this.saveProgress,this.config.debounce,!1,this),this.doThrottledSaveProgress_=function(e,t,n){let i;return function(...r){i||(e.apply(n,r),i=!0,setTimeout(()=>{i=!1},t))}}(this.doDebouncedSaveProgress_,this.config.interval,this),this.progressChange=wc}setMediaItem(e){super.setMediaItem(e),this.contentDuration=NaN,this.pauseTracking(),this.selectStorages_()}setStorage(e,t){this.storages.push({storage:e,rule:t}),this.mediaItem&&this.selectStorages_()}selectStorages_(){const{storages:e,mediaItem:t}=this,n=e.length,i=[];for(let r=0;r<n;r++){const{storage:n,rule:a}=e[r];a(n,t)&&(n.setMediaItem(t),i.push(n))}this.activeStorages=i}firstPlayOfContent(e){super.firstPlayOfContent(e),0===this.config.minimumProgressBeforeTrack&&this.resumeTracking()}loadedMetadata(e){const t=null==e?void 0:e.duration;t&&this.setContentDuration(t)}setContentDuration(e){this.contentDuration=e}play(e){super.play(e),this.debouncedSaveProgress_(e)}pause(e){this.debouncedSaveProgress_(e)}complete(e){this.debouncedSaveProgress_(e,!0)}seek(e){this.debouncedSaveProgress_(e)}release(e){this.debouncedSaveProgress_(e)}pausedProgressChange(e){const{config:{minimumProgressBeforeTrack:t},didFirstPlayOfContent:n}=this;0!==t&&e>=t&&n&&(this.resumeTracking(),this.debouncedSaveProgress_(e))}resumedProgressChange(e){this.throttledSaveProgress_(e)}buffer(e){this.debouncedSaveProgress_(e)}adBreakStart(e){this.debouncedSaveProgress_(e),this.pauseTracking()}adBreakEnd(e){this.resumeTracking(),this.debouncedSaveProgress_(e)}pauseTracking(){this.debouncedSaveProgress_=this.throttledSaveProgress_=wc,this.progressChange=this.pausedProgressChange}resumeTracking(){this.debouncedSaveProgress_=this.doDebouncedSaveProgress_,this.throttledSaveProgress_=this.doThrottledSaveProgress_,this.progressChange=this.resumedProgressChange}saveProgress(e,t){const{mediaItem:n,activeStorages:i,contentDuration:r}=this,a=r||(null==n?void 0:n.duration);if(e>-1&&i.length){let n,r;r=!0===t?100:a>0&&e>=0?parseFloat(String(e))/parseFloat(String(a))*100:NaN,n=i.length?S.all(i.map(t=>new S(n=>{let i;try{i=t.saveProgress(e,r).then(n)}catch(e){P.error(e),i=S.resolve()}return i}))):S.reject("No storages available"),n.catch(e=>{P.error(e)})}}dispose(){super.dispose(),this.storages.forEach(({storage:e})=>e.dispose()),this.storages=[],this.activeStorages=[],this.mediaItem=null,this.throttledSaveProgress_=null,this.debouncedSaveProgress_=null}},e.ShieldAPI=An,e.TVEAuthenticator=Uo,e.TokenAuthenticator=class{constructor(e){this.authenticatedProviderId=null,this.providerDataSource=null,this.partner=e.partner,this.platform=e.platform}get preauthorizedResources(){return[]}get isAuthenticated(){return!!this.token&&!!this.tokenType}set isAuthenticated(e){}get authenticatedIdentity(){return localStorage.getItem("TokenAuthenticator.authenticatedIdentity")}set authenticatedIdentity(e){e?localStorage.setItem("TokenAuthenticator.authenticatedIdentity",e):localStorage.removeItem("TokenAuthenticator.authenticatedIdentity")}get authenticatedProvider(){const e=localStorage.getItem("TokenAuthenticator.authenticatedProvider");try{return yt.fromObject(JSON.parse(e))}catch(e){return null}}set authenticatedProvider(e){e?localStorage.setItem("TokenAuthenticator.authenticatedProvider",JSON.stringify(e)):localStorage.removeItem("TokenAuthenticator.authenticatedProvider")}setToken(e,t,n,i){this.token=e,this.tokenType=t,this.resource=n,this.zipcode=i}checkAuthentication(){const e=this.authenticatedProviderId;if(!e||this.authenticatedProvider&&e===this.authenticatedProvider.id)return S.resolve(this.isAuthenticated);if(!this.providerDataSource)return this.authenticatedProvider=new yt(e,e,null,null),S.resolve(this.isAuthenticated);const t="ADOBEPASS"===(n=this.tokenType)?vs.mvpd:"DEVICE"===n?vs.isp:"AUTHTOKEN"===n?vs.mvpd:null;var n;return this.providerDataSource.getProvider(e,t).then(t=>{const n=t.getPreferredLogoUrl(this.partner);return this.authenticatedProvider=new yt(e,t.name,n,t.websiteUrl),S.resolve(this.isAuthenticated)}).catch(()=>(this.authenticatedProvider=new yt(e,e,null,null),S.resolve(this.isAuthenticated)))}authenticate({authenticatedProviderId:e,authenticatedIdentity:t,token:n,tokenType:i,zipcode:r}){return this.authenticatedProviderId=e,this.authenticatedIdentity=t,this.setToken(n,i,null,r),this.checkAuthentication()}deauthenticate(){return this.authenticatedProvider=null,this.authenticatedIdentity=null,this.token=null,this.tokenType=null,this.resource=null,this.zipcode=null,S.resolve(!0)}checkAuthorization(e){const t=ws(this.tokenType);if(!this.isAuthenticated||-1===e.authenticationTypes.indexOf(t)&&"DEVICE"!==this.tokenType&&"GATEKEEPER"!==this.tokenType)return S.resolve(new vt(!1,null));const n={[gt.CustomDataKey.token]:this.token,[gt.CustomDataKey.tokenType]:this.tokenType};this.zipcode&&(n.zipcode=this.zipcode),this.resource&&(n.resource=this.resource);const i=new gt(t,this.authenticatedProvider,this.authenticatedIdentity,n),r=new vt(!0,i);return S.resolve(r)}},e.TrilithiumPlayerAdaptor=class extends ${constructor(e,t){if(super(),!e)throw new Error("nativePlayer must be supplied");this.nativePlayer=e,this.bus=t,this.bindEventListeners()}bindEventListeners(){this.onSeeking=this.onSeeking.bind(this),this.onStalled=this.onStalled.bind(this),this.onTimeUpdate=this.onTimeUpdate.bind(this),this.onPlaying=this.onPlaying.bind(this),this.onPaused=this.onPaused.bind(this),this.onError=this.onError.bind(this),this.onEnded=this.onEnded.bind(this),this.onTimedMetadata=this.onTimedMetadata.bind(this),this.onOpened=this.onOpened.bind(this),this.bus?(this.bus.on(Ls.opened,this.onOpened),this.bus.on(Ls.playing,this.onPlaying),this.bus.on(Ls.paused,this.onPaused),this.bus.on(Ls.timedMetadata,this.onTimedMetadata),this.bus.on(Ls.ended,this.onEnded),this.bus.on(Ls.error,this.onError),this.bus.on(Ls.timeUpdate,this.onTimeUpdate),this.bus.on(Ls.stalled,this.onStalled),this.bus.on(Ls.seeking,this.onSeeking)):(this.nativePlayer.onOpened=this.onOpened,this.nativePlayer.onPlaying=this.onPlaying,this.nativePlayer.onTimedMetadata=this.onTimedMetadata,this.nativePlayer.onEnded=this.onEnded,this.nativePlayer.onError=this.onError,this.nativePlayer.onTimeUpdate=this.onTimeUpdate,this.nativePlayer.onStalled=this.onStalled,this.nativePlayer.onSeeking=this.onSeeking)}onSeeking(){const{currentTime:e}=this.nativePlayer;P.debug("TrilithiumPlayerAdaptor.onSeeking",e),this.emit(Os.seeking,e)}onStalled(){const{currentTime:e}=this.nativePlayer;P.debug("TrilithiumPlayerAdaptor.onStalled",e),this.emit(Os.stalled,e)}onTimeUpdate(){const{currentTime:e}=this.nativePlayer;P.debug("TrilithiumPlayerAdaptor.onTimeUpdate",e),this.emit(Os.currentTime,e)}onError(e){P.debug("TrilithiumPlayerAdaptor.onError",e),this.emit(Os.stop),this.cleanup()}onEnded(){this.emit(Os.stop),this.cleanup()}onTimedMetadata(e,t,n){const i=t,r=n.toString(),a=U.stringify(L.parse(n.toString("base64"))),s=r?a.substring(a.lastIndexOf(r)+r.length).trim().replace(/\0/g,""):a;P.debug(`TrilithiumPlayerAdaptor.onTimedMetadata ${i} ${r} ${s}`);const o=new Cs(i,r,s);this.emit(Os.timedMetadata,o)}onOpened(e){e&&(P.debug("TrilithiumPlayerAdaptor.onOpened"),this.emit(Os.start))}onPlaying(){const{currentTime:e}=this.nativePlayer;P.debug("TrilithiumPlayerAdaptor.onPlaying",e),this.emit(Os.playing,e)}onPaused(){const{currentTime:e}=this.nativePlayer;P.debug("TrilithiumPlayerAdaptor.onPaused",e),this.emit(Os.pause,e)}stop(e){e&&P.warn("TrilithiumPlayerAdaptor.stop",e.message)}cleanup(){this.bus&&(this.bus.off(Ls.opened),this.bus.off(Ls.playing),this.bus.off(Ls.timedMetadata),this.bus.off(Ls.ended),this.bus.off(Ls.error),this.bus.off(Ls.timeUpdate),this.bus.off(Ls.stalled))}},e.TrilithiumPlayerEvent=Ls,e.log=I,e.uuid=K,Object.defineProperty(e,"__esModule",{value:!0})}));
